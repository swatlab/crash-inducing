{"bugs":{"798045":{"comments":[{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-10-04T21:24:46Z","author":"scoobidiver@netcourrier.com","bug_id":798045,"tags":[],"text":"It's #114 top browser crasher in 16.0b5 and seems to happen only in Beta versions with this signature: 15.0 or 16.0.\n\nSignature \tarena_dalloc_small | je_free | nsACString_internal::`scalar deleting destructor''(unsigned int) More Reports Search\nUUID\tc977c9fe-233d-4d8a-a1be-19ea42121004\nDate Processed\t2012-10-04 19:56:15\nUptime\t82347\nLast Crash\t22.9 hours before submission\nInstall Age\t4.4 days since version was first installed.\nInstall Time\t2012-06-28 10:56:11\nProduct\tFirefox\nVersion\t16.0\nBuild ID\t20120925201946\nRelease Channel\tbeta\nOS\tWindows NT\nOS Version\t6.1.7600\nBuild Architecture\tx86\nBuild Architecture Info\tGenuineIntel family 6 model 42 stepping 7\nCrash Reason\tEXCEPTION_BREAKPOINT\nCrash Address\t0x6e8f01f1\nApp Notes \t\nAdapterVendorID: 0x8086, AdapterDeviceID: 0x0116, AdapterSubsysID: 15ea10cf, AdapterDriverVersion: 8.15.10.2287\nD2D? D2D+ DWrite? DWrite+ D3D10 Layers? D3D10 Layers+ \nEMCheckCompatibility\tTrue\nAdapter Vendor ID\t0x8086\nAdapter Device ID\t0x0116\nTotal Virtual Memory\t2147352576\nAvailable Virtual Memory\t1357484032\nSystem Memory Use Percentage\t54\nAvailable Page File\t5218824192\nAvailable Physical Memory\t1687126016\n\nFrame \tModule \tSignature \tSource\n0 \tmozglue.dll \tarena_dalloc_small \tmemory/mozjemalloc/jemalloc.c:4510\n1 \tmozglue.dll \tje_free \tmemory/mozjemalloc/jemalloc.c:6565\n2 \txul.dll \tnsACString_internal::`scalar deleting destructor' \t\n3 \txul.dll \tmozilla::net::FailDelayManager::Lookup \tnetwerk/protocol/websocket/WebSocketChannel.cpp:218\n4 \txul.dll \tmozilla::net::FailDelayManager::DelayOrBegin \tnetwerk/protocol/websocket/WebSocketChannel.cpp:229\n5 \txul.dll \tmozilla::net::nsWSAdmissionManager::ConditionallyConnect \tnetwerk/protocol/websocket/WebSocketChannel.cpp:339\n6 \txul.dll \tmozilla::net::WebSocketChannel::OnLookupComplete \tnetwerk/protocol/websocket/WebSocketChannel.cpp:2217\n7 \txul.dll \t`anonymous namespace'::DNSListenerProxy::OnLookupCompleteRunnable::Run \tnetwerk/dns/nsDNSService2.cpp:552\n8 \txul.dll \tnsThread::ProcessNextEvent \txpcom/threads/nsThread.cpp:624\n9 \txul.dll \tmozilla::ipc::MessagePump::Run \tipc/glue/MessagePump.cpp:82\n10 \txul.dll \tMessageLoop::RunHandler \tipc/chromium/src/base/message_loop.cc:201\n11 \txul.dll \tMessageLoop::Run \tipc/chromium/src/base/message_loop.cc:175\n12 \txul.dll \tnsBaseAppShell::Run \twidget/xpwidgets/nsBaseAppShell.cpp:163\n13 \txul.dll \tnsAppShell::Run \twidget/windows/nsAppShell.cpp:232\n14 \txul.dll \tnsAppStartup::Run \ttoolkit/components/startup/nsAppStartup.cpp:257\n15 \txul.dll \tXREMain::XRE_mainRun \ttoolkit/xre/nsAppRunner.cpp:3794\n16 \txul.dll \tXREMain::XRE_main \ttoolkit/xre/nsAppRunner.cpp:3871\n17 \txul.dll \tXRE_main \ttoolkit/xre/nsAppRunner.cpp:3947\n18 \tfirefox.exe \twmain \ttoolkit/xre/nsWindowsWMain.cpp:100\n19 \tfirefox.exe \t__tmainCRTStartup \tcrtexe.c:552\n20 \tkernel32.dll \tBaseThreadInitThunk \t\n21 \tntdll.dll \t__RtlUserThreadStart \t\n22 \tntdll.dll \t_RtlUserThreadStart \t\n\nMore reports at:\nhttps://crash-stats.mozilla.com/report/list?signature=arena_dalloc_small+|+je_free+|+nsACString_internal%3A%3A%60scalar+deleting+destructor%27%27%28unsigned+int%29","id":6698990,"creation_time":"2012-10-04T21:24:46Z","raw_text":"It's #114 top browser crasher in 16.0b5 and seems to happen only in Beta versions with this signature: 15.0 or 16.0.\n\nSignature \tarena_dalloc_small | je_free | nsACString_internal::`scalar deleting destructor''(unsigned int) More Reports Search\nUUID\tc977c9fe-233d-4d8a-a1be-19ea42121004\nDate Processed\t2012-10-04 19:56:15\nUptime\t82347\nLast Crash\t22.9 hours before submission\nInstall Age\t4.4 days since version was first installed.\nInstall Time\t2012-06-28 10:56:11\nProduct\tFirefox\nVersion\t16.0\nBuild ID\t20120925201946\nRelease Channel\tbeta\nOS\tWindows NT\nOS Version\t6.1.7600\nBuild Architecture\tx86\nBuild Architecture Info\tGenuineIntel family 6 model 42 stepping 7\nCrash Reason\tEXCEPTION_BREAKPOINT\nCrash Address\t0x6e8f01f1\nApp Notes \t\nAdapterVendorID: 0x8086, AdapterDeviceID: 0x0116, AdapterSubsysID: 15ea10cf, AdapterDriverVersion: 8.15.10.2287\nD2D? D2D+ DWrite? DWrite+ D3D10 Layers? D3D10 Layers+ \nEMCheckCompatibility\tTrue\nAdapter Vendor ID\t0x8086\nAdapter Device ID\t0x0116\nTotal Virtual Memory\t2147352576\nAvailable Virtual Memory\t1357484032\nSystem Memory Use Percentage\t54\nAvailable Page File\t5218824192\nAvailable Physical Memory\t1687126016\n\nFrame \tModule \tSignature \tSource\n0 \tmozglue.dll \tarena_dalloc_small \tmemory/mozjemalloc/jemalloc.c:4510\n1 \tmozglue.dll \tje_free \tmemory/mozjemalloc/jemalloc.c:6565\n2 \txul.dll \tnsACString_internal::`scalar deleting destructor' \t\n3 \txul.dll \tmozilla::net::FailDelayManager::Lookup \tnetwerk/protocol/websocket/WebSocketChannel.cpp:218\n4 \txul.dll \tmozilla::net::FailDelayManager::DelayOrBegin \tnetwerk/protocol/websocket/WebSocketChannel.cpp:229\n5 \txul.dll \tmozilla::net::nsWSAdmissionManager::ConditionallyConnect \tnetwerk/protocol/websocket/WebSocketChannel.cpp:339\n6 \txul.dll \tmozilla::net::WebSocketChannel::OnLookupComplete \tnetwerk/protocol/websocket/WebSocketChannel.cpp:2217\n7 \txul.dll \t`anonymous namespace'::DNSListenerProxy::OnLookupCompleteRunnable::Run \tnetwerk/dns/nsDNSService2.cpp:552\n8 \txul.dll \tnsThread::ProcessNextEvent \txpcom/threads/nsThread.cpp:624\n9 \txul.dll \tmozilla::ipc::MessagePump::Run \tipc/glue/MessagePump.cpp:82\n10 \txul.dll \tMessageLoop::RunHandler \tipc/chromium/src/base/message_loop.cc:201\n11 \txul.dll \tMessageLoop::Run \tipc/chromium/src/base/message_loop.cc:175\n12 \txul.dll \tnsBaseAppShell::Run \twidget/xpwidgets/nsBaseAppShell.cpp:163\n13 \txul.dll \tnsAppShell::Run \twidget/windows/nsAppShell.cpp:232\n14 \txul.dll \tnsAppStartup::Run \ttoolkit/components/startup/nsAppStartup.cpp:257\n15 \txul.dll \tXREMain::XRE_mainRun \ttoolkit/xre/nsAppRunner.cpp:3794\n16 \txul.dll \tXREMain::XRE_main \ttoolkit/xre/nsAppRunner.cpp:3871\n17 \txul.dll \tXRE_main \ttoolkit/xre/nsAppRunner.cpp:3947\n18 \tfirefox.exe \twmain \ttoolkit/xre/nsWindowsWMain.cpp:100\n19 \tfirefox.exe \t__tmainCRTStartup \tcrtexe.c:552\n20 \tkernel32.dll \tBaseThreadInitThunk \t\n21 \tntdll.dll \t__RtlUserThreadStart \t\n22 \tntdll.dll \t_RtlUserThreadStart \t\n\nMore reports at:\nhttps://crash-stats.mozilla.com/report/list?signature=arena_dalloc_small+|+je_free+|+nsACString_internal%3A%3A%60scalar+deleting+destructor%27%27%28unsigned+int%29"},{"is_private":false,"attachment_id":null,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-05T00:45:29Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"> 2 xul.dll nsACString_internal::`scalar deleting destructor' \t\n\nDo we know how this gets generated (instead of the normal foo.cpp:line# stack trace)?\n\nAssuming this is indeed happening in a CString, that would be FailDelay.mAddress.  But I don't see any obvious errors in how it's allocated/freed.   Do we know of any jemalloc bugs that might be the cause of this?","id":6699618,"creation_time":"2012-10-05T00:45:29Z","raw_text":"> 2 xul.dll nsACString_internal::`scalar deleting destructor' \t\n\nDo we know how this gets generated (instead of the normal foo.cpp:line# stack trace)?\n\nAssuming this is indeed happening in a CString, that would be FailDelay.mAddress.  But I don't see any obvious errors in how it's allocated/freed.   Do we know of any jemalloc bugs that might be the cause of this?"},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-10-08T14:20:51Z","author":"scoobidiver@netcourrier.com","bug_id":798045,"tags":[],"text":"With combined signatures, it's #15 top browser crasher in 16.0b6.\n\nThere are no interesting correlations.","id":6707636,"creation_time":"2012-10-08T14:20:51Z","raw_text":"With combined signatures, it's #15 top browser crasher in 16.0b6.\n\nThere are no interesting correlations."},{"is_private":false,"attachment_id":null,"creator":"akeybl@mozilla.com","time":"2012-10-08T22:35:46Z","author":"akeybl@mozilla.com","bug_id":798045,"tags":[],"text":"Assigning to you for investigation Jason, since this is in WebSockets. Also including Brian, since he landed the two networking changes in FF16b6.","id":6709333,"creation_time":"2012-10-08T22:35:46Z","raw_text":"Assigning to you for investigation Jason, since this is in WebSockets. Also including Brian, since he landed the two networking changes in FF16b6."},{"is_private":false,"attachment_id":null,"creator":"akeybl@mozilla.com","time":"2012-10-08T22:46:50Z","author":"akeybl@mozilla.com","bug_id":798045,"tags":[],"text":"bsmith suggests this may be sec-critical","id":6709359,"creation_time":"2012-10-08T22:46:50Z","raw_text":"bsmith suggests this may be sec-critical"},{"is_private":false,"attachment_id":null,"creator":"brian@briansmith.org","time":"2012-10-08T22:53:39Z","author":"brian@briansmith.org","bug_id":798045,"tags":[],"text":"http://hg.mozilla.org/releases/mozilla-beta/annotate/c32d775d1039/netwerk/protocol/websocket/WebSocketChannel.cpp#l2215\n\nsWebSocketAdmissions->ConditionallyConnect(this);\n\nDon't we need kung-fu death grip?","id":6709379,"creation_time":"2012-10-08T22:53:39Z","raw_text":"http://hg.mozilla.org/releases/mozilla-beta/annotate/c32d775d1039/netwerk/protocol/websocket/WebSocketChannel.cpp#l2215\n\nsWebSocketAdmissions->ConditionallyConnect(this);\n\nDon't we need kung-fu death grip?"},{"is_private":false,"attachment_id":null,"creator":"brian@briansmith.org","time":"2012-10-08T23:11:25Z","author":"brian@briansmith.org","bug_id":798045,"tags":[],"text":"<bsmith> I don't think it is that race.\n<bsmith> Seems like it gets deleted during static destruction of nsWSAdmissionManager\n<bsmith> I did notice this:\n<bsmith>       if (fail->mAddress.Equals(address) && fail->mPort == port) {\n<bsmith>         if (outIndex)\n<bsmith>           *outIndex = i;\n<bsmith>         result = fail;\n<bsmith>       } else if (fail->IsExpired(rightNow)) {\n<bsmith> seems like there shoul be a \"break;\" after result = fail;\n<bsmith> Oh, I got it, I think\n<bsmith> I'm pretty sure that's it\n<bsmith> We set *outIndex = i;\n<bsmith> then, later, because we don't break, we delete some entries between 0 and i\n<bsmith> but, we don't decrease i","id":6709427,"creation_time":"2012-10-08T23:11:25Z","raw_text":"<bsmith> I don't think it is that race.\n<bsmith> Seems like it gets deleted during static destruction of nsWSAdmissionManager\n<bsmith> I did notice this:\n<bsmith>       if (fail->mAddress.Equals(address) && fail->mPort == port) {\n<bsmith>         if (outIndex)\n<bsmith>           *outIndex = i;\n<bsmith>         result = fail;\n<bsmith>       } else if (fail->IsExpired(rightNow)) {\n<bsmith> seems like there shoul be a \"break;\" after result = fail;\n<bsmith> Oh, I got it, I think\n<bsmith> I'm pretty sure that's it\n<bsmith> We set *outIndex = i;\n<bsmith> then, later, because we don't break, we delete some entries between 0 and i\n<bsmith> but, we don't decrease i"},{"is_private":false,"attachment_id":null,"creator":"brian@briansmith.org","time":"2012-10-08T23:39:10Z","author":"brian@briansmith.org","bug_id":798045,"tags":[],"text":"I would expect this to crash in line 252/253, not line 218. But, I think the compiler might be inlining this code so that a crash at line 253 is reported as a crash in line 218. See:\n\nhttps://mxr.mozilla.org/mozilla-beta/source/netwerk/protocol/websocket/WebSocketChannel.cpp?rev=6cd5f16a8c3c#216\n\n216       } else if (fail->IsExpired(rightNow)) {\n217         mEntries.RemoveElementAt(i);\n218         delete fail;\n219       }\n\n...\n\nhttps://mxr.mozilla.org/mozilla-beta/source/netwerk/protocol/websocket/WebSocketChannel.cpp?rev=6cd5f16a8c3c#251\n\n251         } else if (fail->IsExpired(rightNow)) {\n252           mEntries.RemoveElementAt(failIndex);\n253           delete fail;\n254         }\n\nSee also:\nhttps://crash-stats.mozilla.com/query/query?product=Firefox&version=ALL%3AALL&range_value=1&range_unit=weeks&date=10%2F08%2F2012+23%3A27%3A41&query_search=signature&query_type=contains&query=DelayOrBegin&reason=&build_id=&process_type=any&hang_type=any&do_query=1\n\nOr, it could be a different problem.","id":6709478,"creation_time":"2012-10-08T23:39:10Z","raw_text":"I would expect this to crash in line 252/253, not line 218. But, I think the compiler might be inlining this code so that a crash at line 253 is reported as a crash in line 218. See:\n\nhttps://mxr.mozilla.org/mozilla-beta/source/netwerk/protocol/websocket/WebSocketChannel.cpp?rev=6cd5f16a8c3c#216\n\n216       } else if (fail->IsExpired(rightNow)) {\n217         mEntries.RemoveElementAt(i);\n218         delete fail;\n219       }\n\n...\n\nhttps://mxr.mozilla.org/mozilla-beta/source/netwerk/protocol/websocket/WebSocketChannel.cpp?rev=6cd5f16a8c3c#251\n\n251         } else if (fail->IsExpired(rightNow)) {\n252           mEntries.RemoveElementAt(failIndex);\n253           delete fail;\n254         }\n\nSee also:\nhttps://crash-stats.mozilla.com/query/query?product=Firefox&version=ALL%3AALL&range_value=1&range_unit=weeks&date=10%2F08%2F2012+23%3A27%3A41&query_search=signature&query_type=contains&query=DelayOrBegin&reason=&build_id=&process_type=any&hang_type=any&do_query=1\n\nOr, it could be a different problem."},{"is_private":false,"attachment_id":null,"creator":"brian@briansmith.org","time":"2012-10-08T23:57:17Z","author":"brian@briansmith.org","bug_id":798045,"tags":[],"text":"(In reply to Alex Keybl [:akeybl] from comment #4)\n> bsmith suggests this may be sec-critical\n\nThis seems likely to have been caused by the patch for bug 711793, which also caused use-after-free bug 771318, which we're planning to release an advisory for. So, if this is exploitable, it is likely as close to (if not) a zero-day, especially if we release that advisory.\n\nTo avoid drawing even more attention to this code, I avoided adding it as blocking bug 711793 and I avoided mentioning this bug (and adding this comment) in bug 771318, just in case bug 771318 gets opened up.","id":6709516,"creation_time":"2012-10-08T23:57:17Z","raw_text":"(In reply to Alex Keybl [:akeybl] from comment #4)\n> bsmith suggests this may be sec-critical\n\nThis seems likely to have been caused by the patch for bug 711793, which also caused use-after-free bug 771318, which we're planning to release an advisory for. So, if this is exploitable, it is likely as close to (if not) a zero-day, especially if we release that advisory.\n\nTo avoid drawing even more attention to this code, I avoided adding it as blocking bug 711793 and I avoided mentioning this bug (and adding this comment) in bug 771318, just in case bug 771318 gets opened up."},{"is_private":false,"attachment_id":669347,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-09T00:24:32Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"Created attachment 669347\nv1\n\nActually crash @ line 218 makes perfect sense here:  when Lookup() returns an index for an item that is no longer valid, and it now happens to be off the end of the nsTArray, we only have MOZ_ASSERT checks in RemoveElementAt() so it passes through in release builds and we then try to delete some garbage.  Solution as bsmith suggested is to break once Lookup() finds a match.  We'll get rid of any expired entries the next time it's called and nothing is found (which is the most common case), so stale entries are not an issue.\n\nthanks to bsmith for tracking this down.\n\n> Don't we need kung-fu death grip?\n\nGood question, but not the bug at hand IMO.  I've emailed bsmedberg about whether our sWebsocketAdmissions usage is safe, and will file a bug if not.","id":6709584,"creation_time":"2012-10-09T00:24:32Z","raw_text":"Actually crash @ line 218 makes perfect sense here:  when Lookup() returns an index for an item that is no longer valid, and it now happens to be off the end of the nsTArray, we only have MOZ_ASSERT checks in RemoveElementAt() so it passes through in release builds and we then try to delete some garbage.  Solution as bsmith suggested is to break once Lookup() finds a match.  We'll get rid of any expired entries the next time it's called and nothing is found (which is the most common case), so stale entries are not an issue.\n\nthanks to bsmith for tracking this down.\n\n> Don't we need kung-fu death grip?\n\nGood question, but not the bug at hand IMO.  I've emailed bsmedberg about whether our sWebsocketAdmissions usage is safe, and will file a bug if not."},{"is_private":false,"attachment_id":null,"creator":"abillings@mozilla.com","time":"2012-10-09T00:50:30Z","author":"abillings@mozilla.com","bug_id":798045,"tags":[],"text":"(In reply to Brian Smith (:bsmith) from comment #8)\n> (In reply to Alex Keybl [:akeybl] from comment #4)\n> > bsmith suggests this may be sec-critical\n> \n> This seems likely to have been caused by the patch for bug 711793, which\n> also caused use-after-free bug 771318, which we're planning to release an\n> advisory for. So, if this is exploitable, it is likely as close to (if not)\n> a zero-day, especially if we release that advisory.\n\nbug 771318 is in a roll-up advisory for Abhishek's ASAN bugs. We don't list it or a similar bug by number in the advisory because the issues never shipped in a release, being found and fixed before becoming public.","id":6709638,"creation_time":"2012-10-09T00:50:30Z","raw_text":"(In reply to Brian Smith (:bsmith) from comment #8)\n> (In reply to Alex Keybl [:akeybl] from comment #4)\n> > bsmith suggests this may be sec-critical\n> \n> This seems likely to have been caused by the patch for bug 711793, which\n> also caused use-after-free bug 771318, which we're planning to release an\n> advisory for. So, if this is exploitable, it is likely as close to (if not)\n> a zero-day, especially if we release that advisory.\n\nbug 771318 is in a roll-up advisory for Abhishek's ASAN bugs. We don't list it or a similar bug by number in the advisory because the issues never shipped in a release, being found and fixed before becoming public."},{"is_private":false,"attachment_id":669347,"creator":"brian@briansmith.org","time":"2012-10-09T02:38:59Z","author":"brian@briansmith.org","bug_id":798045,"tags":[],"text":"Comment on attachment 669347\nv1\n\n[Security approval request comment]\n> How easily can the security issue be deduced from the patch?\n\nI found the potential out-of-bounds memory access / double-free within 30 minutes, and I am not particularly good at this stuff.\n\n> Do comments in the patch, the check-in comment, or tests\n> included in the patch paint a bulls-eye on the security problem?\n\nReview the comment in the patch.\n\n> Which older supported branches are affected by this flaw?\n> If not all supported branches, which bug introduced the flaw?\n\nBug 711793.\n\n> Do you have backports for the affected branches? \n> If not, how different, hard to create, and risky will they be?\n\nShould apply easily.\n\n> How likely is this patch to cause regressions; how much testing does it need?\n\nVery unlikely / not much.\n\n> Is there anything we could do to make this sec-approval form better?\n\nYes, please have it automatically formatted like I have done here.","id":6709773,"creation_time":"2012-10-09T02:38:59Z","raw_text":"[Security approval request comment]\n> How easily can the security issue be deduced from the patch?\n\nI found the potential out-of-bounds memory access / double-free within 30 minutes, and I am not particularly good at this stuff.\n\n> Do comments in the patch, the check-in comment, or tests\n> included in the patch paint a bulls-eye on the security problem?\n\nReview the comment in the patch.\n\n> Which older supported branches are affected by this flaw?\n> If not all supported branches, which bug introduced the flaw?\n\nBug 711793.\n\n> Do you have backports for the affected branches? \n> If not, how different, hard to create, and risky will they be?\n\nShould apply easily.\n\n> How likely is this patch to cause regressions; how much testing does it need?\n\nVery unlikely / not much.\n\n> Is there anything we could do to make this sec-approval form better?\n\nYes, please have it automatically formatted like I have done here."},{"is_private":false,"attachment_id":null,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-09T04:49:09Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/f9469bf48ff6\n\nre: exploitability.  It's possible to cause this crash by creating several websockets to different host:ports and then delaying the TCP connect process differently per socket at reconnect time.  I'm not sure how easy it is to then deterministically exploit the crash.","id":6710005,"creation_time":"2012-10-09T04:49:09Z","raw_text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/f9469bf48ff6\n\nre: exploitability.  It's possible to cause this crash by creating several websockets to different host:ports and then delaying the TCP connect process differently per socket at reconnect time.  I'm not sure how easy it is to then deterministically exploit the crash."},{"is_private":false,"attachment_id":null,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-09T04:51:34Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"meh--sorry, still getting used to the sec-approval process.","id":6710012,"creation_time":"2012-10-09T04:51:34Z","raw_text":"meh--sorry, still getting used to the sec-approval process."},{"is_private":false,"attachment_id":null,"creator":"emorley@mozilla.com","time":"2012-10-09T15:01:36Z","author":"emorley@mozilla.com","bug_id":798045,"tags":[],"text":"https://hg.mozilla.org/mozilla-central/rev/f9469bf48ff6","id":6711192,"creation_time":"2012-10-09T15:01:36Z","raw_text":"https://hg.mozilla.org/mozilla-central/rev/f9469bf48ff6"},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-10-09T15:06:27Z","author":"scoobidiver@netcourrier.com","bug_id":798045,"tags":[],"text":"a nit in the comment: \"will be be deleted\"","id":6711216,"creation_time":"2012-10-09T15:06:27Z","raw_text":"a nit in the comment: \"will be be deleted\""},{"is_private":false,"attachment_id":669347,"creator":"akeybl@mozilla.com","time":"2012-10-09T17:34:18Z","author":"akeybl@mozilla.com","bug_id":798045,"tags":[],"text":"Comment on attachment 669347\nv1\n\n[Triage Comment]\nSince this landed on m-i/m-c already, let's also get this on Aurora/Beta in preparation for possible 16.0.1 inclusion.","id":6711883,"creation_time":"2012-10-09T17:34:18Z","raw_text":"[Triage Comment]\nSince this landed on m-i/m-c already, let's also get this on Aurora/Beta in preparation for possible 16.0.1 inclusion."},{"is_private":false,"attachment_id":null,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-10T00:11:33Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"https://hg.mozilla.org/releases/mozilla-beta/rev/5764e33f79d6\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/aff619c66f1e\n\ntypo from comment 15 fixed there and in inbound.","id":6713578,"creation_time":"2012-10-10T00:11:33Z","raw_text":"https://hg.mozilla.org/releases/mozilla-beta/rev/5764e33f79d6\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/aff619c66f1e\n\ntypo from comment 15 fixed there and in inbound."},{"is_private":false,"attachment_id":669347,"creator":"akeybl@mozilla.com","time":"2012-10-10T17:24:16Z","author":"akeybl@mozilla.com","bug_id":798045,"tags":[],"text":"Comment on attachment 669347\nv1\n\n[Triage Comment]\nTo help prevent the possibility of a 16.0.2, let's land this fix in 16.0.1. Please land on mozilla-release asap.","id":6716081,"creation_time":"2012-10-10T17:24:16Z","raw_text":"[Triage Comment]\nTo help prevent the possibility of a 16.0.2, let's land this fix in 16.0.1. Please land on mozilla-release asap."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-10-10T17:31:37Z","author":"anthony.s.hughes@gmail.com","bug_id":798045,"tags":[],"text":"Is there a testcase or steps to reproduce this crash? Given this is being uplifted to release, QA would like to be able to verify it is fixed.","id":6716114,"creation_time":"2012-10-10T17:31:37Z","raw_text":"Is there a testcase or steps to reproduce this crash? Given this is being uplifted to release, QA would like to be able to verify it is fixed."},{"is_private":false,"attachment_id":null,"creator":"mcmanus@ducksong.com","time":"2012-10-10T17:35:49Z","author":"mcmanus@ducksong.com","bug_id":798045,"tags":[],"text":"alex asked me on irc to land this on release\n\n https://hg.mozilla.org/releases/mozilla-release/rev/f24140f9a4d4","id":6716126,"creation_time":"2012-10-10T17:35:49Z","raw_text":"alex asked me on irc to land this on release\n\n https://hg.mozilla.org/releases/mozilla-release/rev/f24140f9a4d4"},{"is_private":false,"attachment_id":null,"creator":"akeybl@mozilla.com","time":"2012-10-10T20:17:03Z","author":"akeybl@mozilla.com","bug_id":798045,"tags":[],"text":"Marking as ESR10 unaffected based upon comment 11.","id":6716848,"creation_time":"2012-10-10T20:17:03Z","raw_text":"Marking as ESR10 unaffected based upon comment 11."},{"is_private":false,"attachment_id":null,"creator":"jbecerra@mozilla.com","time":"2012-10-10T22:10:52Z","author":"jbecerra@mozilla.com","bug_id":798045,"tags":[],"text":"If you have any suggestions on how to test this, please let us know. We'll have Fx16.0.1 builds ready sometime this evening, and any instructions would be helpful.","id":6717272,"creation_time":"2012-10-10T22:10:52Z","raw_text":"If you have any suggestions on how to test this, please let us know. We'll have Fx16.0.1 builds ready sometime this evening, and any instructions would be helpful."},{"is_private":false,"attachment_id":null,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-10T22:30:51Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"I'm writing a test for this right now... stay tuned.","id":6717364,"creation_time":"2012-10-10T22:30:51Z","raw_text":"I'm writing a test for this right now... stay tuned."},{"is_private":false,"attachment_id":670198,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-11T00:42:51Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"Created attachment 670198\nweb page that demonstrates issue\n\nSo this webpage (you can either open it as a file or serve it off a webserver) crashes without the patch and is OK with it.  Crashes in opt-builds (such as the release) are harder to cause deterministically (in debug mode we hit an assert: in release mode we try to delete off the end of an array and that doesn't always crash), but I'm confident this is catching the cause of the crash.\n\nNote that this test takes 70 seconds to run, so I don't think we want to make a mochitest out of it.  We're not likely to regress this codepath in this way again, so I think that's ok.","id":6717742,"creation_time":"2012-10-11T00:42:51Z","raw_text":"So this webpage (you can either open it as a file or serve it off a webserver) crashes without the patch and is OK with it.  Crashes in opt-builds (such as the release) are harder to cause deterministically (in debug mode we hit an assert: in release mode we try to delete off the end of an array and that doesn't always crash), but I'm confident this is catching the cause of the crash.\n\nNote that this test takes 70 seconds to run, so I don't think we want to make a mochitest out of it.  We're not likely to regress this codepath in this way again, so I think that's ok."},{"is_private":false,"attachment_id":null,"creator":"jbecerra@mozilla.com","time":"2012-10-11T03:29:38Z","author":"jbecerra@mozilla.com","bug_id":798045,"tags":[],"text":"I tried Fx16 and Fx16.0.1 builds but neither of them crashed on Windows 7. I tried a Mac nightly debug build where an older version crashed but the latest one didn't. I'm changing the status-firefox16 flag based on this and comment #24.","id":6718036,"creation_time":"2012-10-11T03:29:38Z","raw_text":"I tried Fx16 and Fx16.0.1 builds but neither of them crashed on Windows 7. I tried a Mac nightly debug build where an older version crashed but the latest one didn't. I'm changing the status-firefox16 flag based on this and comment #24."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-10-11T04:21:36Z","author":"anthony.s.hughes@gmail.com","bug_id":798045,"tags":[],"text":"I was unable to reproduce a crash with the attached testcase using Firefox 17.0b1#1, 17.0b1#2, 2012-10-10 mozilla-beta debug, 2012-10-09 mozilla-beta debug, and 2012-10-07 mozilla-beta debug builds on Windows 7. \n\nGiven these results, I don't think we can mark this verified for Firefox 17. If someone else is able to reproduce this more easily, please help by verifying this for Firefox 17.0b1#2, Firefox 18.0a2, and Firefox 19.0a1 builds.\n\nThat said, I'm not going to block Firefox 17b1's release if this goes unverified. I'm basing this decision on comment 24 and 25.","id":6718117,"creation_time":"2012-10-11T04:21:36Z","raw_text":"I was unable to reproduce a crash with the attached testcase using Firefox 17.0b1#1, 17.0b1#2, 2012-10-10 mozilla-beta debug, 2012-10-09 mozilla-beta debug, and 2012-10-07 mozilla-beta debug builds on Windows 7. \n\nGiven these results, I don't think we can mark this verified for Firefox 17. If someone else is able to reproduce this more easily, please help by verifying this for Firefox 17.0b1#2, Firefox 18.0a2, and Firefox 19.0a1 builds.\n\nThat said, I'm not going to block Firefox 17b1's release if this goes unverified. I'm basing this decision on comment 24 and 25."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-10-11T07:58:19Z","author":"scoobidiver@netcourrier.com","bug_id":798045,"tags":[],"text":"(In reply to juan becerra [:juanb] from comment #25)\n> I tried Fx16 and Fx16.0.1 builds but neither of them crashed on Windows 7.\nSo it's not verified.","id":6718428,"creation_time":"2012-10-11T07:58:19Z","raw_text":"(In reply to juan becerra [:juanb] from comment #25)\n> I tried Fx16 and Fx16.0.1 builds but neither of them crashed on Windows 7.\nSo it's not verified."},{"is_private":false,"attachment_id":null,"creator":"emorley@mozilla.com","time":"2012-10-11T14:13:37Z","author":"emorley@mozilla.com","bug_id":798045,"tags":[],"text":"Typo fix:\nhttps://hg.mozilla.org/mozilla-central/rev/b310e265f26c","id":6719192,"creation_time":"2012-10-11T14:13:37Z","raw_text":"Typo fix:\nhttps://hg.mozilla.org/mozilla-central/rev/b310e265f26c"},{"is_private":false,"attachment_id":670454,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-11T17:57:03Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"Created attachment 670454\ntest v2\n\nThis version has just crashed FF 16 for me on linux 3 out of 6 times.  I consider that good enough, given that we have crash reports that point us right at the line number that's failing, a very exact understanding of the bug, and deterministic failure in debug mode.","id":6719994,"creation_time":"2012-10-11T17:57:03Z","raw_text":"This version has just crashed FF 16 for me on linux 3 out of 6 times.  I consider that good enough, given that we have crash reports that point us right at the line number that's failing, a very exact understanding of the bug, and deterministic failure in debug mode."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-10-11T18:42:06Z","author":"anthony.s.hughes@gmail.com","bug_id":798045,"tags":[],"text":"Unfortunately, I'm still not able to trigger a crash using test v2. I tried Firefox 17.0b1 build 1 on Linux 64-bit and 2012-10-09 mozilla-beta debug (Firefox 17) on Windows 7 32-bit. I tried 7 times on each waiting 2 minutes before reloading the test. Still no crash.\n\nI think we are going to have to ship without explicit verification here, trusting Jason's assessment and crash reports as pointed out in comment 29.","id":6720188,"creation_time":"2012-10-11T18:42:06Z","raw_text":"Unfortunately, I'm still not able to trigger a crash using test v2. I tried Firefox 17.0b1 build 1 on Linux 64-bit and 2012-10-09 mozilla-beta debug (Firefox 17) on Windows 7 32-bit. I tried 7 times on each waiting 2 minutes before reloading the test. Still no crash.\n\nI think we are going to have to ship without explicit verification here, trusting Jason's assessment and crash reports as pointed out in comment 29."},{"is_private":false,"attachment_id":null,"creator":"jduell.mcbugs@gmail.com","time":"2012-10-19T20:21:39Z","author":"jduell.mcbugs@gmail.com","bug_id":798045,"tags":[],"text":"Followup on comment 5 (which we were wondering might need a separate bug):\n\n> Don't we need kung-fu death grip [on sWebSocketAdmissions]?\n\nAfter talking to bsmedberg about this:  No, we're guaranteed that since we don't destroy sWebSocketAdmissions until XPCOM shutdown, we can rely on it existing during any XPCOM events that we dispatch.  We won't handle any events after shutdown is called.","id":6747204,"creation_time":"2012-10-19T20:21:39Z","raw_text":"Followup on comment 5 (which we were wondering might need a separate bug):\n\n> Don't we need kung-fu death grip [on sWebSocketAdmissions]?\n\nAfter talking to bsmedberg about this:  No, we're guaranteed that since we don't destroy sWebSocketAdmissions until XPCOM shutdown, we can rely on it existing during any XPCOM events that we dispatch.  We won't handle any events after shutdown is called."},{"is_private":false,"attachment_id":null,"creator":"virgil.dicu@softvision.ro","time":"2013-02-07T16:04:13Z","author":"virgil.dicu@softvision.ro","bug_id":798045,"tags":[],"text":"I tried to reproduce a crash with attachment from comment 29 on Firefox 16.0 beta 5 with no luck. \n\nNo crashes also for Firefox 19.0 beta 5\nMozilla/5.0 (Windows NT 6.1; rv:19.0) Gecko/20100101 Firefox/19.0\nBuild ID: 20130206083616\n\nCrash reports are not showing any crashes with these signatures.\nMoving this to verified.","id":7080840,"creation_time":"2013-02-07T16:04:13Z","raw_text":"I tried to reproduce a crash with attachment from comment 29 on Firefox 16.0 beta 5 with no luck. \n\nNo crashes also for Firefox 19.0 beta 5\nMozilla/5.0 (Windows NT 6.1; rv:19.0) Gecko/20100101 Firefox/19.0\nBuild ID: 20130206083616\n\nCrash reports are not showing any crashes with these signatures.\nMoving this to verified."}]}},"comments":{}}