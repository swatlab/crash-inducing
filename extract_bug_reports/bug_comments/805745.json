{"bugs":{"805745":{"comments":[{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-10-26T07:32:25Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"It first appeared in 19.0a1/20121025. The regression range is:\nhttp://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=93cc1ee94291&tochange=5c82f5a5e90d\n\nSignature \tmozilla::layers::ImageContainer::Release() More Reports Search\nUUID\t08f4bce0-c20d-4cee-bee6-221822121026\nDate Processed\t2012-10-26 07:17:09\nUptime\t16\nInstall Age\t16 seconds since version was first installed.\nInstall Time\t2012-10-26 07:16:28\nProduct\tFirefox\nVersion\t19.0a1\nBuild ID\t20121025030620\nRelease Channel\tnightly\nOS\tWindows NT\nOS Version\t6.1.7601 Service Pack 1\nBuild Architecture\tx86\nBuild Architecture Info\tAuthenticAMD family 16 model 6 stepping 2\nCrash Reason\tEXCEPTION_ACCESS_VIOLATION_WRITE\nCrash Address\t0x740075\nApp Notes \t\nAdapterVendorID: 0x1002, AdapterDeviceID: 0x68e0, AdapterSubsysID: 00000000, AdapterDriverVersion: 8.713.3.0\nD3D10 Layers? D3D10 Layers- \nProcessor Notes \tThis dump is too long and has triggered the automatic truncation routine\nEMCheckCompatibility\tTrue\nAdapter Vendor ID\t0x1002\nAdapter Device ID\t0x68e0\nTotal Virtual Memory\t4294836224\nAvailable Virtual Memory\t3903037440\nSystem Memory Use Percentage\t55\nAvailable Page File\t2922856448\nAvailable Physical Memory\t951963648\n\nFrame \tModule \tSignature \tSource\n0 \txul.dll \tmozilla::layers::ImageContainer::Release \tobj-firefox/dist/include/ImageContainer.h:265\n1 \txul.dll \tnsRefPtr<mozilla::layers::ImageContainer>::~nsRefPtr<mozilla::layers::ImageConta \tobj-firefox/dist/include/nsAutoPtr.h:874\n2 \txul.dll \tmozilla::layers::ImageLayer::~ImageLayer \tgfx/layers/ImageLayers.cpp:18\n3 \txul.dll \tmozilla::layers::ImageLayer::`scalar deleting destructor' \t\n4 \txul.dll \tnsWindow::OnPaint \twidget/windows/nsWindowGfx.cpp:420\n5 \txul.dll \tnsWindow::ProcessMessage \twidget/windows/nsWindow.cpp:4727\n6 \txul.dll \tnsWindow::WindowProcInternal \twidget/windows/nsWindow.cpp:4336\n7 \txul.dll \tCallWindowProcCrashProtected \txpcom/base/nsCrashOnException.cpp:32\n8 \txul.dll \tnsWindow::WindowProc \twidget/windows/nsWindow.cpp:4282\n9 \tuser32.dll \tInternalCallWinProc \t\n10 \tuser32.dll \tNtUserGetDC \t\n11 \tuser32.dll \tDispatchClientMessage \t\n12 \tuser32.dll \t__fnDWORD \t\n13 \tntdll.dll \tKiUserCallbackDispatcher \t\n14 \tntdll.dll \tKiUserApcDispatcher \t\n15 \txul.dll \tnsWindow::Show \twidget/windows/nsWindow.cpp:1189\n16 \txul.dll \tnsXULWindow::SetVisibility \txpfe/appshell/src/nsXULWindow.cpp:795\n17 \txul.dll \tnsXULWindow::OnChromeLoaded \txpfe/appshell/src/nsXULWindow.cpp:992\n18 \txul.dll \tnsWebShellWindow::OnStateChange \txpfe/appshell/src/nsWebShellWindow.cpp:563\n19 \txul.dll \tnsDocLoader::DoFireOnStateChange \turiloader/base/nsDocLoader.cpp:1351\n20 \txul.dll \tnsDocLoader::doStopDocumentLoad \turiloader/base/nsDocLoader.cpp:942\n...\n\nMore reports at:\nhttps://crash-stats.mozilla.com/report/list?signature=mozilla%3A%3Alayers%3A%3AImageContainer%3A%3ARelease%28%29","id":6766051,"creation_time":"2012-10-26T07:32:25Z","raw_text":"It first appeared in 19.0a1/20121025. The regression range is:\nhttp://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=93cc1ee94291&tochange=5c82f5a5e90d\n\nSignature \tmozilla::layers::ImageContainer::Release() More Reports Search\nUUID\t08f4bce0-c20d-4cee-bee6-221822121026\nDate Processed\t2012-10-26 07:17:09\nUptime\t16\nInstall Age\t16 seconds since version was first installed.\nInstall Time\t2012-10-26 07:16:28\nProduct\tFirefox\nVersion\t19.0a1\nBuild ID\t20121025030620\nRelease Channel\tnightly\nOS\tWindows NT\nOS Version\t6.1.7601 Service Pack 1\nBuild Architecture\tx86\nBuild Architecture Info\tAuthenticAMD family 16 model 6 stepping 2\nCrash Reason\tEXCEPTION_ACCESS_VIOLATION_WRITE\nCrash Address\t0x740075\nApp Notes \t\nAdapterVendorID: 0x1002, AdapterDeviceID: 0x68e0, AdapterSubsysID: 00000000, AdapterDriverVersion: 8.713.3.0\nD3D10 Layers? D3D10 Layers- \nProcessor Notes \tThis dump is too long and has triggered the automatic truncation routine\nEMCheckCompatibility\tTrue\nAdapter Vendor ID\t0x1002\nAdapter Device ID\t0x68e0\nTotal Virtual Memory\t4294836224\nAvailable Virtual Memory\t3903037440\nSystem Memory Use Percentage\t55\nAvailable Page File\t2922856448\nAvailable Physical Memory\t951963648\n\nFrame \tModule \tSignature \tSource\n0 \txul.dll \tmozilla::layers::ImageContainer::Release \tobj-firefox/dist/include/ImageContainer.h:265\n1 \txul.dll \tnsRefPtr<mozilla::layers::ImageContainer>::~nsRefPtr<mozilla::layers::ImageConta \tobj-firefox/dist/include/nsAutoPtr.h:874\n2 \txul.dll \tmozilla::layers::ImageLayer::~ImageLayer \tgfx/layers/ImageLayers.cpp:18\n3 \txul.dll \tmozilla::layers::ImageLayer::`scalar deleting destructor' \t\n4 \txul.dll \tnsWindow::OnPaint \twidget/windows/nsWindowGfx.cpp:420\n5 \txul.dll \tnsWindow::ProcessMessage \twidget/windows/nsWindow.cpp:4727\n6 \txul.dll \tnsWindow::WindowProcInternal \twidget/windows/nsWindow.cpp:4336\n7 \txul.dll \tCallWindowProcCrashProtected \txpcom/base/nsCrashOnException.cpp:32\n8 \txul.dll \tnsWindow::WindowProc \twidget/windows/nsWindow.cpp:4282\n9 \tuser32.dll \tInternalCallWinProc \t\n10 \tuser32.dll \tNtUserGetDC \t\n11 \tuser32.dll \tDispatchClientMessage \t\n12 \tuser32.dll \t__fnDWORD \t\n13 \tntdll.dll \tKiUserCallbackDispatcher \t\n14 \tntdll.dll \tKiUserApcDispatcher \t\n15 \txul.dll \tnsWindow::Show \twidget/windows/nsWindow.cpp:1189\n16 \txul.dll \tnsXULWindow::SetVisibility \txpfe/appshell/src/nsXULWindow.cpp:795\n17 \txul.dll \tnsXULWindow::OnChromeLoaded \txpfe/appshell/src/nsXULWindow.cpp:992\n18 \txul.dll \tnsWebShellWindow::OnStateChange \txpfe/appshell/src/nsWebShellWindow.cpp:563\n19 \txul.dll \tnsDocLoader::DoFireOnStateChange \turiloader/base/nsDocLoader.cpp:1351\n20 \txul.dll \tnsDocLoader::doStopDocumentLoad \turiloader/base/nsDocLoader.cpp:942\n...\n\nMore reports at:\nhttps://crash-stats.mozilla.com/report/list?signature=mozilla%3A%3Alayers%3A%3AImageContainer%3A%3ARelease%28%29"},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-10-28T08:06:13Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"It might be a regression from bug 782547.","id":6770101,"creation_time":"2012-10-28T08:06:13Z","raw_text":"It might be a regression from bug 782547."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-10-29T09:26:51Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"With combined signatures, it's #3 top crasher over the last three days.","id":6771209,"creation_time":"2012-10-29T09:26:51Z","raw_text":"With combined signatures, it's #3 top crasher over the last three days."},{"is_private":false,"attachment_id":null,"creator":"enndeakin@gmail.com","time":"2012-11-01T19:38:19Z","author":"enndeakin@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Scoobidiver from comment #1)\n> It might be a regression from bug 782547.\n\nDid you mean that that bug caused this crash to occur more frequently? That patch was only in for a few days and the crash reports show crashes over a wide range of different builds.","id":6784917,"creation_time":"2012-11-01T19:38:19Z","raw_text":"(In reply to Scoobidiver from comment #1)\n> It might be a regression from bug 782547.\n\nDid you mean that that bug caused this crash to occur more frequently? That patch was only in for a few days and the crash reports show crashes over a wide range of different builds."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-11-01T22:01:00Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"(In reply to Neil Deakin from comment #3)\n> Did you mean that that bug caused this crash to occur more frequently?\nI suspect it but it might be another one as no lines in the stack trace have been changed by one of the patch in the regression range. \n\n> the crash reports show crashes over a wide range of different builds.\nBut startup crashes have happened since October 25th.\nMore reports at:\nhttps://crash-stats.mozilla.com/report/list?signature=nsBaseWidget%3A%3AAutoLayerManagerSetup%3A%3A~AutoLayerManagerSetup%28%29\nhttps://crash-stats.mozilla.com/report/list?signature=_moz_cairo_destroy\nhttps://crash-stats.mozilla.com/report/list?signature=nsWindow%3A%3AOnPaint%28HDC__*%2C+unsigned+int%29\nhttps://crash-stats.mozilla.com/report/list?signature=gfxASurface%3A%3ARelease%28%29\nhttps://crash-stats.mozilla.com/report/list?signature=gfxContext%3A%3A~gfxContext%28%29\nhttps://crash-stats.mozilla.com/report/list?signature=mozilla%3A%3Alayers%3A%3ALayer%3A%3A~Layer%28%29","id":6785398,"creation_time":"2012-11-01T22:01:00Z","raw_text":"(In reply to Neil Deakin from comment #3)\n> Did you mean that that bug caused this crash to occur more frequently?\nI suspect it but it might be another one as no lines in the stack trace have been changed by one of the patch in the regression range. \n\n> the crash reports show crashes over a wide range of different builds.\nBut startup crashes have happened since October 25th.\nMore reports at:\nhttps://crash-stats.mozilla.com/report/list?signature=nsBaseWidget%3A%3AAutoLayerManagerSetup%3A%3A~AutoLayerManagerSetup%28%29\nhttps://crash-stats.mozilla.com/report/list?signature=_moz_cairo_destroy\nhttps://crash-stats.mozilla.com/report/list?signature=nsWindow%3A%3AOnPaint%28HDC__*%2C+unsigned+int%29\nhttps://crash-stats.mozilla.com/report/list?signature=gfxASurface%3A%3ARelease%28%29\nhttps://crash-stats.mozilla.com/report/list?signature=gfxContext%3A%3A~gfxContext%28%29\nhttps://crash-stats.mozilla.com/report/list?signature=mozilla%3A%3Alayers%3A%3ALayer%3A%3A~Layer%28%29"},{"is_private":false,"attachment_id":null,"creator":"kairo@kairo.at","time":"2012-11-06T15:32:46Z","author":"kairo@kairo.at","bug_id":805745,"tags":[],"text":"gfxASurface::Release() saw a significant increase on 2012-10-31, we really need to get some traction on those issues.","id":6796812,"creation_time":"2012-11-06T15:32:46Z","raw_text":"gfxASurface::Release() saw a significant increase on 2012-10-31, we really need to get some traction on those issues."},{"is_private":false,"attachment_id":null,"creator":"dveditz@mozilla.com","time":"2012-11-07T02:02:49Z","author":"dveditz@mozilla.com","bug_id":805745,"tags":[],"text":"gfxASurface::Release() saw a first peak starting Oct 29, then decreased before ramping up again. Two separate bugs? A backout/re-landing? People taking time for Halloween?\n\ngfxASurface::Release() seems to be a consistent READ access violation at 0x15 so looks like a null deref, but it's trying to read member mSurfaceValid which means \"this\" is null-- how does that happen? Maybe the surface is a member of some other structure and this is a use-after-free of that object? There could well be a security problem lurking here.","id":6799412,"creation_time":"2012-11-07T02:02:49Z","raw_text":"gfxASurface::Release() saw a first peak starting Oct 29, then decreased before ramping up again. Two separate bugs? A backout/re-landing? People taking time for Halloween?\n\ngfxASurface::Release() seems to be a consistent READ access violation at 0x15 so looks like a null deref, but it's trying to read member mSurfaceValid which means \"this\" is null-- how does that happen? Maybe the surface is a member of some other structure and this is a use-after-free of that object? There could well be a security problem lurking here."},{"is_private":false,"attachment_id":null,"creator":"akeybl@mozilla.com","time":"2012-11-08T01:42:32Z","author":"akeybl@mozilla.com","bug_id":805745,"tags":[],"text":"Neil - can we try temporarily backing out bug 782547 given it's our best guess as to the regressing bug right now?\n\nAlso adding roc/vlad as the module owners for Core::Widget, and adding qawanted/needURLs to see if we're able to repro internally.","id":6803300,"creation_time":"2012-11-08T01:42:32Z","raw_text":"Neil - can we try temporarily backing out bug 782547 given it's our best guess as to the regressing bug right now?\n\nAlso adding roc/vlad as the module owners for Core::Widget, and adding qawanted/needURLs to see if we're able to repro internally."},{"is_private":false,"attachment_id":null,"creator":"enndeakin@gmail.com","time":"2012-11-08T02:48:40Z","author":"enndeakin@gmail.com","bug_id":805745,"tags":[],"text":"The patch in bug 782547 was only in from around Oct 24 and was backed out on Oct 27.","id":6803514,"creation_time":"2012-11-08T02:48:40Z","raw_text":"The patch in bug 782547 was only in from around Oct 24 and was backed out on Oct 27."},{"is_private":false,"attachment_id":null,"creator":"lh.bennett@gmail.com","time":"2012-11-27T01:30:01Z","author":"lh.bennett@gmail.com","bug_id":805745,"tags":[],"text":"I ran into this crash using Ubisoft's Shop order form. It practically stops you from buying anything from the store using Firefox due to the crash. It happens as soon as you click on a drop down to input data. Confirmed on both Nightly and Fx17.","id":6853843,"creation_time":"2012-11-27T01:30:01Z","raw_text":"I ran into this crash using Ubisoft's Shop order form. It practically stops you from buying anything from the store using Firefox due to the crash. It happens as soon as you click on a drop down to input data. Confirmed on both Nightly and Fx17."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-11-27T07:10:50Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"(In reply to Leman Bennett (Omega X) from comment #10)\n> Confirmed on both Nightly and Fx17.\nSo it's not this bug because 17.0 and 18.0 are unaffected.\nWhat are your crash IDs?","id":6854454,"creation_time":"2012-11-27T07:10:50Z","raw_text":"(In reply to Leman Bennett (Omega X) from comment #10)\n> Confirmed on both Nightly and Fx17.\nSo it's not this bug because 17.0 and 18.0 are unaffected.\nWhat are your crash IDs?"},{"is_private":false,"attachment_id":null,"creator":"lh.bennett@gmail.com","time":"2012-11-27T07:26:11Z","author":"lh.bennett@gmail.com","bug_id":805745,"tags":[],"text":"https://crash-stats.mozilla.com/report/index/bp-cbd938cf-9aa5-445c-8a39-d80e82121127\nhttps://crash-stats.mozilla.com/report/index/bp-30420c7e-4fe8-4394-9e9f-c518f2121127\nhttps://crash-stats.mozilla.com/report/index/bp-c121ca79-daa6-4217-bf48-13b592121127\n\nDespite the difference in signature, all crashes were the exact same way. Select the dropdown, then crash.","id":6854471,"creation_time":"2012-11-27T07:26:11Z","raw_text":"https://crash-stats.mozilla.com/report/index/bp-cbd938cf-9aa5-445c-8a39-d80e82121127\nhttps://crash-stats.mozilla.com/report/index/bp-30420c7e-4fe8-4394-9e9f-c518f2121127\nhttps://crash-stats.mozilla.com/report/index/bp-c121ca79-daa6-4217-bf48-13b592121127\n\nDespite the difference in signature, all crashes were the exact same way. Select the dropdown, then crash."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-11-27T07:36:30Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"(In reply to Leman Bennett (Omega X) from comment #12)\n> https://crash-stats.mozilla.com/report/index/bp-cbd938cf-9aa5-445c-8a39-\n> d80e82121127\n> https://crash-stats.mozilla.com/report/index/bp-30420c7e-4fe8-4394-9e9f-\n> c518f2121127\n> https://crash-stats.mozilla.com/report/index/bp-c121ca79-daa6-4217-bf48-\n> 13b592121127\nIt's bug 716844 and bug 793983 (likely a dupe of bug 716844), not this bug.","id":6854481,"creation_time":"2012-11-27T07:36:30Z","raw_text":"(In reply to Leman Bennett (Omega X) from comment #12)\n> https://crash-stats.mozilla.com/report/index/bp-cbd938cf-9aa5-445c-8a39-\n> d80e82121127\n> https://crash-stats.mozilla.com/report/index/bp-30420c7e-4fe8-4394-9e9f-\n> c518f2121127\n> https://crash-stats.mozilla.com/report/index/bp-c121ca79-daa6-4217-bf48-\n> 13b592121127\nIt's bug 716844 and bug 793983 (likely a dupe of bug 716844), not this bug."},{"is_private":false,"attachment_id":null,"creator":"lh.bennett@gmail.com","time":"2012-11-27T08:03:58Z","author":"lh.bennett@gmail.com","bug_id":805745,"tags":[],"text":"I doubt that this is a 10 month old crash. Maybe 793983.","id":6854525,"creation_time":"2012-11-27T08:03:58Z","raw_text":"I doubt that this is a 10 month old crash. Maybe 793983."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-11-27T17:43:30Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"Marcia, have you been able to reproduce this crash?","id":6856150,"creation_time":"2012-11-27T17:43:30Z","raw_text":"Marcia, have you been able to reproduce this crash?"},{"is_private":false,"attachment_id":null,"creator":"bas@basschouten.com","time":"2012-11-27T20:56:40Z","author":"bas@basschouten.com","bug_id":805745,"tags":[],"text":"I can reproduce this on Fx17 but -not- on a debug build of nightly. I'll look into this a little more.","id":6857048,"creation_time":"2012-11-27T20:56:40Z","raw_text":"I can reproduce this on Fx17 but -not- on a debug build of nightly. I'll look into this a little more."},{"is_private":false,"attachment_id":null,"creator":"bas@basschouten.com","time":"2012-11-27T21:13:44Z","author":"bas@basschouten.com","bug_id":805745,"tags":[],"text":"I strongly suspect this might be related to bug 743975","id":6857121,"creation_time":"2012-11-27T21:13:44Z","raw_text":"I strongly suspect this might be related to bug 743975"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-11-27T21:44:52Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"Bas, can you provide more details about how you reproduce this issue?","id":6857271,"creation_time":"2012-11-27T21:44:52Z","raw_text":"Bas, can you provide more details about how you reproduce this issue?"},{"is_private":false,"attachment_id":null,"creator":"bas@basschouten.com","time":"2012-11-27T21:53:32Z","author":"bas@basschouten.com","bug_id":805745,"tags":[],"text":"(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #18)\n> Bas, can you provide more details about how you reproduce this issue?\n\n1. Go to http://shop.ubi.com/\n2. Select platform 'PC'\n3. Pre-order FarCry 3\n4. Go to check-out\n5. Select one of the drop-down listboxes\n\nThis reproduces in Optimized builds -not- in unoptimized builds.","id":6857313,"creation_time":"2012-11-27T21:53:32Z","raw_text":"(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #18)\n> Bas, can you provide more details about how you reproduce this issue?\n\n1. Go to http://shop.ubi.com/\n2. Select platform 'PC'\n3. Pre-order FarCry 3\n4. Go to check-out\n5. Select one of the drop-down listboxes\n\nThis reproduces in Optimized builds -not- in unoptimized builds."},{"is_private":false,"attachment_id":null,"creator":"bas@basschouten.com","time":"2012-11-27T21:57:06Z","author":"bas@basschouten.com","bug_id":805745,"tags":[],"text":"I'm marking this security sensitive. Putting more details in a restricted comment.","id":6857330,"creation_time":"2012-11-27T21:57:06Z","raw_text":"I'm marking this security sensitive. Putting more details in a restricted comment."},{"is_private":false,"attachment_id":null,"creator":"bas@basschouten.com","time":"2012-11-28T01:37:53Z","author":"bas@basschouten.com","bug_id":805745,"tags":[],"text":"The problem has been rootcaused and I've talked to several people about possible ways of fixing it but it's hard.\n\nRe-assigning to Timothy Nikkel as he knows a lot more about this code and is on the review list for one of the possible causes of this issue.","id":6858106,"creation_time":"2012-11-28T01:37:53Z","raw_text":"The problem has been rootcaused and I've talked to several people about possible ways of fixing it but it's hard.\n\nRe-assigning to Timothy Nikkel as he knows a lot more about this code and is on the review list for one of the possible causes of this issue."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-11-28T04:17:42Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"The crash of comment 19 is almost certainly caused by bug 782980. It added the ProcessPendingUpdates call in nsViewManager::Refresh which flushes and can therefore destroy anything.","id":6858487,"creation_time":"2012-11-28T04:17:42Z","raw_text":"The crash of comment 19 is almost certainly caused by bug 782980. It added the ProcessPendingUpdates call in nsViewManager::Refresh which flushes and can therefore destroy anything."},{"is_private":false,"attachment_id":null,"creator":"kairo@kairo.at","time":"2012-12-04T16:39:18Z","author":"kairo@kairo.at","bug_id":805745,"tags":[],"text":"gfxASurface::Release() is the #3 topcrash in 20.0a1 and 19.0a2 - see https://crash-stats.mozilla.com/report/list?signature=gfxASurface%3A%3ARelease%28%29&version=Firefox%3A19.0a2 - can we please get some progress here? Timothy? Bas?","id":6879316,"creation_time":"2012-12-04T16:39:18Z","raw_text":"gfxASurface::Release() is the #3 topcrash in 20.0a1 and 19.0a2 - see https://crash-stats.mozilla.com/report/list?signature=gfxASurface%3A%3ARelease%28%29&version=Firefox%3A19.0a2 - can we please get some progress here? Timothy? Bas?"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-04T18:04:23Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Bas Schouten (:bas.schouten) from comment #19)\n> This reproduces in Optimized builds -not- in unoptimized builds.\n\nIs there somewhere I can get optimized builds to try to confirm a regression range? or is qawanted no longer needed on this to get a fix?","id":6879732,"creation_time":"2012-12-04T18:04:23Z","raw_text":"(In reply to Bas Schouten (:bas.schouten) from comment #19)\n> This reproduces in Optimized builds -not- in unoptimized builds.\n\nIs there somewhere I can get optimized builds to try to confirm a regression range? or is qawanted no longer needed on this to get a fix?"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-05T00:54:04Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"No, I don't think we need any qa help with this right now.","id":6881571,"creation_time":"2012-12-05T00:54:04Z","raw_text":"No, I don't think we need any qa help with this right now."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-05T00:54:28Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Robert Kaiser (:kairo@mozilla.com) from comment #29)\n> gfxASurface::Release() is the #3 topcrash in 20.0a1 and 19.0a2 - see\n> https://crash-stats.mozilla.com/report/\n> list?signature=gfxASurface%3A%3ARelease%28%29&version=Firefox%3A19.0a2 - can\n> we please get some progress here? Timothy? Bas?\n\nI'm looking into this, I just haven't had anything to post yet.","id":6881572,"creation_time":"2012-12-05T00:54:28Z","raw_text":"(In reply to Robert Kaiser (:kairo@mozilla.com) from comment #29)\n> gfxASurface::Release() is the #3 topcrash in 20.0a1 and 19.0a2 - see\n> https://crash-stats.mozilla.com/report/\n> list?signature=gfxASurface%3A%3ARelease%28%29&version=Firefox%3A19.0a2 - can\n> we please get some progress here? Timothy? Bas?\n\nI'm looking into this, I just haven't had anything to post yet."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-12-07T10:57:37Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #28)\n> The crash of comment 19 is almost certainly caused by bug 782980.\nIt's bug 793983.\n\n(In reply to Robert Kaiser (:kairo@mozilla.com) from comment #29)\n> gfxASurface::Release() is the #3 topcrash in 20.0a1 and 19.0a2\nThis crash is indeed a regression in 19.0.","id":6891458,"creation_time":"2012-12-07T10:57:37Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #28)\n> The crash of comment 19 is almost certainly caused by bug 782980.\nIt's bug 793983.\n\n(In reply to Robert Kaiser (:kairo@mozilla.com) from comment #29)\n> gfxASurface::Release() is the #3 topcrash in 20.0a1 and 19.0a2\nThis crash is indeed a regression in 19.0."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-12-09T09:44:13Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"To clarify the scope of this bug, it occurs on startup and is a regression in 19.0 (first showed up around 19.0a1/20121025). It's #2 top browser crasher in 19.0a2 and #15 in 20.0a1.\n\nNon-startup crashes with some signatures in common with this bug described in comment 10, comment 16, comment 19, and comment 28 are tracked in bug 793983.","id":6895687,"creation_time":"2012-12-09T09:44:13Z","raw_text":"To clarify the scope of this bug, it occurs on startup and is a regression in 19.0 (first showed up around 19.0a1/20121025). It's #2 top browser crasher in 19.0a2 and #15 in 20.0a1.\n\nNon-startup crashes with some signatures in common with this bug described in comment 10, comment 16, comment 19, and comment 28 are tracked in bug 793983."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-09T09:59:18Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"I disagree, I'm going to track it this way, it'll work out for the best.","id":6895691,"creation_time":"2012-12-09T09:59:18Z","raw_text":"I disagree, I'm going to track it this way, it'll work out for the best."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-10T18:23:44Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"Timothy, Kairo asked that we get some QA on this bug. Is there some help that you need here? If so, ccing Matt Wobensmith to assist. Please advise, thank you.","id":6898354,"creation_time":"2012-12-10T18:23:44Z","raw_text":"Timothy, Kairo asked that we get some QA on this bug. Is there some help that you need here? If so, ccing Matt Wobensmith to assist. Please advise, thank you."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-10T18:30:21Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"I don't need any QA help, I'm in the process of writing the patch now.","id":6898390,"creation_time":"2012-12-10T18:30:21Z","raw_text":"I don't need any QA help, I'm in the process of writing the patch now."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-10T19:01:51Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #37)\n> I don't need any QA help, I'm in the process of writing the patch now.\n\nOkay, thank you Timothy and apologies if this was distracting.\n\nKairo, I assume this addresses your concerns. QA will be standing by for builds with Timothy's patch to test.","id":6898570,"creation_time":"2012-12-10T19:01:51Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #37)\n> I don't need any QA help, I'm in the process of writing the patch now.\n\nOkay, thank you Timothy and apologies if this was distracting.\n\nKairo, I assume this addresses your concerns. QA will be standing by for builds with Timothy's patch to test."},{"is_private":false,"attachment_id":null,"creator":"kairo@kairo.at","time":"2012-12-10T20:51:38Z","author":"kairo@kairo.at","bug_id":805745,"tags":[],"text":"I don't remember me saying we need QA here, just that we need progress here of some sort - but thanks, Anthony, for trying to get things going.\nI'm even more delighted to hear about Timothy's progress, though, I'd surely be happy to get this one off the topcrash list!\n\nThat said, from a code POV, if this really affects 18 and is a sec-crit, we should request tracking and later approval for that train.","id":6899007,"creation_time":"2012-12-10T20:51:38Z","raw_text":"I don't remember me saying we need QA here, just that we need progress here of some sort - but thanks, Anthony, for trying to get things going.\nI'm even more delighted to hear about Timothy's progress, though, I'd surely be happy to get this one off the topcrash list!\n\nThat said, from a code POV, if this really affects 18 and is a sec-crit, we should request tracking and later approval for that train."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-10T20:57:02Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Robert Kaiser (:kairo@mozilla.com) from comment #39)\n> I don't remember me saying we need QA here, just that we need progress here\n> of some sort - but thanks, Anthony, for trying to get things going.\n> I'm even more delighted to hear about Timothy's progress, though, I'd surely\n> be happy to get this one off the topcrash list!\n\nBug 782980 added a flush to the painting call path, which can destroy almost anything. Previously we would flush before painting on a WillPaint notification so the path should be mostly safe against this. I'm making it completely safe for this, which involves making the widget-backend specific painting code for each backend we have handle this case (destroying of |this|).\n\n> That said, from a code POV, if this really affects 18 and is a sec-crit, we\n> should request tracking and later approval for that train.\n\nIt would affect anywhere that bug 782980 landed, that bug has milestone 17, so 17, 18, 19, etc should be affected by that logic.","id":6899042,"creation_time":"2012-12-10T20:57:02Z","raw_text":"(In reply to Robert Kaiser (:kairo@mozilla.com) from comment #39)\n> I don't remember me saying we need QA here, just that we need progress here\n> of some sort - but thanks, Anthony, for trying to get things going.\n> I'm even more delighted to hear about Timothy's progress, though, I'd surely\n> be happy to get this one off the topcrash list!\n\nBug 782980 added a flush to the painting call path, which can destroy almost anything. Previously we would flush before painting on a WillPaint notification so the path should be mostly safe against this. I'm making it completely safe for this, which involves making the widget-backend specific painting code for each backend we have handle this case (destroying of |this|).\n\n> That said, from a code POV, if this really affects 18 and is a sec-crit, we\n> should request tracking and later approval for that train.\n\nIt would affect anywhere that bug 782980 landed, that bug has milestone 17, so 17, 18, 19, etc should be affected by that logic."},{"is_private":false,"attachment_id":null,"creator":"kairo@kairo.at","time":"2012-12-10T21:17:48Z","author":"kairo@kairo.at","bug_id":805745,"tags":[],"text":"Requesting tracking for 18 based on comment 40 saying this affects 17 and 18 and that it's marked sec-crit.\nNone of the crash signatures listed here are in the top 300 browser crashes on 18.0b3, though, while gfxASurface::Release() is still #2 on Aurora 19.","id":6899120,"creation_time":"2012-12-10T21:17:48Z","raw_text":"Requesting tracking for 18 based on comment 40 saying this affects 17 and 18 and that it's marked sec-crit.\nNone of the crash signatures listed here are in the top 300 browser crashes on 18.0b3, though, while gfxASurface::Release() is still #2 on Aurora 19."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-10T22:04:28Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"I think the nsView::DidPaintWindow crashes are probably caused by the same thing.","id":6899280,"creation_time":"2012-12-10T22:04:28Z","raw_text":"I think the nsView::DidPaintWindow crashes are probably caused by the same thing."},{"is_private":false,"attachment_id":690653,"creator":"tnikkel@gmail.com","time":"2012-12-11T01:52:43Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Created attachment 690653\nMove the forced repaint from the Paint notification to the WillPaint notification.","id":6900153,"creation_time":"2012-12-11T01:52:43Z","raw_text":""},{"is_private":false,"attachment_id":690654,"creator":"tnikkel@gmail.com","time":"2012-12-11T01:53:17Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Created attachment 690654\nRe-get the view after calling PaintWindow because it can flush (via WillPaint).","id":6900157,"creation_time":"2012-12-11T01:53:17Z","raw_text":""},{"is_private":false,"attachment_id":690655,"creator":"tnikkel@gmail.com","time":"2012-12-11T01:54:48Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Created attachment 690655\nWillPaint notification can flush, so re-get the listener after it on GTK2 widget backend.\n\nKarl, please double check that I don't miss doing something important in this function by adding an early return false.","id":6900164,"creation_time":"2012-12-11T01:54:48Z","raw_text":"Karl, please double check that I don't miss doing something important in this function by adding an early return false."},{"is_private":false,"attachment_id":690657,"creator":"tnikkel@gmail.com","time":"2012-12-11T01:57:33Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Created attachment 690657\nWillPaint notification can flush, so re-get the listener after it on Windows widget backend.\n\nThis is early enough in the function that there shouldn't be any state that we need to cleanup by my reading of this function.","id":6900173,"creation_time":"2012-12-11T01:57:33Z","raw_text":"This is early enough in the function that there shouldn't be any state that we need to cleanup by my reading of this function."},{"is_private":false,"attachment_id":690659,"creator":"tnikkel@gmail.com","time":"2012-12-11T01:59:45Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Created attachment 690659\nPaint notification can flush (via WillPaint), so re-check if the listener still exists after on puppet widget backend.","id":6900188,"creation_time":"2012-12-11T01:59:45Z","raw_text":""},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-11T02:02:40Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"I checked that the major widget backends hold a reference to the widget during a paint event so we don't have to worry about it going away, just Destroy etc being called on it.","id":6900200,"creation_time":"2012-12-11T02:02:40Z","raw_text":"I checked that the major widget backends hold a reference to the widget during a paint event so we don't have to worry about it going away, just Destroy etc being called on it."},{"is_private":false,"attachment_id":690659,"creator":"cjones.bugs@gmail.com","time":"2012-12-11T03:26:34Z","author":"cjones.bugs@gmail.com","bug_id":805745,"tags":[],"text":"Comment on attachment 690659\nPaint notification can flush (via WillPaint), so re-check if the listener still exists after on puppet widget backend.\n\nNit, { }.","id":6900372,"creation_time":"2012-12-11T03:26:34Z","raw_text":"Nit, { }."},{"is_private":false,"attachment_id":690657,"creator":"jmathies@mozilla.com","time":"2012-12-11T12:10:45Z","author":"jmathies@mozilla.com","bug_id":805745,"tags":[],"text":"Comment on attachment 690657\nWillPaint notification can flush, so re-get the listener after it on Windows widget backend.\n\nHow about PaintWindow and DidPaintWindow? Do we need the same refresh there?\n\nThis seems a little brittle. Could listener come from a helper that always gets the current value from mAttachedWidgetListener or mWidgetListener and checks mDestroyCalled and then returns a result callers can check?","id":6901387,"creation_time":"2012-12-11T12:10:45Z","raw_text":"How about PaintWindow and DidPaintWindow? Do we need the same refresh there?\n\nThis seems a little brittle. Could listener come from a helper that always gets the current value from mAttachedWidgetListener or mWidgetListener and checks mDestroyCalled and then returns a result callers can check?"},{"is_private":false,"attachment_id":690817,"creator":"jmathies@mozilla.com","time":"2012-12-11T12:26:17Z","author":"jmathies@mozilla.com","bug_id":805745,"tags":[],"text":"Created attachment 690817\nwinrt widget patch","id":6901425,"creation_time":"2012-12-11T12:26:17Z","raw_text":""},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-11T14:57:34Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Jim Mathies [:jimm] from comment #50)\n> How about PaintWindow and DidPaintWindow? Do we need the same refresh there?\n\nOnly WillPaintWindow should be allowed to flush.\n\n> This seems a little brittle. Could listener come from a helper that always\n> gets the current value from mAttachedWidgetListener or mWidgetListener and\n> checks mDestroyCalled and then returns a result callers can check?\n\nI can do that.","id":6901815,"creation_time":"2012-12-11T14:57:34Z","raw_text":"(In reply to Jim Mathies [:jimm] from comment #50)\n> How about PaintWindow and DidPaintWindow? Do we need the same refresh there?\n\nOnly WillPaintWindow should be allowed to flush.\n\n> This seems a little brittle. Could listener come from a helper that always\n> gets the current value from mAttachedWidgetListener or mWidgetListener and\n> checks mDestroyCalled and then returns a result callers can check?\n\nI can do that."},{"is_private":false,"attachment_id":690817,"creator":"tnikkel@gmail.com","time":"2012-12-11T15:00:06Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Comment on attachment 690817\nwinrt widget patch\n\nThis looks fine, although I don't think you need to re-get the listener after PaintWindow. Add a comment why you are re-getting the listener after WillPaintWindow though?\n\nDoes the winrt code hold a reference to |this| during a call to MetroWidget::Paint? Because I think it should if it doesn't.","id":6901823,"creation_time":"2012-12-11T15:00:06Z","raw_text":"This looks fine, although I don't think you need to re-get the listener after PaintWindow. Add a comment why you are re-getting the listener after WillPaintWindow though?\n\nDoes the winrt code hold a reference to |this| during a call to MetroWidget::Paint? Because I think it should if it doesn't."},{"is_private":false,"attachment_id":690867,"creator":"tnikkel@gmail.com","time":"2012-12-11T15:08:17Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Created attachment 690867\nWillPaint notification can flush, so re-get the listener after it on Windows widget backend.","id":6901859,"creation_time":"2012-12-11T15:08:17Z","raw_text":""},{"is_private":false,"attachment_id":690653,"creator":"tnikkel@gmail.com","time":"2012-12-11T15:20:49Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Comment on attachment 690653\nMove the forced repaint from the Paint notification to the WillPaint notification.\n\nI'm using this secapproval request for all patches in this bug.\n\n\n[Security approval request comment]\nHow easily can the security issue be deduced from the patch?\nThe patches point out where destruction of objects can happen where we use them afterwards, but they don't obviously provide a way to hit that case. However there are STR posted in the open bug 793983. The check-in comments pretty much restate what is already added by in-code comments in the patches.\n\nDo comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?\nSame answer as above.\n\nWhich older supported branches are affected by this flaw?\nversion 17 and after\n\nIf not all supported branches, which bug introduced the flaw?\nbug 782980\n\nDo you have backports for the affected branches? If not, how different, hard to create, and risky will they be?\nif the patches don't apply as is, backports should be straight forward.\n\nHow likely is this patch to cause regressions; how much testing does it need?\nIt should only be handling cases where we would crash before, so relatively safe.","id":6901905,"creation_time":"2012-12-11T15:20:49Z","raw_text":"I'm using this secapproval request for all patches in this bug.\n\n\n[Security approval request comment]\nHow easily can the security issue be deduced from the patch?\nThe patches point out where destruction of objects can happen where we use them afterwards, but they don't obviously provide a way to hit that case. However there are STR posted in the open bug 793983. The check-in comments pretty much restate what is already added by in-code comments in the patches.\n\nDo comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?\nSame answer as above.\n\nWhich older supported branches are affected by this flaw?\nversion 17 and after\n\nIf not all supported branches, which bug introduced the flaw?\nbug 782980\n\nDo you have backports for the affected branches? If not, how different, hard to create, and risky will they be?\nif the patches don't apply as is, backports should be straight forward.\n\nHow likely is this patch to cause regressions; how much testing does it need?\nIt should only be handling cases where we would crash before, so relatively safe."},{"is_private":false,"attachment_id":null,"creator":"jmathies@mozilla.com","time":"2012-12-11T15:36:33Z","author":"jmathies@mozilla.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #53)\n> Comment on attachment 690817\n> winrt widget patch\n> \n> This looks fine, although I don't think you need to re-get the listener\n> after PaintWindow. Add a comment why you are re-getting the listener after\n> WillPaintWindow though?\n> \n> Does the winrt code hold a reference to |this| during a call to\n> MetroWidget::Paint? Because I think it should if it doesn't.\n\nYes there are a few since there is only one main widget.","id":6901965,"creation_time":"2012-12-11T15:36:33Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #53)\n> Comment on attachment 690817\n> winrt widget patch\n> \n> This looks fine, although I don't think you need to re-get the listener\n> after PaintWindow. Add a comment why you are re-getting the listener after\n> WillPaintWindow though?\n> \n> Does the winrt code hold a reference to |this| during a call to\n> MetroWidget::Paint? Because I think it should if it doesn't.\n\nYes there are a few since there is only one main widget."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-11T23:11:27Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"https://tbpl.mozilla.org/?tree=Try&rev=2dc6ec396b9f","id":6903969,"creation_time":"2012-12-11T23:11:27Z","raw_text":"https://tbpl.mozilla.org/?tree=Try&rev=2dc6ec396b9f"},{"is_private":false,"attachment_id":null,"creator":"akeybl@mozilla.com","time":"2012-12-12T21:31:32Z","author":"akeybl@mozilla.com","bug_id":805745,"tags":[],"text":"Please also prepare/nominate patches for branches.","id":6908047,"creation_time":"2012-12-12T21:31:32Z","raw_text":"Please also prepare/nominate patches for branches."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-12T21:58:44Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/9f6c579151c5\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/789e54325d76\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/9aae7b226f3d\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/65d0aedb6ac4\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/956f6e2b4b70","id":6908175,"creation_time":"2012-12-12T21:58:44Z","raw_text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/9f6c579151c5\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/789e54325d76\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/9aae7b226f3d\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/65d0aedb6ac4\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/956f6e2b4b70"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-12T21:59:08Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Not fixed until merged to m-c.","id":6908177,"creation_time":"2012-12-12T21:59:08Z","raw_text":"Not fixed until merged to m-c."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-12T22:00:08Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Jim, I'll leave landing the winrt patch to you as that code isn't merged to m-c/inbound yet.","id":6908182,"creation_time":"2012-12-12T22:00:08Z","raw_text":"Jim, I'll leave landing the winrt patch to you as that code isn't merged to m-c/inbound yet."},{"is_private":false,"attachment_id":null,"creator":"bas@basschouten.com","time":"2012-12-13T15:54:52Z","author":"bas@basschouten.com","bug_id":805745,"tags":[],"text":"Is there anything we can do here to detect if something here goes wrong again? As far as I can tell this is still a pretty fragile balance, I'm worried we'll regress something like this again if we don't pay close attention.","id":6910704,"creation_time":"2012-12-13T15:54:52Z","raw_text":"Is there anything we can do here to detect if something here goes wrong again? As far as I can tell this is still a pretty fragile balance, I'm worried we'll regress something like this again if we don't pay close attention."},{"is_private":false,"attachment_id":null,"creator":"emorley@mozilla.com","time":"2012-12-13T18:35:00Z","author":"emorley@mozilla.com","bug_id":805745,"tags":[],"text":"https://hg.mozilla.org/mozilla-central/rev/9f6c579151c5\nhttps://hg.mozilla.org/mozilla-central/rev/789e54325d76\nhttps://hg.mozilla.org/mozilla-central/rev/9aae7b226f3d\nhttps://hg.mozilla.org/mozilla-central/rev/65d0aedb6ac4\nhttps://hg.mozilla.org/mozilla-central/rev/956f6e2b4b70","id":6911497,"creation_time":"2012-12-13T18:35:00Z","raw_text":"https://hg.mozilla.org/mozilla-central/rev/9f6c579151c5\nhttps://hg.mozilla.org/mozilla-central/rev/789e54325d76\nhttps://hg.mozilla.org/mozilla-central/rev/9aae7b226f3d\nhttps://hg.mozilla.org/mozilla-central/rev/65d0aedb6ac4\nhttps://hg.mozilla.org/mozilla-central/rev/956f6e2b4b70"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-14T01:23:03Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Maybe we can add a test based on comment 19.","id":6913230,"creation_time":"2012-12-14T01:23:03Z","raw_text":"Maybe we can add a test based on comment 19."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-12-15T19:51:02Z","author":"scoobidiver@netcourrier.com","bug_id":805745,"tags":[],"text":"64-bit crashes are not fixed: https://crash-stats.mozilla.com/report/list?signature=%400x0+|+nsBaseWidget%3A%3AAutoLayerManagerSetup%3A%3A~AutoLayerManagerSetup%28%29","id":6918061,"creation_time":"2012-12-15T19:51:02Z","raw_text":"64-bit crashes are not fixed: https://crash-stats.mozilla.com/report/list?signature=%400x0+|+nsBaseWidget%3A%3AAutoLayerManagerSetup%3A%3A~AutoLayerManagerSetup%28%29"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-16T20:36:05Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Backed out \"Move the forced repaint from the Paint notification to the WillPaint notification.\" because it made bug 813024 much worse\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/62a769a3ae0e","id":6919214,"creation_time":"2012-12-16T20:36:05Z","raw_text":"Backed out \"Move the forced repaint from the Paint notification to the WillPaint notification.\" because it made bug 813024 much worse\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/62a769a3ae0e"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-17T06:37:05Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Relanded because I landed a fix for bug 813024.\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/a268b5d3166d","id":6919814,"creation_time":"2012-12-17T06:37:05Z","raw_text":"Relanded because I landed a fix for bug 813024.\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/a268b5d3166d"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-17T07:26:25Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"We can open a new bug to deal with the crashes that remain, because we've clearly fixed some of the crashes.","id":6919857,"creation_time":"2012-12-17T07:26:25Z","raw_text":"We can open a new bug to deal with the crashes that remain, because we've clearly fixed some of the crashes."},{"is_private":false,"attachment_id":null,"creator":"emorley@mozilla.com","time":"2012-12-17T14:37:38Z","author":"emorley@mozilla.com","bug_id":805745,"tags":[],"text":"https://hg.mozilla.org/mozilla-central/rev/a268b5d3166d","id":6920708,"creation_time":"2012-12-17T14:37:38Z","raw_text":"https://hg.mozilla.org/mozilla-central/rev/a268b5d3166d"},{"is_private":false,"attachment_id":null,"creator":"bbajaj@mozilla.com","time":"2012-12-17T20:58:33Z","author":"bbajaj@mozilla.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #67)\n> Relanded because I landed a fix for bug 813024.\n> https://hg.mozilla.org/integration/mozilla-inbound/rev/a268b5d3166d\n\nThis seems to have fixed top-crasher,Bug 793983.Can we have comment# 64 addressed and a patch uplifted for branches if it is low risk & well tested before tomorrow(beta 5 going to build) ?","id":6922233,"creation_time":"2012-12-17T20:58:33Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #67)\n> Relanded because I landed a fix for bug 813024.\n> https://hg.mozilla.org/integration/mozilla-inbound/rev/a268b5d3166d\n\nThis seems to have fixed top-crasher,Bug 793983.Can we have comment# 64 addressed and a patch uplifted for branches if it is low risk & well tested before tomorrow(beta 5 going to build) ?"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-17T21:01:25Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to bhavana bajaj [:bajaj] from comment #70)\n> (In reply to Timothy Nikkel (:tn) from comment #67)\n> > Relanded because I landed a fix for bug 813024.\n> > https://hg.mozilla.org/integration/mozilla-inbound/rev/a268b5d3166d\n> \n> This seems to have fixed top-crasher,Bug 793983.Can we have comment# 64\n> addressed and a patch uplifted for branches if it is low risk & well tested\n> before tomorrow(beta 5 going to build) ?\n\nI'm not sure it will be well tested by tomorrow. The initial landing here made bug 813024 worse, and the fix for bug 813024 won't be in a nightly until tomorrow, we'd need to land bug 813024 as well as this bug on branches.","id":6922241,"creation_time":"2012-12-17T21:01:25Z","raw_text":"(In reply to bhavana bajaj [:bajaj] from comment #70)\n> (In reply to Timothy Nikkel (:tn) from comment #67)\n> > Relanded because I landed a fix for bug 813024.\n> > https://hg.mozilla.org/integration/mozilla-inbound/rev/a268b5d3166d\n> \n> This seems to have fixed top-crasher,Bug 793983.Can we have comment# 64\n> addressed and a patch uplifted for branches if it is low risk & well tested\n> before tomorrow(beta 5 going to build) ?\n\nI'm not sure it will be well tested by tomorrow. The initial landing here made bug 813024 worse, and the fix for bug 813024 won't be in a nightly until tomorrow, we'd need to land bug 813024 as well as this bug on branches."},{"is_private":false,"attachment_id":690653,"creator":"tnikkel@gmail.com","time":"2012-12-18T19:15:29Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Comment on attachment 690653\nMove the forced repaint from the Paint notification to the WillPaint notification.\n\nThis is a request for all the patches.\n\n[Approval Request Comment]\nBug caused by (feature/regressing bug #): bug 782980\nUser impact if declined: reproducible crashes\nTesting completed (on m-c, etc.): been on nightly\nRisk to taking this patch (and alternatives if risky): should just fix crashes, no real alternatives\nString or UUID changes made by this patch: none","id":6926119,"creation_time":"2012-12-18T19:15:29Z","raw_text":"This is a request for all the patches.\n\n[Approval Request Comment]\nBug caused by (feature/regressing bug #): bug 782980\nUser impact if declined: reproducible crashes\nTesting completed (on m-c, etc.): been on nightly\nRisk to taking this patch (and alternatives if risky): should just fix crashes, no real alternatives\nString or UUID changes made by this patch: none"},{"is_private":false,"attachment_id":690653,"creator":"bbajaj@mozilla.com","time":"2012-12-18T21:08:26Z","author":"bbajaj@mozilla.com","bug_id":805745,"tags":[],"text":"Comment on attachment 690653\nMove the forced repaint from the Paint notification to the WillPaint notification.\n\nA relatively safe patch fixing a lot of crashes.Approving on branches.","id":6926624,"creation_time":"2012-12-18T21:08:26Z","raw_text":"A relatively safe patch fixing a lot of crashes.Approving on branches."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-18T22:14:06Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"https://hg.mozilla.org/releases/mozilla-beta/rev/254fe89b5c61\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/1a013ff8e15f\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/b0d963f152be\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/af287e869ef5\n\n\"Re-get the view after calling PaintWindow because it can flush (via WillPaint).\" didn't need to be landed on beta as the problematic code doesn't exist there.","id":6926897,"creation_time":"2012-12-18T22:14:06Z","raw_text":"https://hg.mozilla.org/releases/mozilla-beta/rev/254fe89b5c61\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/1a013ff8e15f\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/b0d963f152be\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/af287e869ef5\n\n\"Re-get the view after calling PaintWindow because it can flush (via WillPaint).\" didn't need to be landed on beta as the problematic code doesn't exist there."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-18T22:31:17Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"https://hg.mozilla.org/releases/mozilla-aurora/rev/6268ef939d15\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/c987ef477b34\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/572fcc921c2e\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/eedd02509207\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/a87c44ff3252","id":6926977,"creation_time":"2012-12-18T22:31:17Z","raw_text":"https://hg.mozilla.org/releases/mozilla-aurora/rev/6268ef939d15\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/c987ef477b34\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/572fcc921c2e\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/eedd02509207\nhttps://hg.mozilla.org/releases/mozilla-aurora/rev/a87c44ff3252"},{"is_private":false,"attachment_id":null,"creator":"ryanvm@gmail.com","time":"2012-12-19T01:50:46Z","author":"ryanvm@gmail.com","bug_id":805745,"tags":[],"text":"https://hg.mozilla.org/releases/mozilla-b2g18/rev/af287e869ef5\nhttps://hg.mozilla.org/releases/mozilla-b2g18/rev/b0d963f152be\nhttps://hg.mozilla.org/releases/mozilla-b2g18/rev/1a013ff8e15f\nhttps://hg.mozilla.org/releases/mozilla-b2g18/rev/254fe89b5c61","id":6927752,"creation_time":"2012-12-19T01:50:46Z","raw_text":"https://hg.mozilla.org/releases/mozilla-b2g18/rev/af287e869ef5\nhttps://hg.mozilla.org/releases/mozilla-b2g18/rev/b0d963f152be\nhttps://hg.mozilla.org/releases/mozilla-b2g18/rev/1a013ff8e15f\nhttps://hg.mozilla.org/releases/mozilla-b2g18/rev/254fe89b5c61"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-19T19:14:48Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"Considering this was only reproducible in optimized builds, would it be possible to get optimized builds generated for each of the branches where this is fixed for verification?","id":6930095,"creation_time":"2012-12-19T19:14:48Z","raw_text":"Considering this was only reproducible in optimized builds, would it be possible to get optimized builds generated for each of the branches where this is fixed for verification?"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-19T19:24:18Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Optimized builds are what we ship to users, so they should be easily available.","id":6930147,"creation_time":"2012-12-19T19:24:18Z","raw_text":"Optimized builds are what we ship to users, so they should be easily available."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-19T19:25:16Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #78)\n> Optimized builds are what we ship to users, so they should be easily\n> available.\n\nOkay, thanks. I'll make an attempt at reproducing and verifying this fixed after my meetings today.","id":6930155,"creation_time":"2012-12-19T19:25:16Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #78)\n> Optimized builds are what we ship to users, so they should be easily\n> available.\n\nOkay, thanks. I'll make an attempt at reproducing and verifying this fixed after my meetings today."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-20T00:02:23Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"Crash reproduced using a slight revision of the steps in comment 19 (Farcry 3 is no longer preorder):\n\n1. Load http://shop.ubi.com\n2. Select \"Far Cry\" from \"Our Brands\" menu\n3. Select \"Add to Cart\" from \"Far Cry 3\"\n4. Select \"Add to Cart\" from \"PC Download\"\n5. Select \"Checkout\"\n6. Click the down arrow on one of the dropdown boxes for the \"Billing Information\"\n> Crash after a couple second hang\n\nReproduced in 2012-11-27 Firefox Nightly. Will now try to verify fixed.","id":6931498,"creation_time":"2012-12-20T00:02:23Z","raw_text":"Crash reproduced using a slight revision of the steps in comment 19 (Farcry 3 is no longer preorder):\n\n1. Load http://shop.ubi.com\n2. Select \"Far Cry\" from \"Our Brands\" menu\n3. Select \"Add to Cart\" from \"Far Cry 3\"\n4. Select \"Add to Cart\" from \"PC Download\"\n5. Select \"Checkout\"\n6. Click the down arrow on one of the dropdown boxes for the \"Billing Information\"\n> Crash after a couple second hang\n\nReproduced in 2012-11-27 Firefox Nightly. Will now try to verify fixed."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-20T00:13:14Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"Verified fixed in:\n * Firefox 20.0a1 2012-12-19\n * Firefox 19.0a2 2012-12-19\n * Firefox 18.0b5 build 1","id":6931535,"creation_time":"2012-12-20T00:13:14Z","raw_text":"Verified fixed in:\n * Firefox 20.0a1 2012-12-19\n * Firefox 19.0a2 2012-12-19\n * Firefox 18.0b5 build 1"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-20T00:14:26Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"I'm wondering if it would be useful to come up with a minimized testcase so we can get this checked into the testsuite. If so, I can get someone in QA to assist with that.","id":6931538,"creation_time":"2012-12-20T00:14:26Z","raw_text":"I'm wondering if it would be useful to come up with a minimized testcase so we can get this checked into the testsuite. If so, I can get someone in QA to assist with that."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-20T00:20:54Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"I'm not sure if this is sufficient to generate a crash but the important pieces of the ubi testcase where a select that has a onfocus handler that caused a frame reconstruct, so for example changing the CSS display of the select between block and inline would do it.","id":6931565,"creation_time":"2012-12-20T00:20:54Z","raw_text":"I'm not sure if this is sufficient to generate a crash but the important pieces of the ubi testcase where a select that has a onfocus handler that caused a frame reconstruct, so for example changing the CSS display of the select between block and inline would do it."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-20T00:34:35Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #83)\n> I'm not sure if this is sufficient to generate a crash but the important\n> pieces of the ubi testcase where a select that has a onfocus handler that\n> caused a frame reconstruct, so for example changing the CSS display of the\n> select between block and inline would do it.\n\nWhat would you need to have an in-testsuite testcase? Isolate the HTML/CSS/JS into a mochitest?","id":6931626,"creation_time":"2012-12-20T00:34:35Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #83)\n> I'm not sure if this is sufficient to generate a crash but the important\n> pieces of the ubi testcase where a select that has a onfocus handler that\n> caused a frame reconstruct, so for example changing the CSS display of the\n> select between block and inline would do it.\n\nWhat would you need to have an in-testsuite testcase? Isolate the HTML/CSS/JS into a mochitest?"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2012-12-20T00:38:45Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"I would just construct a page meeting the description of comment 83 and see if it reproduces the problem. If not I would try reducing the ubi testcase. And then turn that into an automated test by putting it into mochitest format and automating the clicking to cause the crash.","id":6931641,"creation_time":"2012-12-20T00:38:45Z","raw_text":"I would just construct a page meeting the description of comment 83 and see if it reproduces the problem. If not I would try reducing the ubi testcase. And then turn that into an automated test by putting it into mochitest format and automating the clicking to cause the crash."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-12-20T01:05:04Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #85)\n> I would just construct a page meeting the description of comment 83 and see\n> if it reproduces the problem. If not I would try reducing the ubi testcase.\n> And then turn that into an automated test by putting it into mochitest\n> format and automating the clicking to cause the crash.\n\nOkay, thank you Timothy. I'm ccing Kamil on this bug to fulfill that request. Kamil is one of our trusted community security testers.\n\nKamil, as a first step, can you try to mock up and attach a minimized HTML test based on comment 83 which reproduces this crash. If unsuccessful, try creating a minimized HTML test for the shop.ubi.com test outlined in comment 81. Thanks","id":6931746,"creation_time":"2012-12-20T01:05:04Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #85)\n> I would just construct a page meeting the description of comment 83 and see\n> if it reproduces the problem. If not I would try reducing the ubi testcase.\n> And then turn that into an automated test by putting it into mochitest\n> format and automating the clicking to cause the crash.\n\nOkay, thank you Timothy. I'm ccing Kamil on this bug to fulfill that request. Kamil is one of our trusted community security testers.\n\nKamil, as a first step, can you try to mock up and attach a minimized HTML test based on comment 83 which reproduces this crash. If unsuccessful, try creating a minimized HTML test for the shop.ubi.com test outlined in comment 81. Thanks"},{"is_private":false,"attachment_id":690653,"creator":"tnikkel@gmail.com","time":"2012-12-21T02:10:38Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Comment on attachment 690653\nMove the forced repaint from the Paint notification to the WillPaint notification.\n\n[Approval Request Comment]\nIf this is not a sec:{high,crit} bug, please state case for ESR consideration: it's listed as sec-crit\nUser impact if declined: some amount of crashes\nFix Landed on Version: 18, 19, 20\nRisk to taking this patch (and alternatives if risky): not very risky\nString or UUID changes made by this patch: none\n\nSee https://wiki.mozilla.org/Release_Management/ESR_Landing_Process for more info.","id":6935966,"creation_time":"2012-12-21T02:10:38Z","raw_text":"[Approval Request Comment]\nIf this is not a sec:{high,crit} bug, please state case for ESR consideration: it's listed as sec-crit\nUser impact if declined: some amount of crashes\nFix Landed on Version: 18, 19, 20\nRisk to taking this patch (and alternatives if risky): not very risky\nString or UUID changes made by this patch: none\n\nSee https://wiki.mozilla.org/Release_Management/ESR_Landing_Process for more info."},{"is_private":false,"attachment_id":null,"creator":"kjozwiak@mozilla.com","time":"2012-12-21T02:57:23Z","author":"kjozwiak@mozilla.com","bug_id":805745,"tags":[],"text":"(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #86)\n> Kamil, as a first step, can you try to mock up and attach a minimized HTML\n> test based on comment 83 which reproduces this crash.\n\nYup will do!","id":6936019,"creation_time":"2012-12-21T02:57:23Z","raw_text":"(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #86)\n> Kamil, as a first step, can you try to mock up and attach a minimized HTML\n> test based on comment 83 which reproduces this crash.\n\nYup will do!"},{"is_private":false,"attachment_id":null,"creator":"ryanvm@gmail.com","time":"2012-12-23T17:34:06Z","author":"ryanvm@gmail.com","bug_id":805745,"tags":[],"text":"https://hg.mozilla.org/releases/mozilla-esr17/rev/d3f6ea42bf2b\nhttps://hg.mozilla.org/releases/mozilla-esr17/rev/835cfd3111b6\nhttps://hg.mozilla.org/releases/mozilla-esr17/rev/4fa6d2e7f89d\nhttps://hg.mozilla.org/releases/mozilla-esr17/rev/02abf9bf846b\n\n(I went with the same set of patches that landed on beta)","id":6941663,"creation_time":"2012-12-23T17:34:06Z","raw_text":"https://hg.mozilla.org/releases/mozilla-esr17/rev/d3f6ea42bf2b\nhttps://hg.mozilla.org/releases/mozilla-esr17/rev/835cfd3111b6\nhttps://hg.mozilla.org/releases/mozilla-esr17/rev/4fa6d2e7f89d\nhttps://hg.mozilla.org/releases/mozilla-esr17/rev/02abf9bf846b\n\n(I went with the same set of patches that landed on beta)"},{"is_private":false,"attachment_id":696660,"creator":"kjozwiak@mozilla.com","time":"2012-12-30T23:13:39Z","author":"kjozwiak@mozilla.com","bug_id":805745,"tags":[],"text":"Created attachment 696660\nReproduce Crash using Ubi Case\n\nWent through the Ubi case that was mentioned above and narrowed it down to a single drop down. Reproduced the problem several times using the following build:\n\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/11/2012-11-27-04-20-13-mozilla-aurora/firefox-19.0a2.en-US.win32.installer.exe","id":6952605,"creation_time":"2012-12-30T23:13:39Z","raw_text":"Went through the Ubi case that was mentioned above and narrowed it down to a single drop down. Reproduced the problem several times using the following build:\n\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/11/2012-11-27-04-20-13-mozilla-aurora/firefox-19.0a2.en-US.win32.installer.exe"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2013-01-02T22:29:08Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"Thanks for the minimized test, Kamil.\n\nTimothy or Ryan, is the attached testcase enough to generate an in-testsuite test for this bug? If so, can one of you mentor Kamil in writing a patch?","id":6957749,"creation_time":"2013-01-02T22:29:08Z","raw_text":"Thanks for the minimized test, Kamil.\n\nTimothy or Ryan, is the attached testcase enough to generate an in-testsuite test for this bug? If so, can one of you mentor Kamil in writing a patch?"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2013-01-02T22:34:44Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"It looks good, but hopefully we can get rid jquery from the testcase, it's a lot of extra stuff we don't need. I hope that if we just rewrite the bit of inline javascript at the bottom to work without jquery that will be enough.","id":6957771,"creation_time":"2013-01-02T22:34:44Z","raw_text":"It looks good, but hopefully we can get rid jquery from the testcase, it's a lot of extra stuff we don't need. I hope that if we just rewrite the bit of inline javascript at the bottom to work without jquery that will be enough."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2013-01-02T22:36:29Z","author":"anthony.s.hughes@gmail.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #92)\n> It looks good, but hopefully we can get rid jquery from the testcase, it's a\n> lot of extra stuff we don't need. I hope that if we just rewrite the bit of\n> inline javascript at the bottom to work without jquery that will be enough.\n\nKamil, can you take a crack at this?","id":6957778,"creation_time":"2013-01-02T22:36:29Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #92)\n> It looks good, but hopefully we can get rid jquery from the testcase, it's a\n> lot of extra stuff we don't need. I hope that if we just rewrite the bit of\n> inline javascript at the bottom to work without jquery that will be enough.\n\nKamil, can you take a crack at this?"},{"is_private":false,"attachment_id":null,"creator":"kjozwiak@mozilla.com","time":"2013-01-02T22:43:28Z","author":"kjozwiak@mozilla.com","bug_id":805745,"tags":[],"text":"(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #93)\n> (In reply to Timothy Nikkel (:tn) from comment #92)\n> > It looks good, but hopefully we can get rid jquery from the testcase, it's a\n> > lot of extra stuff we don't need. I hope that if we just rewrite the bit of\n> > inline javascript at the bottom to work without jquery that will be enough.\n> \n> Kamil, can you take a crack at this?\n\nYup, I will try removing the jquery. I took a look at it but it was hard to go through as there's a lot. Will try narrowing it down without the jquery.","id":6957805,"creation_time":"2013-01-02T22:43:28Z","raw_text":"(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #93)\n> (In reply to Timothy Nikkel (:tn) from comment #92)\n> > It looks good, but hopefully we can get rid jquery from the testcase, it's a\n> > lot of extra stuff we don't need. I hope that if we just rewrite the bit of\n> > inline javascript at the bottom to work without jquery that will be enough.\n> \n> Kamil, can you take a crack at this?\n\nYup, I will try removing the jquery. I took a look at it but it was hard to go through as there's a lot. Will try narrowing it down without the jquery."},{"is_private":false,"attachment_id":697326,"creator":"kjozwiak@mozilla.com","time":"2013-01-03T04:25:09Z","author":"kjozwiak@mozilla.com","bug_id":805745,"tags":[],"text":"Created attachment 697326\nreduced test case without jquery\n\nWent through the test case and completely removed jquery leaving only plain javascript. The file has been reduced to 432 bytes from 57,997 bytes.\n\nThe crash happens when the style is set to focus and the iframe having a height of 1.\n\nLet me know if this works!","id":6958653,"creation_time":"2013-01-03T04:25:09Z","raw_text":"Went through the test case and completely removed jquery leaving only plain javascript. The file has been reduced to 432 bytes from 57,997 bytes.\n\nThe crash happens when the style is set to focus and the iframe having a height of 1.\n\nLet me know if this works!"},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2013-01-03T05:29:49Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"That looks great, thanks!\n\nDo you want someone to help you turning it into a mochitest or do you want someone else to do that part?","id":6958721,"creation_time":"2013-01-03T05:29:49Z","raw_text":"That looks great, thanks!\n\nDo you want someone to help you turning it into a mochitest or do you want someone else to do that part?"},{"is_private":false,"attachment_id":null,"creator":"kjozwiak@mozilla.com","time":"2013-01-03T05:56:20Z","author":"kjozwiak@mozilla.com","bug_id":805745,"tags":[],"text":"(In reply to Timothy Nikkel (:tn) from comment #96)\n> That looks great, thanks!\n> \n> Do you want someone to help you turning it into a mochitest or do you want\n> someone else to do that part?\n\nI am up for it! Might take a little longer then usual as I've never built the code but I am definitely up for it. I'll read up on the MDN docs and get back to you if I have trouble.","id":6958772,"creation_time":"2013-01-03T05:56:20Z","raw_text":"(In reply to Timothy Nikkel (:tn) from comment #96)\n> That looks great, thanks!\n> \n> Do you want someone to help you turning it into a mochitest or do you want\n> someone else to do that part?\n\nI am up for it! Might take a little longer then usual as I've never built the code but I am definitely up for it. I'll read up on the MDN docs and get back to you if I have trouble."},{"is_private":false,"attachment_id":null,"creator":"tnikkel@gmail.com","time":"2013-01-03T06:05:28Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Sure. It might help to look at an example. Here is a relatively simple mochitest that you can use as a template http://mxr.mozilla.org/mozilla-central/source/content/events/test/test_bug447736.html?force=1\n\nTo send a mouse event to open the dropdown you could use the synthesizeMouse function from EventUtils.js. There are numerous examples in the tree of it being used.","id":6958792,"creation_time":"2013-01-03T06:05:28Z","raw_text":"Sure. It might help to look at an example. Here is a relatively simple mochitest that you can use as a template http://mxr.mozilla.org/mozilla-central/source/content/events/test/test_bug447736.html?force=1\n\nTo send a mouse event to open the dropdown you could use the synthesizeMouse function from EventUtils.js. There are numerous examples in the tree of it being used."},{"is_private":false,"attachment_id":706939,"creator":"kjozwiak@mozilla.com","time":"2013-01-28T04:03:59Z","author":"kjozwiak@mozilla.com","bug_id":805745,"tags":[],"text":"Created attachment 706939\nmochitest\n\nI created a test that does the same as the simplified test case.\nIt synthesizes mouse events to the drop down so that it expands.\nThis makes the focus event fire and the style is changed which usually causes a crash.\n\nI checked out the code for an old aurora build so I could see if the manual test crashes.\nBut I was having trouble reproducing the crash even with that older checked out code, when it is run from the objdir.\nBut when I install it, it reproduces fine.\n\nWhen I run the newly created automated test, even know it does the same as what I do manually, it doesn't crash.\nSo I'm not sure if you want to:\n1) Add the test because maybe it would crash on the test servers if this bug still existed\n2) Make a suggestion on how I can reproduce it with the test.\nor 3) Not take this patch since I can't get it to crash.\n\nIf you do want to go ahead with the patch, please let me know if you'd like me to post this in a new bug instead since this bug is already resolved.","id":7043473,"creation_time":"2013-01-28T04:03:59Z","raw_text":"I created a test that does the same as the simplified test case.\nIt synthesizes mouse events to the drop down so that it expands.\nThis makes the focus event fire and the style is changed which usually causes a crash.\n\nI checked out the code for an old aurora build so I could see if the manual test crashes.\nBut I was having trouble reproducing the crash even with that older checked out code, when it is run from the objdir.\nBut when I install it, it reproduces fine.\n\nWhen I run the newly created automated test, even know it does the same as what I do manually, it doesn't crash.\nSo I'm not sure if you want to:\n1) Add the test because maybe it would crash on the test servers if this bug still existed\n2) Make a suggestion on how I can reproduce it with the test.\nor 3) Not take this patch since I can't get it to crash.\n\nIf you do want to go ahead with the patch, please let me know if you'd like me to post this in a new bug instead since this bug is already resolved."},{"is_private":false,"attachment_id":706939,"creator":"tnikkel@gmail.com","time":"2013-01-28T17:43:16Z","author":"tnikkel@gmail.com","bug_id":805745,"tags":[],"text":"Comment on attachment 706939\nmochitest\n\nThis looks good, thank you!\n\nWe should just check that it does fail in an unpatched build. I can do that.","id":7045165,"creation_time":"2013-01-28T17:43:16Z","raw_text":"This looks good, thank you!\n\nWe should just check that it does fail in an unpatched build. I can do that."}]}},"comments":{}}