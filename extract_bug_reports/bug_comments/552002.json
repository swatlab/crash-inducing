{"bugs":{"552002":{"comments":[{"is_private":false,"attachment_id":null,"creator":"mozillamarcia.knous@gmail.com","time":"2010-03-12T18:57:51Z","author":"mozillamarcia.knous@gmail.com","bug_id":552002,"tags":[],"text":"Seen while reviewing crash data and 100% reproducible on the site in the URL using Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.3a3pre) Gecko/20100312 Minefield/3.7a3pre\n\nSTR:\n1. Load site in URL\n2. Perform and right click event and then scroll. Crash.\n\nhttps://crash-stats.mozilla.com/report/index/36fa4e87-e61f-42cc-abce-b6cc92100312\nhttps://crash-stats.mozilla.com/report/index/762c0b32-8f02-4c28-9f83-ac3852100312\nhttps://crash-stats.mozilla.com/report/index/bp-85a1d79c-5fb1-4364-9e00-b14092100312\n\nare my three crash reports and my flash version is below.\n\n    File: Flash Player.plugin\n    Version: 10.1.51.95\n    Shockwave Flash 10.1 d51","id":4582053,"creation_time":"2010-03-12T18:57:51Z","raw_text":"Seen while reviewing crash data and 100% reproducible on the site in the URL using Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.3a3pre) Gecko/20100312 Minefield/3.7a3pre\n\nSTR:\n1. Load site in URL\n2. Perform and right click event and then scroll. Crash.\n\nhttps://crash-stats.mozilla.com/report/index/36fa4e87-e61f-42cc-abce-b6cc92100312\nhttps://crash-stats.mozilla.com/report/index/762c0b32-8f02-4c28-9f83-ac3852100312\nhttps://crash-stats.mozilla.com/report/index/bp-85a1d79c-5fb1-4364-9e00-b14092100312\n\nare my three crash reports and my flash version is below.\n\n    File: Flash Player.plugin\n    Version: 10.1.51.95\n    Shockwave Flash 10.1 d51"},{"is_private":false,"attachment_id":null,"creator":"mozillamarcia.knous@gmail.com","time":"2010-03-12T19:05:50Z","author":"mozillamarcia.knous@gmail.com","bug_id":552002,"tags":[],"text":"I am able to reproduce the crash on Windows using  Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.3a3pre) but I do get a completely different stack than Mac: http://crash-stats.mozilla.com/report/index/32439b8a-6242-44dc-922d-4291c2100312 where I crash in  [@ _filbuf ]. \n\nVersion: 10.0.45.2\nShockwave Flash 10.0 r45","id":4582067,"creation_time":"2010-03-12T19:05:50Z","raw_text":"I am able to reproduce the crash on Windows using  Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.3a3pre) but I do get a completely different stack than Mac: http://crash-stats.mozilla.com/report/index/32439b8a-6242-44dc-922d-4291c2100312 where I crash in  [@ _filbuf ]. \n\nVersion: 10.0.45.2\nShockwave Flash 10.0 r45"},{"is_private":false,"attachment_id":null,"creator":"bzbarsky@mit.edu","time":"2010-03-12T19:16:27Z","author":"bzbarsky@mit.edu","bug_id":552002,"tags":[],"text":"Smells like memory corruption of some sort... :(","id":4582093,"creation_time":"2010-03-12T19:16:27Z","raw_text":"Smells like memory corruption of some sort... :("},{"is_private":false,"attachment_id":null,"creator":"jruderman@gmail.com","time":"2010-03-13T04:06:19Z","author":"jruderman@gmail.com","bug_id":552002,"tags":[],"text":"We're not using [sg:investigate] any more.  Please use [sg:critical] or [sg:critical?] for scary crashes with testcases, like this one.\n\n(There's no special marking for \"this crash would be scary if it had a testcase\".  We want those bugs to be public to give them a shot at being fixed, but we don't want to draw too much evil attention to them.)","id":4582985,"creation_time":"2010-03-13T04:06:19Z","raw_text":"We're not using [sg:investigate] any more.  Please use [sg:critical] or [sg:critical?] for scary crashes with testcases, like this one.\n\n(There's no special marking for \"this crash would be scary if it had a testcase\".  We want those bugs to be public to give them a shot at being fixed, but we don't want to draw too much evil attention to them.)"},{"is_private":false,"attachment_id":null,"creator":"jruderman@gmail.com","time":"2010-03-13T04:13:10Z","author":"jruderman@gmail.com","bug_id":552002,"tags":[],"text":"I'm having trouble reproducing on Mac OS X 10.5.  Which is sad, because it's a platform where Valgrind works, and Valgrind is good at tracking down the source of memory corruption.\n\nAm I supposed to right-click on the Flash?  And then scroll with the mouse wheel / trackpad?  While the context menu is still up?","id":4582989,"creation_time":"2010-03-13T04:13:10Z","raw_text":"I'm having trouble reproducing on Mac OS X 10.5.  Which is sad, because it's a platform where Valgrind works, and Valgrind is good at tracking down the source of memory corruption.\n\nAm I supposed to right-click on the Flash?  And then scroll with the mouse wheel / trackpad?  While the context menu is still up?"},{"is_private":false,"attachment_id":null,"creator":"bugs@pettay.fi","time":"2010-03-14T15:39:33Z","author":"bugs@pettay.fi","bug_id":552002,"tags":[],"text":"Is this a trunk only problem?","id":4583999,"creation_time":"2010-03-14T15:39:33Z","raw_text":"Is this a trunk only problem?"},{"is_private":false,"attachment_id":null,"creator":"martijn.martijn@gmail.com","time":"2010-03-14T16:56:21Z","author":"martijn.martijn@gmail.com","bug_id":552002,"tags":[],"text":"I can reproduce this, I haven't been able to reproduce this in a 2010-03-11 build. There I get flash context menus that get 'stuck' and a Minefield that is basically unusable.\n\nIn a debug build, I see this in a debug build before the crash\n###!!! ASSERTION: Adding a script runner when that is prevented!: 'Error', file\nc:/mozilla-build/src/content/base/src/nsContentUtils.cpp, line 4599","id":4584054,"creation_time":"2010-03-14T16:56:21Z","raw_text":"I can reproduce this, I haven't been able to reproduce this in a 2010-03-11 build. There I get flash context menus that get 'stuck' and a Minefield that is basically unusable.\n\nIn a debug build, I see this in a debug build before the crash\n###!!! ASSERTION: Adding a script runner when that is prevented!: 'Error', file\nc:/mozilla-build/src/content/base/src/nsContentUtils.cpp, line 4599"},{"is_private":false,"attachment_id":432428,"creator":"martijn.martijn@gmail.com","time":"2010-03-14T16:56:58Z","author":"martijn.martijn@gmail.com","bug_id":552002,"tags":[],"text":"Created attachment 432428\nstack from debug build","id":4584055,"creation_time":"2010-03-14T16:56:58Z","raw_text":""},{"is_private":false,"attachment_id":null,"creator":"martijn.martijn@gmail.com","time":"2010-03-14T17:44:45Z","author":"martijn.martijn@gmail.com","bug_id":552002,"tags":[],"text":"I forgot, I had to disable html5 rendering, because it interfered with the page, somehow, causing a blank page.","id":4584092,"creation_time":"2010-03-14T17:44:45Z","raw_text":"I forgot, I had to disable html5 rendering, because it interfered with the page, somehow, causing a blank page."},{"is_private":false,"attachment_id":null,"creator":"martijn.martijn@gmail.com","time":"2010-03-14T23:27:39Z","author":"martijn.martijn@gmail.com","bug_id":552002,"tags":[],"text":"I'm seeing these crashes too on http://www.vanderaa.net/afterlife-video-trailer\nWhen right-clicking on one of the \"audio excerpts\" flash things (they are also flashing in a weird way, I suspect that is a direct2d bug of some sort).\n\nI also managed once to crash with a different stack on that site:\nhttp://crash-stats.mozilla.com/report/index/bp-19419c7f-f8ea-42d8-a7ac-b653a2100314\nI think (tentative) steps to reproduce: right-click on the main video, then minimize window, then close tab or something.","id":4584401,"creation_time":"2010-03-14T23:27:39Z","raw_text":"I'm seeing these crashes too on http://www.vanderaa.net/afterlife-video-trailer\nWhen right-clicking on one of the \"audio excerpts\" flash things (they are also flashing in a weird way, I suspect that is a direct2d bug of some sort).\n\nI also managed once to crash with a different stack on that site:\nhttp://crash-stats.mozilla.com/report/index/bp-19419c7f-f8ea-42d8-a7ac-b653a2100314\nI think (tentative) steps to reproduce: right-click on the main video, then minimize window, then close tab or something."},{"is_private":false,"attachment_id":null,"creator":"jst@mozilla.org","time":"2010-03-15T20:44:34Z","author":"jst@mozilla.org","bug_id":552002,"tags":[],"text":"Over to bent who will have a look at this...","id":4585776,"creation_time":"2010-03-15T20:44:34Z","raw_text":"Over to bent who will have a look at this..."},{"is_private":false,"attachment_id":null,"creator":"bugs@pettay.fi","time":"2010-03-15T23:07:15Z","author":"bugs@pettay.fi","bug_id":552002,"tags":[],"text":"This looks like a bug in plugin code, not in DOM events.\nBut feel free to change back the component and assign this bug to me if \nthe bug is somewhere in events code.","id":4586170,"creation_time":"2010-03-15T23:07:15Z","raw_text":"This looks like a bug in plugin code, not in DOM events.\nBut feel free to change back the component and assign this bug to me if \nthe bug is somewhere in events code."},{"is_private":false,"attachment_id":null,"creator":"bent.mozilla@gmail.com","time":"2010-04-09T22:34:54Z","author":"bent.mozilla@gmail.com","bug_id":552002,"tags":[],"text":"I think this is going to end up a dup of bug 535651 or bug 449129. In this case I think we're running NPRuntime stuff inside a paint.","id":4631307,"creation_time":"2010-04-09T22:34:54Z","raw_text":"I think this is going to end up a dup of bug 535651 or bug 449129. In this case I think we're running NPRuntime stuff inside a paint."},{"is_private":false,"attachment_id":null,"creator":"mozillamarcia.knous@gmail.com","time":"2010-04-12T18:03:00Z","author":"mozillamarcia.knous@gmail.com","bug_id":552002,"tags":[],"text":"I cannot reproduce this using  Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.3, but it easily reproduced on the trunk nightly.\n\n(In reply to comment #5)\n> Is this a trunk only problem?","id":4634304,"creation_time":"2010-04-12T18:03:00Z","raw_text":"I cannot reproduce this using  Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.3, but it easily reproduced on the trunk nightly.\n\n(In reply to comment #5)\n> Is this a trunk only problem?"},{"is_private":false,"attachment_id":null,"creator":"mozillamarcia.knous@gmail.com","time":"2010-04-26T22:24:21Z","author":"mozillamarcia.knous@gmail.com","bug_id":552002,"tags":[],"text":"Martijn: Are you still able to crash on the sites you mention in Comment 9?","id":4661478,"creation_time":"2010-04-26T22:24:21Z","raw_text":"Martijn: Are you still able to crash on the sites you mention in Comment 9?"},{"is_private":false,"attachment_id":null,"creator":"martijn.martijn@gmail.com","time":"2010-04-26T23:16:45Z","author":"martijn.martijn@gmail.com","bug_id":552002,"tags":[],"text":"No, I can't reproduce those anymore with the latest trunk build.","id":4661629,"creation_time":"2010-04-26T23:16:45Z","raw_text":"No, I can't reproduce those anymore with the latest trunk build."},{"is_private":false,"attachment_id":null,"creator":"mozillamarcia.knous@gmail.com","time":"2010-04-27T20:36:32Z","author":"mozillamarcia.knous@gmail.com","bug_id":552002,"tags":[],"text":"marcia will try to reproduce using the branch build tomorrow.","id":4663746,"creation_time":"2010-04-27T20:36:32Z","raw_text":"marcia will try to reproduce using the branch build tomorrow."},{"is_private":false,"attachment_id":null,"creator":"bugs@pettay.fi","time":"2010-04-27T20:49:41Z","author":"bugs@pettay.fi","bug_id":552002,"tags":[],"text":"(In reply to comment #6)\n> In a debug build, I see this in a debug build before the crash\n> ###!!! ASSERTION: Adding a script runner when that is prevented!: 'Error', file\n> c:/mozilla-build/src/content/base/src/nsContentUtils.cpp, line 4599\n\nJonas, Roc, I never really understood why nsContentUtils::AddScriptBlockerAndPreventAddingRunners()\nis ok.\nThe assertion was added in http://hg.mozilla.org/mozilla-central/rev/9584d6bce9c1","id":4663785,"creation_time":"2010-04-27T20:49:41Z","raw_text":"(In reply to comment #6)\n> In a debug build, I see this in a debug build before the crash\n> ###!!! ASSERTION: Adding a script runner when that is prevented!: 'Error', file\n> c:/mozilla-build/src/content/base/src/nsContentUtils.cpp, line 4599\n\nJonas, Roc, I never really understood why nsContentUtils::AddScriptBlockerAndPreventAddingRunners()\nis ok.\nThe assertion was added in http://hg.mozilla.org/mozilla-central/rev/9584d6bce9c1"},{"is_private":false,"attachment_id":null,"creator":"jonas@sicking.cc","time":"2010-04-27T21:03:32Z","author":"jonas@sicking.cc","bug_id":552002,"tags":[],"text":"IIRC the idea was that it marks a section where we really should never be adding any script runners. I.e. a section where script blockers technically shouldn't even be needed.\n\nHowever if we get something wrong and do accidentally attempt to add a scriptrunner, then we'll simply not run the runner. In an attempt to avoid exploitable crashes. I.e. we're attempting to turn an exploitable crash into a mere broken functionality.","id":4663833,"creation_time":"2010-04-27T21:03:32Z","raw_text":"IIRC the idea was that it marks a section where we really should never be adding any script runners. I.e. a section where script blockers technically shouldn't even be needed.\n\nHowever if we get something wrong and do accidentally attempt to add a scriptrunner, then we'll simply not run the runner. In an attempt to avoid exploitable crashes. I.e. we're attempting to turn an exploitable crash into a mere broken functionality."},{"is_private":false,"attachment_id":null,"creator":"roc@ocallahan.org","time":"2010-04-27T21:33:08Z","author":"roc@ocallahan.org","bug_id":552002,"tags":[],"text":"That's part of the truth.\n\nSee\nhttp://mxr.mozilla.org/mozilla-central/source/layout/generic/nsGfxScrollFrame.cpp#1740\n\nThe main reason is that blocking script execution suppresses flushing in nsPresShell, so we want to be able to add a script blocker to do that, but we want to be able to remove that blocker at a time when it is actually not safe to run scripts.","id":4663921,"creation_time":"2010-04-27T21:33:08Z","raw_text":"That's part of the truth.\n\nSee\nhttp://mxr.mozilla.org/mozilla-central/source/layout/generic/nsGfxScrollFrame.cpp#1740\n\nThe main reason is that blocking script execution suppresses flushing in nsPresShell, so we want to be able to add a script blocker to do that, but we want to be able to remove that blocker at a time when it is actually not safe to run scripts."},{"is_private":false,"attachment_id":null,"creator":"jonas@sicking.cc","time":"2010-04-27T23:51:41Z","author":"jonas@sicking.cc","bug_id":552002,"tags":[],"text":"Roc, if the main purpose is to suppress flushing, not suppress scripts, then would it make sense to instead add a flag to nsPresShell which disabled flushing and temporarily set that?","id":4664293,"creation_time":"2010-04-27T23:51:41Z","raw_text":"Roc, if the main purpose is to suppress flushing, not suppress scripts, then would it make sense to instead add a flag to nsPresShell which disabled flushing and temporarily set that?"},{"is_private":false,"attachment_id":null,"creator":"roc@ocallahan.org","time":"2010-04-27T23:59:30Z","author":"roc@ocallahan.org","bug_id":552002,"tags":[],"text":"We actually need to do both. I don't really know what crazy stuff Windows might do here.","id":4664312,"creation_time":"2010-04-27T23:59:30Z","raw_text":"We actually need to do both. I don't really know what crazy stuff Windows might do here."},{"is_private":false,"attachment_id":null,"creator":"mozillamarcia.knous@gmail.com","time":"2010-04-28T23:01:56Z","author":"mozillamarcia.knous@gmail.com","bug_id":552002,"tags":[],"text":"I cannot reproduce this issue using  Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.4) Gecko/20100413 Firefox/3.6.4 or the equivalent Windows 3.6.4 version.\n\n(In reply to comment #16)\n> marcia will try to reproduce using the branch build tomorrow.","id":4668364,"creation_time":"2010-04-28T23:01:56Z","raw_text":"I cannot reproduce this issue using  Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.4) Gecko/20100413 Firefox/3.6.4 or the equivalent Windows 3.6.4 version.\n\n(In reply to comment #16)\n> marcia will try to reproduce using the branch build tomorrow."},{"is_private":false,"attachment_id":null,"creator":"mozillamarcia.knous@gmail.com","time":"2010-06-22T20:34:04Z","author":"mozillamarcia.knous@gmail.com","bug_id":552002,"tags":[],"text":"http://tinyurl.com/3xmcm7z indicates there were several crashes with the 20100611 build, so apparently people are still hitting it in low volume.","id":4759598,"creation_time":"2010-06-22T20:34:04Z","raw_text":"http://tinyurl.com/3xmcm7z indicates there were several crashes with the 20100611 build, so apparently people are still hitting it in low volume."},{"is_private":false,"attachment_id":null,"creator":"jruderman@gmail.com","time":"2010-06-23T17:25:31Z","author":"jruderman@gmail.com","bug_id":552002,"tags":[],"text":"Did the fix for bug 449129 take care of this case?  Note that you'll still experience the plugin bug as a crash, but it will be a safe NS_RUNTIMEABORT in RPCChannel::SpinInternalEventLoop rather than a possibly exploitable crash in some random DOM code.","id":4761367,"creation_time":"2010-06-23T17:25:31Z","raw_text":"Did the fix for bug 449129 take care of this case?  Note that you'll still experience the plugin bug as a crash, but it will be a safe NS_RUNTIMEABORT in RPCChannel::SpinInternalEventLoop rather than a possibly exploitable crash in some random DOM code."},{"is_private":false,"attachment_id":null,"creator":"dsicore@mozilla.bugs","time":"2010-08-03T20:44:57Z","author":"dsicore@mozilla.bugs","bug_id":552002,"tags":[],"text":"Blocking final here until we have some sort of resolution.","id":4836609,"creation_time":"2010-08-03T20:44:57Z","raw_text":"Blocking final here until we have some sort of resolution."},{"is_private":false,"attachment_id":null,"creator":"mozillamarcia.knous@gmail.com","time":"2010-08-03T21:28:22Z","author":"mozillamarcia.knous@gmail.com","bug_id":552002,"tags":[],"text":"The site in the URL has changed quite a bit since the initial crash and I am not able to crash using either Windows or Mac latest trunk nightly.\n\nOf late, the 3.6.x branch is showing 23 Windows crashes - http://tinyurl.com/234c4ls, but the branch does not have the patch in Bug 449129 yet.","id":4836770,"creation_time":"2010-08-03T21:28:22Z","raw_text":"The site in the URL has changed quite a bit since the initial crash and I am not able to crash using either Windows or Mac latest trunk nightly.\n\nOf late, the 3.6.x branch is showing 23 Windows crashes - http://tinyurl.com/234c4ls, but the branch does not have the patch in Bug 449129 yet."},{"is_private":false,"attachment_id":null,"creator":"dsicore@mozilla.bugs","time":"2010-10-05T20:10:48Z","author":"dsicore@mozilla.bugs","bug_id":552002,"tags":[],"text":"Do we need to do what Roc says in Comment 21?","id":4987780,"creation_time":"2010-10-05T20:10:48Z","raw_text":"Do we need to do what Roc says in Comment 21?"},{"is_private":false,"attachment_id":null,"creator":"bent.mozilla@gmail.com","time":"2010-10-12T21:47:25Z","author":"bent.mozilla@gmail.com","bug_id":552002,"tags":[],"text":"This needs a new owner.","id":5005492,"creation_time":"2010-10-12T21:47:25Z","raw_text":"This needs a new owner."},{"is_private":false,"attachment_id":null,"creator":"dsicore@mozilla.bugs","time":"2010-10-19T20:11:46Z","author":"dsicore@mozilla.bugs","bug_id":552002,"tags":[],"text":"\nTalking about this more:\n\n1) This is to be fixed by async plugin painting,\n\n2) This is wontfix on branches.","id":5022339,"creation_time":"2010-10-19T20:11:46Z","raw_text":"\nTalking about this more:\n\n1) This is to be fixed by async plugin painting,\n\n2) This is wontfix on branches."},{"is_private":false,"attachment_id":null,"creator":"benjamin@smedbergs.us","time":"2011-06-01T14:31:25Z","author":"benjamin@smedbergs.us","bug_id":552002,"tags":[],"text":"There's nothing to track for Firefox 6 here, mac async painting is going to land for 7.","id":5505955,"creation_time":"2011-06-01T14:31:25Z","raw_text":"There's nothing to track for Firefox 6 here, mac async painting is going to land for 7."},{"is_private":false,"attachment_id":null,"creator":"jst@mozilla.org","time":"2011-07-28T20:48:47Z","author":"jst@mozilla.org","bug_id":552002,"tags":[],"text":"Bug 598425 landed in early June, so this is fixed in 7 and beyond!","id":5620367,"creation_time":"2011-07-28T20:48:47Z","raw_text":"Bug 598425 landed in early June, so this is fixed in 7 and beyond!"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2011-10-13T16:33:13Z","author":"anthony.s.hughes@gmail.com","bug_id":552002,"tags":[],"text":"As per testcase-wanted keyword, is there something QA can do to verify this fix (apart from checking Socorro)?","id":5780366,"creation_time":"2011-10-13T16:33:13Z","raw_text":"As per testcase-wanted keyword, is there something QA can do to verify this fix (apart from checking Socorro)?"}]}},"comments":{}}