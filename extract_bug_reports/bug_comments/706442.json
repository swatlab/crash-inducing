{"bugs":{"706442":{"comments":[{"is_private":false,"attachment_id":null,"creator":"cbook@mozilla.com","time":"2011-11-30T13:25:55Z","author":"cbook@mozilla.com","bug_id":706442,"tags":[],"text":"noticing on the top-changer list on crash-stats.\n\nExample Crash-Report -> https://crash-stats.mozilla.com/report/index/72527b8c-3a12-4e7f-8a27-087c22111129\n\ngeneral overview: https://crash-stats.mozilla.com/report/list?range_value=3&range_unit=days&signature=js%3A%3ALifoAlloc%3A%3AgetOrCreateChunk%28unsigned%20int%29&version=Firefox%3A10.0a2\n\nall windows 7/xp crashes\n\n\nCrashing Thread\nFrame \tModule \tSignature [Expand] \tSource\n0 \tmozjs.dll \tjs::LifoAlloc::getOrCreateChunk \tjs/src/ds/LifoAlloc.cpp:180\n1 \tmozjs.dll \tjs::analyze::ScriptAnalysis::addJump \tjs/src/jsanalyze.cpp:81\n2 \tmozjs.dll \tjs::analyze::ScriptAnalysis::analyzeBytecode \tjs/src/jsanalyze.cpp:593\n3 \tmozjs.dll \tJSScript::makeAnalysis \tjs/src/jsinfer.cpp:5507\n4 \tmozjs.dll \tJSScript::ensureRanAnalysis \tjs/src/jsinferinlines.h:1270\n5 \tmozjs.dll \tjs::types::TypeMonitorCall \tjs/src/jsinferinlines.h:327\n6 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3959\n7 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n8 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n9 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n10 \tmozjs.dll \tjs::types::TypeSet::addType \tjs/src/jsinferinlines.h:1028\n11 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n12 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n13 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n14 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n15 \tmozjs.dll \tjs::types::TypeSet::addType \tjs/src/jsinferinlines.h:1028\n16 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n17 \tmozjs.dll \tjs::CallObject::create \tjs/src/vm/CallObject.cpp:78\n18 \tmozjs.dll \tjs::CreateFunCallObject \tjs/src/jsfun.cpp:743\n19 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:647\n20 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n21 \tmozjs.dll \tjs::types::TypeSet::addType \tjs/src/jsinferinlines.h:1028\n22 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3541\n23 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n24 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n25 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n26 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:629\n27 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n28 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n29 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n30 \tmozjs.dll \tjs::Invoke \tjs/src/jsinterp.h:148\n31 \tmozjs.dll \tjs_fun_apply \tjs/src/jsfun.cpp:1817\n32 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:629\n33 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n34 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4963\n35 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n36 \tmozjs.dll \tjs::Invoke \tjs/src/jsinterp.h:148\n37 \tmozjs.dll \tjs_fun_apply \tjs/src/jsfun.cpp:1817\n38 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:629\n39 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n40 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4963\n41 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n42 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n43 \tmozjs.dll \tjs::ContextStack::currentScript \tjs/src/vm/Stack-inl.h:619\n44 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:4049\n45 \tmozjs.dll \tjs::ContextStack::pushInvokeFrame \tjs/src/vm/Stack.cpp:691\n46 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:647\n47 \tmozjs.dll \tJS_CallFunctionValue \tjs/src/jsapi.cpp:5199\n48 \txul.dll \tnsXPCWrappedJSClass::CallMethod \tjs/xpconnect/src/XPCWrappedJSClass.cpp:1530\n49 \t\t@0xffffff81 \t\n50 \tmozjs.dll \tJS_WrapObject \tjs/src/jsapi.cpp:1438\n51 \txul.dll \tXPCConvert::NativeInterface2JSObject \tjs/xpconnect/src/XPCConvert.cpp:1276\n52 \t\t@0x72c94ff \t\n53 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n54 \tmozjs.dll \tjs::ContextStack::pushInvokeFrame \tjs/src/vm/Stack.cpp:691\n55 \txul.dll \tnsHttpTransaction::LocateHttpStart \tnetwerk/protocol/http/nsHttpTransaction.cpp:734\n56 \txul.dll \tSelectorMatches \tlayout/style/nsCSSRuleProcessor.cpp:2146\n57 \txul.dll \tSelectorMatches \tlayout/style/nsCSSRuleProcessor.cpp:2146\n58 \txul.dll \tnsEventDispatcher::Dispatch \tcontent/events/src/nsEventDispatcher.cpp:677","id":5881834,"creation_time":"2011-11-30T13:25:55Z","raw_text":"noticing on the top-changer list on crash-stats.\n\nExample Crash-Report -> https://crash-stats.mozilla.com/report/index/72527b8c-3a12-4e7f-8a27-087c22111129\n\ngeneral overview: https://crash-stats.mozilla.com/report/list?range_value=3&range_unit=days&signature=js%3A%3ALifoAlloc%3A%3AgetOrCreateChunk%28unsigned%20int%29&version=Firefox%3A10.0a2\n\nall windows 7/xp crashes\n\n\nCrashing Thread\nFrame \tModule \tSignature [Expand] \tSource\n0 \tmozjs.dll \tjs::LifoAlloc::getOrCreateChunk \tjs/src/ds/LifoAlloc.cpp:180\n1 \tmozjs.dll \tjs::analyze::ScriptAnalysis::addJump \tjs/src/jsanalyze.cpp:81\n2 \tmozjs.dll \tjs::analyze::ScriptAnalysis::analyzeBytecode \tjs/src/jsanalyze.cpp:593\n3 \tmozjs.dll \tJSScript::makeAnalysis \tjs/src/jsinfer.cpp:5507\n4 \tmozjs.dll \tJSScript::ensureRanAnalysis \tjs/src/jsinferinlines.h:1270\n5 \tmozjs.dll \tjs::types::TypeMonitorCall \tjs/src/jsinferinlines.h:327\n6 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3959\n7 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n8 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n9 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n10 \tmozjs.dll \tjs::types::TypeSet::addType \tjs/src/jsinferinlines.h:1028\n11 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n12 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n13 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n14 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n15 \tmozjs.dll \tjs::types::TypeSet::addType \tjs/src/jsinferinlines.h:1028\n16 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n17 \tmozjs.dll \tjs::CallObject::create \tjs/src/vm/CallObject.cpp:78\n18 \tmozjs.dll \tjs::CreateFunCallObject \tjs/src/jsfun.cpp:743\n19 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:647\n20 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n21 \tmozjs.dll \tjs::types::TypeSet::addType \tjs/src/jsinferinlines.h:1028\n22 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3541\n23 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n24 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n25 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n26 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:629\n27 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n28 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n29 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n30 \tmozjs.dll \tjs::Invoke \tjs/src/jsinterp.h:148\n31 \tmozjs.dll \tjs_fun_apply \tjs/src/jsfun.cpp:1817\n32 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:629\n33 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n34 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4963\n35 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n36 \tmozjs.dll \tjs::Invoke \tjs/src/jsinterp.h:148\n37 \tmozjs.dll \tjs_fun_apply \tjs/src/jsfun.cpp:1817\n38 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:629\n39 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:3948\n40 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4963\n41 \tmozjs.dll \tjs::RunScript \tjs/src/jsinterp.cpp:584\n42 \tmozjs.dll \tjs_fun_call \tjs/src/jsfun.cpp:1761\n43 \tmozjs.dll \tjs::ContextStack::currentScript \tjs/src/vm/Stack-inl.h:619\n44 \tmozjs.dll \tjs::Interpret \tjs/src/jsinterp.cpp:4049\n45 \tmozjs.dll \tjs::ContextStack::pushInvokeFrame \tjs/src/vm/Stack.cpp:691\n46 \tmozjs.dll \tjs::InvokeKernel \tjs/src/jsinterp.cpp:647\n47 \tmozjs.dll \tJS_CallFunctionValue \tjs/src/jsapi.cpp:5199\n48 \txul.dll \tnsXPCWrappedJSClass::CallMethod \tjs/xpconnect/src/XPCWrappedJSClass.cpp:1530\n49 \t\t@0xffffff81 \t\n50 \tmozjs.dll \tJS_WrapObject \tjs/src/jsapi.cpp:1438\n51 \txul.dll \tXPCConvert::NativeInterface2JSObject \tjs/xpconnect/src/XPCConvert.cpp:1276\n52 \t\t@0x72c94ff \t\n53 \tmozjs.dll \tjs::types::TypeMonitorCallSlow \tjs/src/jsinfer.cpp:4972\n54 \tmozjs.dll \tjs::ContextStack::pushInvokeFrame \tjs/src/vm/Stack.cpp:691\n55 \txul.dll \tnsHttpTransaction::LocateHttpStart \tnetwerk/protocol/http/nsHttpTransaction.cpp:734\n56 \txul.dll \tSelectorMatches \tlayout/style/nsCSSRuleProcessor.cpp:2146\n57 \txul.dll \tSelectorMatches \tlayout/style/nsCSSRuleProcessor.cpp:2146\n58 \txul.dll \tnsEventDispatcher::Dispatch \tcontent/events/src/nsEventDispatcher.cpp:677"},{"is_private":false,"attachment_id":578039,"creator":"cdleary@acm.org","time":"2011-11-30T20:07:59Z","author":"cdleary@acm.org","bug_id":706442,"tags":[],"text":"Created attachment 578039\nClear the chunk's next field after releasing further chain chunks.\n\nThis bug is on aurora, but not beta.","id":5883139,"creation_time":"2011-11-30T20:07:59Z","raw_text":"This bug is on aurora, but not beta."},{"is_private":false,"attachment_id":null,"creator":"cdleary@acm.org","time":"2011-12-02T02:02:27Z","author":"cdleary@acm.org","bug_id":706442,"tags":[],"text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/818d5be34ab7","id":5887215,"creation_time":"2011-12-02T02:02:27Z","raw_text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/818d5be34ab7"},{"is_private":false,"attachment_id":null,"creator":"cdleary@acm.org","time":"2011-12-02T19:12:35Z","author":"cdleary@acm.org","bug_id":706442,"tags":[],"text":"https://hg.mozilla.org/mozilla-central/rev/818d5be34ab7","id":5888856,"creation_time":"2011-12-02T19:12:35Z","raw_text":"https://hg.mozilla.org/mozilla-central/rev/818d5be34ab7"},{"is_private":false,"attachment_id":null,"creator":"cdleary@acm.org","time":"2011-12-03T22:33:26Z","author":"cdleary@acm.org","bug_id":706442,"tags":[],"text":"Fixed on trunk, but still waiting for aurora approval decision.","id":5890970,"creation_time":"2011-12-03T22:33:26Z","raw_text":"Fixed on trunk, but still waiting for aurora approval decision."},{"is_private":false,"attachment_id":578039,"creator":"jpr@mozilla.com","time":"2011-12-13T22:52:07Z","author":"jpr@mozilla.com","bug_id":706442,"tags":[],"text":"Comment on attachment 578039\nClear the chunk's next field after releasing further chain chunks.\n\nThere was no risk assessment, but we believe this is a low risk fix.","id":5913751,"creation_time":"2011-12-13T22:52:07Z","raw_text":"There was no risk assessment, but we believe this is a low risk fix."},{"is_private":false,"attachment_id":null,"creator":"cdleary@acm.org","time":"2011-12-14T23:40:45Z","author":"cdleary@acm.org","bug_id":706442,"tags":[],"text":"https://hg.mozilla.org/releases/mozilla-aurora/rev/1b3ce7846516\n\nSorry about the risk assessment -- promise I'll remember to include it next time!","id":5917429,"creation_time":"2011-12-14T23:40:45Z","raw_text":"https://hg.mozilla.org/releases/mozilla-aurora/rev/1b3ce7846516\n\nSorry about the risk assessment -- promise I'll remember to include it next time!"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2011-12-28T21:33:30Z","author":"anthony.s.hughes@gmail.com","bug_id":706442,"tags":[],"text":"Is this something QA can verify?","id":5943579,"creation_time":"2011-12-28T21:33:30Z","raw_text":"Is this something QA can verify?"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-02-01T20:57:18Z","author":"anthony.s.hughes@gmail.com","bug_id":706442,"tags":[],"text":"(In reply to Anthony Hughes, Mozilla QA (irc: ashughes) from comment #7)\n> Is this something QA can verify?\n\nbump","id":6026752,"creation_time":"2012-02-01T20:57:18Z","raw_text":"(In reply to Anthony Hughes, Mozilla QA (irc: ashughes) from comment #7)\n> Is this something QA can verify?\n\nbump"},{"is_private":false,"attachment_id":null,"creator":"madperson@gmx.at","time":"2012-06-09T22:09:56Z","author":"madperson@gmx.at","bug_id":706442,"tags":[],"text":"this crash seems to be still around in current versions...","id":6378248,"creation_time":"2012-06-09T22:09:56Z","raw_text":"this crash seems to be still around in current versions..."},{"is_private":false,"attachment_id":null,"creator":"cbook@mozilla.com","time":"2012-06-11T12:30:31Z","author":"cbook@mozilla.com","bug_id":706442,"tags":[],"text":"seems its not fixed, since we still see crashes -> https://crash-stats.mozilla.com/report/list?range_value=7&range_unit=days&signature=js%3A%3ALifoAlloc%3A%3AgetOrCreateChunk%28unsigned%20int%29&version=Firefox%3A13.0","id":6379986,"creation_time":"2012-06-11T12:30:31Z","raw_text":"seems its not fixed, since we still see crashes -> https://crash-stats.mozilla.com/report/list?range_value=7&range_unit=days&signature=js%3A%3ALifoAlloc%3A%3AgetOrCreateChunk%28unsigned%20int%29&version=Firefox%3A13.0"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-06-11T20:41:17Z","author":"anthony.s.hughes@gmail.com","bug_id":706442,"tags":[],"text":"Seems to be most crashy with Firefox 12 on Windows XP. One of the comments mention CastleVille on Facebook. Firefox 14, 15, and 16 seem to be pretty low, though I'm not sure if that's because of ADUs or if this has been mitigated by a patch.","id":6381533,"creation_time":"2012-06-11T20:41:17Z","raw_text":"Seems to be most crashy with Firefox 12 on Windows XP. One of the comments mention CastleVille on Facebook. Firefox 14, 15, and 16 seem to be pretty low, though I'm not sure if that's because of ADUs or if this has been mitigated by a patch."},{"is_private":false,"attachment_id":null,"creator":"akeybl@mozilla.com","time":"2012-06-13T20:19:08Z","author":"akeybl@mozilla.com","bug_id":706442,"tags":[],"text":"Do we have a test case here that we can verify? Does Comment 10 imply that we still have an sg:crit issue in our code?","id":6389034,"creation_time":"2012-06-13T20:19:08Z","raw_text":"Do we have a test case here that we can verify? Does Comment 10 imply that we still have an sg:crit issue in our code?"},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2012-06-13T22:03:55Z","author":"anthony.s.hughes@gmail.com","bug_id":706442,"tags":[],"text":"If Firefox 11 was fixed when in mozilla-central (as comment 3 and the status flag indicate), this should (in theory) be fixed for Firefox 12 and onward by nature of the train model.\n\nIf Firefox 10 was fixed when in mozilla-aurora (as comment 6 and the status flag indicate), this should be fixed in the first Firefox 10.0 ESR.\n\nThough, since QA was never able to reproduce this bug, we were also never able to truly verify the fix. I'm happy to test if there is something we can try.","id":6389614,"creation_time":"2012-06-13T22:03:55Z","raw_text":"If Firefox 11 was fixed when in mozilla-central (as comment 3 and the status flag indicate), this should (in theory) be fixed for Firefox 12 and onward by nature of the train model.\n\nIf Firefox 10 was fixed when in mozilla-aurora (as comment 6 and the status flag indicate), this should be fixed in the first Firefox 10.0 ESR.\n\nThough, since QA was never able to reproduce this bug, we were also never able to truly verify the fix. I'm happy to test if there is something we can try."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-06-14T06:09:38Z","author":"scoobidiver@netcourrier.com","bug_id":706442,"tags":[],"text":"It's #169 top browser crasher in 10.0.2, #136 in 11.0 over the last 4 weeks, #116 in 12.0, #110 in 13.0, #99 in 14.0b6, #91 in 15.0a2, and #200 in 16.0a1 over the last week.\n10.0.2, 10.0.3, 10.0.4 and 10.0.5 ESR are affected.\n\nBased on 140 comments over the last 4 weeks, some people were playing a game on Facebook, were using Facebook, were playing videos, were signing into their email account, or were opening an email.\n\nHere are interesting comments:\n\"Virtual memory warning box appeared just before crash.\"\n\"Everytime we tries to log off any program this happens.\"\n\"since it was updated it crashes all the time\" (Fx 13)\n\"suddenly at facebook - play castle ville canceled and the desktop was visible. reloaded Firefox, facebook, then again the game loaded, was originally built and then grey screen with an AIDS in a circle. \"reload page\" pressed, again of the game and then again demolition and desktop and this page beginning of visible. https://apps.facebook.com/playcastleville/?fb_source=bookmark_apps&ref=bookmarks&count=0&1_0.1.1=fb_bmpos\" (translated from German by Bing Translator)","id":6390537,"creation_time":"2012-06-14T06:09:38Z","raw_text":"It's #169 top browser crasher in 10.0.2, #136 in 11.0 over the last 4 weeks, #116 in 12.0, #110 in 13.0, #99 in 14.0b6, #91 in 15.0a2, and #200 in 16.0a1 over the last week.\n10.0.2, 10.0.3, 10.0.4 and 10.0.5 ESR are affected.\n\nBased on 140 comments over the last 4 weeks, some people were playing a game on Facebook, were using Facebook, were playing videos, were signing into their email account, or were opening an email.\n\nHere are interesting comments:\n\"Virtual memory warning box appeared just before crash.\"\n\"Everytime we tries to log off any program this happens.\"\n\"since it was updated it crashes all the time\" (Fx 13)\n\"suddenly at facebook - play castle ville canceled and the desktop was visible. reloaded Firefox, facebook, then again the game loaded, was originally built and then grey screen with an AIDS in a circle. \"reload page\" pressed, again of the game and then again demolition and desktop and this page beginning of visible. https://apps.facebook.com/playcastleville/?fb_source=bookmark_apps&ref=bookmarks&count=0&1_0.1.1=fb_bmpos\" (translated from German by Bing Translator)"},{"is_private":false,"attachment_id":null,"creator":"abillings@mozilla.com","time":"2012-06-14T12:26:14Z","author":"abillings@mozilla.com","bug_id":706442,"tags":[],"text":"The crashstats don't make this sound very fixed.","id":6391159,"creation_time":"2012-06-14T12:26:14Z","raw_text":"The crashstats don't make this sound very fixed."},{"is_private":false,"attachment_id":null,"creator":"dmandelin@mozilla.com","time":"2012-06-26T00:17:00Z","author":"dmandelin@mozilla.com","bug_id":706442,"tags":[],"text":"This appears to be some sort of OOM bug, but it's hard to tell. It's crashing on this line of code:\n\n    BumpChunk *newChunk = BumpChunk::new_(chunkSize);\n\nwhich calls js_malloc and then initializes the returned memory. The crash addresses are also always page starts, which makes me think somehow the allocator is returning an unmapped page. I thought Windows wasn't supposed to do that, though. It could be a bug in jemalloc.\n\nI did notice that type inference was what was calling into the LIFO allocator on the crash reports that I clicked, so it's possible sometimes type inference is allocating more than it should.","id":6421968,"creation_time":"2012-06-26T00:17:00Z","raw_text":"This appears to be some sort of OOM bug, but it's hard to tell. It's crashing on this line of code:\n\n    BumpChunk *newChunk = BumpChunk::new_(chunkSize);\n\nwhich calls js_malloc and then initializes the returned memory. The crash addresses are also always page starts, which makes me think somehow the allocator is returning an unmapped page. I thought Windows wasn't supposed to do that, though. It could be a bug in jemalloc.\n\nI did notice that type inference was what was calling into the LIFO allocator on the crash reports that I clicked, so it's possible sometimes type inference is allocating more than it should."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-06-30T06:34:05Z","author":"scoobidiver@netcourrier.com","bug_id":706442,"tags":[],"text":"A user using Sync with a corrupt profile has a Firefox that crashes sometimes with this signature: see bug 769556.","id":6435633,"creation_time":"2012-06-30T06:34:05Z","raw_text":"A user using Sync with a corrupt profile has a Firefox that crashes sometimes with this signature: see bug 769556."},{"is_private":false,"attachment_id":null,"creator":"continuation@gmail.com","time":"2012-06-30T06:55:34Z","author":"continuation@gmail.com","bug_id":706442,"tags":[],"text":"(In reply to David Mandelin from comment #16)\n> This appears to be some sort of OOM bug, but it's hard to tell.\n\nWindows crash reports now have information about memory usage.  For instance, 4 random reports with this signature that I selected have system memory usage percentage at 96%, 39%, 98% and 98%.","id":6435642,"creation_time":"2012-06-30T06:55:34Z","raw_text":"(In reply to David Mandelin from comment #16)\n> This appears to be some sort of OOM bug, but it's hard to tell.\n\nWindows crash reports now have information about memory usage.  For instance, 4 random reports with this signature that I selected have system memory usage percentage at 96%, 39%, 98% and 98%."},{"is_private":false,"attachment_id":null,"creator":"dmandelin@mozilla.com","time":"2012-07-09T22:49:53Z","author":"dmandelin@mozilla.com","bug_id":706442,"tags":[],"text":"(In reply to Andrew McCreight [:mccr8] from comment #18)\n> (In reply to David Mandelin from comment #16)\n> > This appears to be some sort of OOM bug, but it's hard to tell.\n> \n> Windows crash reports now have information about memory usage.  For\n> instance, 4 random reports with this signature that I selected have system\n> memory usage percentage at 96%, 39%, 98% and 98%.\n\nOK, so reasonably likely :-) to be mostly OOM-related, possibly from runaway alloc in TI but I don't think that's likely. \n\nWhat can we do now? Who knows the real story about what happens on Windows if you call jemalloc and the system is very low on memory?","id":6456875,"creation_time":"2012-07-09T22:49:53Z","raw_text":"(In reply to Andrew McCreight [:mccr8] from comment #18)\n> (In reply to David Mandelin from comment #16)\n> > This appears to be some sort of OOM bug, but it's hard to tell.\n> \n> Windows crash reports now have information about memory usage.  For\n> instance, 4 random reports with this signature that I selected have system\n> memory usage percentage at 96%, 39%, 98% and 98%.\n\nOK, so reasonably likely :-) to be mostly OOM-related, possibly from runaway alloc in TI but I don't think that's likely. \n\nWhat can we do now? Who knows the real story about what happens on Windows if you call jemalloc and the system is very low on memory?"},{"is_private":false,"attachment_id":null,"creator":"continuation@gmail.com","time":"2012-07-10T02:04:33Z","author":"continuation@gmail.com","bug_id":706442,"tags":[],"text":"(In reply to David Mandelin from comment #19)\n> What can we do now? Who knows the real story about what happens on Windows\n> if you call jemalloc and the system is very low on memory?\njlebar may know.","id":6457403,"creation_time":"2012-07-10T02:04:33Z","raw_text":"(In reply to David Mandelin from comment #19)\n> What can we do now? Who knows the real story about what happens on Windows\n> if you call jemalloc and the system is very low on memory?\njlebar may know."},{"is_private":false,"attachment_id":null,"creator":"justin.lebar+bug@gmail.com","time":"2012-07-10T03:13:41Z","author":"justin.lebar+bug@gmail.com","bug_id":706442,"tags":[],"text":"> Who knows the real story about what happens on Windows if you call jemalloc and the system is very \n> low on memory?\n\nThe common thread I see in all the crash reports I looked at is low \"available page file\".  That number is ullAvailPageFile from MEMORYSTATUSEX, \"The maximum amount of memory the current process can commit, in bytes.\" [1]\n\nIt's pretty weird in some cases [2, 3, 4] that we have less than 5MB of available page file and 100+ MB of \"available physical memory\" (that's ullAvailPhys: \"amount of physical memory currently available, in bytes. This is the amount of physical memory that can be immediately reused without having to write its contents to disk first.\").\n\nLooking at some random, unrelated crash reports, there's always much more available page file than available physical memory, so I think this is an anomalous situation.\n\nI'm not sure, but I think this may mean that the system has run out of space in its pagefile -- that is, the pagefile is too small, and Windows can't grow it, perhaps because the system is out of disk space.  Windows doesn't overcommit -- I understand that this means that if a process allocates a bunch of MEM_COMMIT virtual memory but doesn't touch it, that space is reserved and must fit either in core or the page file.  So if something (perhaps Firefox) on the user's machine is eating up a lot of MEM_COMMIT vmem, it's possible we could get into this state where there's a lot of physical memory available (because the pages haven't /actually/ been committed yet), but no pagefile available.\n\nExactly what this means for jemalloc, I'm not sure yet.  But if anyone cares to correct me on the above (glandium?) that might help.  :)\n\n[1] http://msdn.microsoft.com/en-us/library/windows/desktop/aa366770%28v=vs.85%29.aspx\n[2] https://crash-stats.mozilla.com/report/index/d41a602f-015b-4dbb-9263-f687e2120709\n[3] https://crash-stats.mozilla.com/report/index/90fcf4e0-db21-4d0b-abf1-8c6cb2120709\n[4] https://crash-stats.mozilla.com/report/index/82cce1b7-2ede-42dc-b2f5-6c1312120709","id":6457501,"creation_time":"2012-07-10T03:13:41Z","raw_text":"> Who knows the real story about what happens on Windows if you call jemalloc and the system is very \n> low on memory?\n\nThe common thread I see in all the crash reports I looked at is low \"available page file\".  That number is ullAvailPageFile from MEMORYSTATUSEX, \"The maximum amount of memory the current process can commit, in bytes.\" [1]\n\nIt's pretty weird in some cases [2, 3, 4] that we have less than 5MB of available page file and 100+ MB of \"available physical memory\" (that's ullAvailPhys: \"amount of physical memory currently available, in bytes. This is the amount of physical memory that can be immediately reused without having to write its contents to disk first.\").\n\nLooking at some random, unrelated crash reports, there's always much more available page file than available physical memory, so I think this is an anomalous situation.\n\nI'm not sure, but I think this may mean that the system has run out of space in its pagefile -- that is, the pagefile is too small, and Windows can't grow it, perhaps because the system is out of disk space.  Windows doesn't overcommit -- I understand that this means that if a process allocates a bunch of MEM_COMMIT virtual memory but doesn't touch it, that space is reserved and must fit either in core or the page file.  So if something (perhaps Firefox) on the user's machine is eating up a lot of MEM_COMMIT vmem, it's possible we could get into this state where there's a lot of physical memory available (because the pages haven't /actually/ been committed yet), but no pagefile available.\n\nExactly what this means for jemalloc, I'm not sure yet.  But if anyone cares to correct me on the above (glandium?) that might help.  :)\n\n[1] http://msdn.microsoft.com/en-us/library/windows/desktop/aa366770%28v=vs.85%29.aspx\n[2] https://crash-stats.mozilla.com/report/index/d41a602f-015b-4dbb-9263-f687e2120709\n[3] https://crash-stats.mozilla.com/report/index/90fcf4e0-db21-4d0b-abf1-8c6cb2120709\n[4] https://crash-stats.mozilla.com/report/index/82cce1b7-2ede-42dc-b2f5-6c1312120709"},{"is_private":false,"attachment_id":null,"creator":"justin.lebar+bug@gmail.com","time":"2012-07-10T03:18:42Z","author":"justin.lebar+bug@gmail.com","bug_id":706442,"tags":[],"text":"We never check the return value in jemalloc's pages_commit (VirtualAlloc(MEM_COMMIT)).  I wouldn't be surprised if that's what's failing here.","id":6457506,"creation_time":"2012-07-10T03:18:42Z","raw_text":"We never check the return value in jemalloc's pages_commit (VirtualAlloc(MEM_COMMIT)).  I wouldn't be surprised if that's what's failing here."},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-07-10T07:20:42Z","author":"scoobidiver@netcourrier.com","bug_id":706442,"tags":[],"text":"In addition to comment 17, that user hit this crash with a new profile, suspicious software uninstalled and a disk check done. Certain other applications (Chrome, Safari, TB) also crashes.","id":6457746,"creation_time":"2012-07-10T07:20:42Z","raw_text":"In addition to comment 17, that user hit this crash with a new profile, suspicious software uninstalled and a disk check done. Certain other applications (Chrome, Safari, TB) also crashes."},{"is_private":false,"attachment_id":null,"creator":"continuation@gmail.com","time":"2012-07-10T11:52:47Z","author":"continuation@gmail.com","bug_id":706442,"tags":[],"text":"I'm not sure this really needs to be a security bug.  It seems like we have a new crash that just happens to have the same signature as an existing fixed sg:crit.  But maybe it is too early to tell...","id":6458167,"creation_time":"2012-07-10T11:52:47Z","raw_text":"I'm not sure this really needs to be a security bug.  It seems like we have a new crash that just happens to have the same signature as an existing fixed sg:crit.  But maybe it is too early to tell..."},{"is_private":false,"attachment_id":null,"creator":"justin.lebar+bug@gmail.com","time":"2012-07-10T13:22:24Z","author":"justin.lebar+bug@gmail.com","bug_id":706442,"tags":[],"text":"> It seems like we have a new crash that just happens to have the same signature as an existing fixed \n> sg:crit.\n\nIndeed, that's what appears to be happening.\n\nWe should be able to tell when I land the abort in bug 772338.","id":6458280,"creation_time":"2012-07-10T13:22:24Z","raw_text":"> It seems like we have a new crash that just happens to have the same signature as an existing fixed \n> sg:crit.\n\nIndeed, that's what appears to be happening.\n\nWe should be able to tell when I land the abort in bug 772338."},{"is_private":false,"attachment_id":null,"creator":"dmandelin@mozilla.com","time":"2012-07-12T01:34:30Z","author":"dmandelin@mozilla.com","bug_id":706442,"tags":[],"text":"Great analysis. Thanks, Justin. By the way, how do you read the MEMORYSTATUSEX out of a crashdump? Do you just call GlobalMemoryStatusEx in the debugger? I had no idea such things were possible...","id":6464964,"creation_time":"2012-07-12T01:34:30Z","raw_text":"Great analysis. Thanks, Justin. By the way, how do you read the MEMORYSTATUSEX out of a crashdump? Do you just call GlobalMemoryStatusEx in the debugger? I had no idea such things were possible..."},{"is_private":false,"attachment_id":null,"creator":"justin.lebar+bug@gmail.com","time":"2012-07-12T01:39:43Z","author":"justin.lebar+bug@gmail.com","bug_id":706442,"tags":[],"text":"> By the way, how do you read the MEMORYSTATUSEX out of a crashdump? Do you just call \n> GlobalMemoryStatusEx in the debugger? I had no idea such things were possible...\n\nNo, it's not so magical.  :)  We just make the syscall while we're building the crash report; the data we collect shows up on the crash-stats page.","id":6464970,"creation_time":"2012-07-12T01:39:43Z","raw_text":"> By the way, how do you read the MEMORYSTATUSEX out of a crashdump? Do you just call \n> GlobalMemoryStatusEx in the debugger? I had no idea such things were possible...\n\nNo, it's not so magical.  :)  We just make the syscall while we're building the crash report; the data we collect shows up on the crash-stats page."},{"is_private":false,"attachment_id":null,"creator":"dmandelin@mozilla.com","time":"2012-07-17T21:29:36Z","author":"dmandelin@mozilla.com","bug_id":706442,"tags":[],"text":"(In reply to Justin Lebar [:jlebar] from comment #27)\n> > By the way, how do you read the MEMORYSTATUSEX out of a crashdump? Do you just call \n> > GlobalMemoryStatusEx in the debugger? I had no idea such things were possible...\n> \n> No, it's not so magical.  :)  We just make the syscall while we're building\n> the crash report; the data we collect shows up on the crash-stats page.\n\nOh. :-) Well, I never saw those fields before, so I still learned something!","id":6481472,"creation_time":"2012-07-17T21:29:36Z","raw_text":"(In reply to Justin Lebar [:jlebar] from comment #27)\n> > By the way, how do you read the MEMORYSTATUSEX out of a crashdump? Do you just call \n> > GlobalMemoryStatusEx in the debugger? I had no idea such things were possible...\n> \n> No, it's not so magical.  :)  We just make the syscall while we're building\n> the crash report; the data we collect shows up on the crash-stats page.\n\nOh. :-) Well, I never saw those fields before, so I still learned something!"},{"is_private":false,"attachment_id":null,"creator":"dmandelin@mozilla.com","time":"2012-07-17T21:31:56Z","author":"dmandelin@mozilla.com","bug_id":706442,"tags":[],"text":"This particular flavor of the crash seems unlikely to be sec-critical, so removing the whiteboard tag to prevent confusion.","id":6481484,"creation_time":"2012-07-17T21:31:56Z","raw_text":"This particular flavor of the crash seems unlikely to be sec-critical, so removing the whiteboard tag to prevent confusion."},{"is_private":false,"attachment_id":null,"creator":"continuation@gmail.com","time":"2012-08-29T19:07:00Z","author":"continuation@gmail.com","bug_id":706442,"tags":[],"text":"This really needs a new bug filed for it if we want to track the new regression, as it is unrelated to the original issue.","id":6594189,"creation_time":"2012-08-29T19:07:00Z","raw_text":"This really needs a new bug filed for it if we want to track the new regression, as it is unrelated to the original issue."},{"is_private":false,"attachment_id":null,"creator":"lukasblakk+bugs@gmail.com","time":"2012-09-06T23:51:58Z","author":"lukasblakk+bugs@gmail.com","bug_id":706442,"tags":[],"text":"Triage comment:\nSince this appears to have been classified as non-exploitable we're wontfixing for ESR10 and will get it in ESR17.","id":6616496,"creation_time":"2012-09-06T23:51:58Z","raw_text":"Triage comment:\nSince this appears to have been classified as non-exploitable we're wontfixing for ESR10 and will get it in ESR17."}]}},"comments":{}}