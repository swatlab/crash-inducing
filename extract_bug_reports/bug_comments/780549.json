{"bugs":{"780549":{"comments":[{"is_private":false,"attachment_id":649172,"creator":"vseerror@lehigh.edu","time":"2012-08-06T04:05:19Z","author":"vseerror@lehigh.edu","bug_id":780549,"tags":[],"text":"Created attachment 649172\nwindbg stacktrace\n\n+++ This bug was initially created as a clone of Bug #743221 +++\n\nperhaps related to bug 743221 - unclear as yet. captured by windbg. Having trouble recalling steps at the moment.\n\n\n(74e0.d44): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\neax=2238525c ebx=2866c000 ecx=22385000 edx=0749df00 esi=7eb00000 edi=002c8370\neip=678d1eaa esp=002c8358 ebp=002c8378 iopl=0         nv up ei pl nz na pe nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206\n*** WARNING: Unable to verify checksum for C:\\Program Files\\Mozilla.org\\FF 17.0a1 2012-08-02\\mozjs.dll\nmozjs!js::types::AutoEnterCompilation::~AutoEnterCompilation+0x1a:\n678d1eaa 8b0e            mov     ecx,dword ptr [esi]  ds:0023:7eb00000=????????\n0:000> ~* kp;!analyze -f;lm\n\n.  0  Id: 74e0.d44 Suspend: 1 Teb: 7ffdf000 Unfrozen\nChildEBP RetAddr  \n002c835c 678ebf04 mozjs!js::types::AutoEnterCompilation::~AutoEnterCompilation(void)+0x1a [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsinferinlines.h @ 286]\n002c8378 678ec0fa mozjs!js::mjit::Compiler::performCompilation(void)+0x94 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\methodjit\\compiler.cpp @ 510]\n002c8388 678ec45f mozjs!js::mjit::Compiler::compile(void)+0xa [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\methodjit\\compiler.cpp @ 112]\n002cc4a0 67848f99 mozjs!js::mjit::CanMethodJIT(struct JSContext * cx = 0x146a3de0, struct JSScript * script = 0x2866c028, unsigned char * pc = 0x17d25c44 \">W\", bool construct = false, js::mjit::CompileRequest request = CompileRequest_Interpreter (0n0), class js::StackFrame * frame = 0x04de01b0)+0x2af [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\methodjit\\compiler.cpp @ 998]\n002ccd9c 67851d70 mozjs!js::Interpret(struct JSContext * cx = 0x146a3de0, class js::StackFrame * entryFrame = 0x04de0068, js::InterpMode interpMode = JSINTERP_NORMAL (0n0))+0xf49 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsinterp.cpp @ 2446]\n002cce10 678523fa mozjs!js::InvokeKernel(struct JSContext * cx = 0x146a3de0, class JS::CallArgs args = class JS::CallArgs, js::MaybeConstruct construct = NO_CONSTRUCT (0n0))+0x610 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsinterp.cpp @ 356]\n002cce58 67872ea1 mozjs!js::Invoke(struct JSContext * cx = 0x146a3de0, class JS::Value * thisv = 0x002cce80, class JS::Value * fval = 0x002cce9c, unsigned int argc = 0, class JS::Value * argv = 0x00000000, class JS::Value * rval = 0x002ccee0)+0x1ba [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsinterp.cpp @ 388]\n*** WARNING: Unable to verify checksum for C:\\Program Files\\Mozilla.org\\FF 17.0a1 2012-08-02\\xul.dll\n002cce8c 59a6035a mozjs!JS_CallFunctionValue(struct JSContext * cx = 0x146a3de0, struct JSObject * objArg = 0x1fb55040, class JS::Value fval = class JS::Value, unsigned int argc = 0, class JS::Value * argv = 0x00000000, class JS::Value * rval = 0x002ccee0)+0x41 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsapi.cpp @ 5836]\n002cd030 59a31f3b xul!nsJSContext::CallEventHandler(class nsISupports * aTarget = 0x1c08cc40, struct JSObject * aScope = 0x1fb55040, struct JSObject * aHandler = 0x286a6960, class nsIArray * aargv = 0x1859b9e0, class nsIVariant ** arv = 0x002cd080)+0x47a [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\dom\\base\\nsjsenvironment.cpp @ 1929]\n002cd08c 59a3a428 xul!nsGlobalWindow::RunTimeoutHandler(struct nsTimeout * aTimeout = 0x2238525c, class nsIScriptContext * aScx = 0x1747c8d0)+0xeb [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\dom\\base\\nsglobalwindow.cpp @ 9555]\n002cd118 59b7bacc xul!nsGlobalWindow::RunTimeout(struct nsTimeout * aTimeout = 0x185d1ce0)+0x1e8 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\dom\\base\\nsglobalwindow.cpp @ 9806]\n002cd130 59a73a54 xul!nsGlobalWindow::TimerCallback(class nsITimer * aTimer = 0x185d26d0, void * aClosure = 0x185d1ce0)+0x1b [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\dom\\base\\nsglobalwindow.cpp @ 10072]\n002cd160 59aa6960 xul!nsTimerImpl::Fire(void)+0xf4 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\xpcom\\threads\\nstimerimpl.cpp @ 473]\n002cd1d0 59a6e6d9 xul!nsThread::ProcessNextEvent(bool mayWait = false, bool * resu","id":6533316,"creation_time":"2012-08-06T04:05:19Z","raw_text":"+++ This bug was initially created as a clone of Bug #743221 +++\n\nperhaps related to bug 743221 - unclear as yet. captured by windbg. Having trouble recalling steps at the moment.\n\n\n(74e0.d44): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\neax=2238525c ebx=2866c000 ecx=22385000 edx=0749df00 esi=7eb00000 edi=002c8370\neip=678d1eaa esp=002c8358 ebp=002c8378 iopl=0         nv up ei pl nz na pe nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206\n*** WARNING: Unable to verify checksum for C:\\Program Files\\Mozilla.org\\FF 17.0a1 2012-08-02\\mozjs.dll\nmozjs!js::types::AutoEnterCompilation::~AutoEnterCompilation+0x1a:\n678d1eaa 8b0e            mov     ecx,dword ptr [esi]  ds:0023:7eb00000=????????\n0:000> ~* kp;!analyze -f;lm\n\n.  0  Id: 74e0.d44 Suspend: 1 Teb: 7ffdf000 Unfrozen\nChildEBP RetAddr  \n002c835c 678ebf04 mozjs!js::types::AutoEnterCompilation::~AutoEnterCompilation(void)+0x1a [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsinferinlines.h @ 286]\n002c8378 678ec0fa mozjs!js::mjit::Compiler::performCompilation(void)+0x94 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\methodjit\\compiler.cpp @ 510]\n002c8388 678ec45f mozjs!js::mjit::Compiler::compile(void)+0xa [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\methodjit\\compiler.cpp @ 112]\n002cc4a0 67848f99 mozjs!js::mjit::CanMethodJIT(struct JSContext * cx = 0x146a3de0, struct JSScript * script = 0x2866c028, unsigned char * pc = 0x17d25c44 \">W\", bool construct = false, js::mjit::CompileRequest request = CompileRequest_Interpreter (0n0), class js::StackFrame * frame = 0x04de01b0)+0x2af [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\methodjit\\compiler.cpp @ 998]\n002ccd9c 67851d70 mozjs!js::Interpret(struct JSContext * cx = 0x146a3de0, class js::StackFrame * entryFrame = 0x04de0068, js::InterpMode interpMode = JSINTERP_NORMAL (0n0))+0xf49 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsinterp.cpp @ 2446]\n002cce10 678523fa mozjs!js::InvokeKernel(struct JSContext * cx = 0x146a3de0, class JS::CallArgs args = class JS::CallArgs, js::MaybeConstruct construct = NO_CONSTRUCT (0n0))+0x610 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsinterp.cpp @ 356]\n002cce58 67872ea1 mozjs!js::Invoke(struct JSContext * cx = 0x146a3de0, class JS::Value * thisv = 0x002cce80, class JS::Value * fval = 0x002cce9c, unsigned int argc = 0, class JS::Value * argv = 0x00000000, class JS::Value * rval = 0x002ccee0)+0x1ba [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsinterp.cpp @ 388]\n*** WARNING: Unable to verify checksum for C:\\Program Files\\Mozilla.org\\FF 17.0a1 2012-08-02\\xul.dll\n002cce8c 59a6035a mozjs!JS_CallFunctionValue(struct JSContext * cx = 0x146a3de0, struct JSObject * objArg = 0x1fb55040, class JS::Value fval = class JS::Value, unsigned int argc = 0, class JS::Value * argv = 0x00000000, class JS::Value * rval = 0x002ccee0)+0x41 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\js\\src\\jsapi.cpp @ 5836]\n002cd030 59a31f3b xul!nsJSContext::CallEventHandler(class nsISupports * aTarget = 0x1c08cc40, struct JSObject * aScope = 0x1fb55040, struct JSObject * aHandler = 0x286a6960, class nsIArray * aargv = 0x1859b9e0, class nsIVariant ** arv = 0x002cd080)+0x47a [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\dom\\base\\nsjsenvironment.cpp @ 1929]\n002cd08c 59a3a428 xul!nsGlobalWindow::RunTimeoutHandler(struct nsTimeout * aTimeout = 0x2238525c, class nsIScriptContext * aScx = 0x1747c8d0)+0xeb [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\dom\\base\\nsglobalwindow.cpp @ 9555]\n002cd118 59b7bacc xul!nsGlobalWindow::RunTimeout(struct nsTimeout * aTimeout = 0x185d1ce0)+0x1e8 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\dom\\base\\nsglobalwindow.cpp @ 9806]\n002cd130 59a73a54 xul!nsGlobalWindow::TimerCallback(class nsITimer * aTimer = 0x185d26d0, void * aClosure = 0x185d1ce0)+0x1b [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\dom\\base\\nsglobalwindow.cpp @ 10072]\n002cd160 59aa6960 xul!nsTimerImpl::Fire(void)+0xf4 [e:\\builds\\moz2_slave\\m-cen-w32-ntly\\build\\xpcom\\threads\\nstimerimpl.cpp @ 473]\n002cd1d0 59a6e6d9 xul!nsThread::ProcessNextEvent(bool mayWait = false, bool * resu"},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-08-06T06:49:08Z","author":"scoobidiver@netcourrier.com","bug_id":780549,"tags":[],"text":"It first appeared in 17.0a1/20120719, but it has been discontinuous across builds.\n\nMore reports at:\nhttps://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29","id":6533418,"creation_time":"2012-08-06T06:49:08Z","raw_text":"It first appeared in 17.0a1/20120719, but it has been discontinuous across builds.\n\nMore reports at:\nhttps://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29"},{"is_private":false,"attachment_id":null,"creator":"vseerror@lehigh.edu","time":"2012-08-06T13:30:33Z","author":"vseerror@lehigh.edu","bug_id":780549,"tags":[],"text":"(to clarify)\nI left [@ EMPTY: no crashing thread identified; corrupt dump ] in crash sigs because if I were not running windbg, it eventually crashes with [@ EMPTY: no crashing thread identified; corrupt dump ]. Or at least, that's what all my crash reports have been - which are numerous (5-10 per month). The most recent:\n\nbp-1bbf76a2-877c-40b0-82d7-26aba2120805 8/5/20129:07 AM\nbp-c0319d4c-0ea2-4d84-a3ab-857082120805 8/5/20121:46 AM\nbp-e09a0a9d-0d05-4bca-a1c2-e89ba2120805 8/4/201211:31 PM\nbp-6778689c-3ef2-407e-b48a-8dd652120803 8/2/201211:36 PM\nbp-4e2f767d-528b-4031-9ee3-e8bd62120803 8/2/20129:22 PM\nbp-caad95ad-7013-4817-a9c6-e11f421208017/31/201210:22 PM","id":6533845,"creation_time":"2012-08-06T13:30:33Z","raw_text":"(to clarify)\nI left [@ EMPTY: no crashing thread identified; corrupt dump ] in crash sigs because if I were not running windbg, it eventually crashes with [@ EMPTY: no crashing thread identified; corrupt dump ]. Or at least, that's what all my crash reports have been - which are numerous (5-10 per month). The most recent:\n\nbp-1bbf76a2-877c-40b0-82d7-26aba2120805 8/5/20129:07 AM\nbp-c0319d4c-0ea2-4d84-a3ab-857082120805 8/5/20121:46 AM\nbp-e09a0a9d-0d05-4bca-a1c2-e89ba2120805 8/4/201211:31 PM\nbp-6778689c-3ef2-407e-b48a-8dd652120803 8/2/201211:36 PM\nbp-4e2f767d-528b-4031-9ee3-e8bd62120803 8/2/20129:22 PM\nbp-caad95ad-7013-4817-a9c6-e11f421208017/31/201210:22 PM"},{"is_private":false,"attachment_id":null,"creator":"vseerror@lehigh.edu","time":"2012-08-11T12:31:53Z","author":"vseerror@lehigh.edu","bug_id":780549,"tags":[],"text":"nbp, I'm OK to close if you think this should be gone with that bug fixed.","id":6548512,"creation_time":"2012-08-11T12:31:53Z","raw_text":"nbp, I'm OK to close if you think this should be gone with that bug fixed."},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-08-15T18:00:22Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"(In reply to Wayne Mery (:wsmwk) from comment #4)\n> nbp, I'm OK to close if you think this should be gone with that bug fixed.\n\nThis bug should be definitively fixed with Bug 777537 patch.\n\nCC me if any identical failures including AutoEnterCompilation::~AutoEnterCompilation and/or CompilerOutput::isValid appear in a backtrace.","id":6557347,"creation_time":"2012-08-15T18:00:22Z","raw_text":"(In reply to Wayne Mery (:wsmwk) from comment #4)\n> nbp, I'm OK to close if you think this should be gone with that bug fixed.\n\nThis bug should be definitively fixed with Bug 777537 patch.\n\nCC me if any identical failures including AutoEnterCompilation::~AutoEnterCompilation and/or CompilerOutput::isValid appear in a backtrace."},{"is_private":false,"attachment_id":null,"creator":"vseerror@lehigh.edu","time":"2012-11-17T19:48:51Z","author":"vseerror@lehigh.edu","bug_id":780549,"tags":[],"text":"Scoobidiver, if bug 777537 was fixed in FF17 (has TM=17) then why is this not also TM=17?","id":6831634,"creation_time":"2012-11-17T19:48:51Z","raw_text":"Scoobidiver, if bug 777537 was fixed in FF17 (has TM=17) then why is this not also TM=17?"},{"is_private":false,"attachment_id":null,"creator":"scoobidiver@netcourrier.com","time":"2012-11-17T19:54:35Z","author":"scoobidiver@netcourrier.com","bug_id":780549,"tags":[],"text":"(In reply to Wayne Mery (:wsmwk) from comment #6)\n> Scoobidiver, if bug 777537 was fixed in FF17 (has TM=17) then why is this\n> not also TM=17?\nI don't have access to bug 780274 to see if the patch landed in 17.0 or 18.0 but I can assure you there are still crashes in 17.0 Beta. See the link in comment 1.","id":6831640,"creation_time":"2012-11-17T19:54:35Z","raw_text":"(In reply to Wayne Mery (:wsmwk) from comment #6)\n> Scoobidiver, if bug 777537 was fixed in FF17 (has TM=17) then why is this\n> not also TM=17?\nI don't have access to bug 780274 to see if the patch landed in 17.0 or 18.0 but I can assure you there are still crashes in 17.0 Beta. See the link in comment 1."},{"is_private":false,"attachment_id":null,"creator":"vseerror@lehigh.edu","time":"2012-12-26T15:36:54Z","author":"vseerror@lehigh.edu","bug_id":780549,"tags":[],"text":"(In reply to Scoobidiver from comment #7)\n> (In reply to Wayne Mery (:wsmwk) from comment #6)\n> > Scoobidiver, if bug 777537 was fixed in FF17 (has TM=17) then why is this\n> > not also TM=17?\n> I don't have access to bug 780274 to see if the patch landed in 17.0 or 18.0\n> but I can assure you there are still crashes in 17.0 Beta. See the link in\n> comment 1.\n\n#73 crash for FF17. And occurs on current trunk.\nfor example bp-ed137fa9-cee8-482f-8c9d-d10582121225","id":6944921,"creation_time":"2012-12-26T15:36:54Z","raw_text":"(In reply to Scoobidiver from comment #7)\n> (In reply to Wayne Mery (:wsmwk) from comment #6)\n> > Scoobidiver, if bug 777537 was fixed in FF17 (has TM=17) then why is this\n> > not also TM=17?\n> I don't have access to bug 780274 to see if the patch landed in 17.0 or 18.0\n> but I can assure you there are still crashes in 17.0 Beta. See the link in\n> comment 1.\n\n#73 crash for FF17. And occurs on current trunk.\nfor example bp-ed137fa9-cee8-482f-8c9d-d10582121225"},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-26T18:06:16Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"(In reply to Wayne Mery (:wsmwk) from comment #8)\n> (In reply to Scoobidiver from comment #7)\n> > (In reply to Wayne Mery (:wsmwk) from comment #6)\n> > > Scoobidiver, if bug 777537 was fixed in FF17 (has TM=17) then why is this\n> > > not also TM=17?\n> > I don't have access to bug 780274 to see if the patch landed in 17.0 or 18.0\n> > but I can assure you there are still crashes in 17.0 Beta. See the link in\n> > comment 1.\n> \n> #73 crash for FF17. And occurs on current trunk.\n> for example bp-ed137fa9-cee8-482f-8c9d-d10582121225\n\nI looked again at this crash report, and it seems that we have 2 different kind of crashes, the previous one that you give the link to is a bad read access, while others recent one are bad write access to random memory (base + 0x0004) where base is not-NULL.  It looks like base + 0x0004 is likely to be coming from the next line. (in fact it is )\n\nBy reading the code, I remarked that a few cases to handle allocation issues might cause the init function to fail.  If the init function fails, we will still enter the destructor which need to check that we are definitely failing the compilation and that the compiler output registered by the init function is not available.\n\nMark this bug as s-s sec-critical because of random+0x0004 write.","id":6945178,"creation_time":"2012-12-26T18:06:16Z","raw_text":"(In reply to Wayne Mery (:wsmwk) from comment #8)\n> (In reply to Scoobidiver from comment #7)\n> > (In reply to Wayne Mery (:wsmwk) from comment #6)\n> > > Scoobidiver, if bug 777537 was fixed in FF17 (has TM=17) then why is this\n> > > not also TM=17?\n> > I don't have access to bug 780274 to see if the patch landed in 17.0 or 18.0\n> > but I can assure you there are still crashes in 17.0 Beta. See the link in\n> > comment 1.\n> \n> #73 crash for FF17. And occurs on current trunk.\n> for example bp-ed137fa9-cee8-482f-8c9d-d10582121225\n\nI looked again at this crash report, and it seems that we have 2 different kind of crashes, the previous one that you give the link to is a bad read access, while others recent one are bad write access to random memory (base + 0x0004) where base is not-NULL.  It looks like base + 0x0004 is likely to be coming from the next line. (in fact it is )\n\nBy reading the code, I remarked that a few cases to handle allocation issues might cause the init function to fail.  If the init function fails, we will still enter the destructor which need to check that we are definitely failing the compilation and that the compiler output registered by the init function is not available.\n\nMark this bug as s-s sec-critical because of random+0x0004 write."},{"is_private":false,"attachment_id":695782,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-26T18:14:27Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Created attachment 695782\nHandle init function failures in the destructor.\n\nReset the outputIndex in case of failure and use it to check that we have a valid compilerOutput.","id":6945197,"creation_time":"2012-12-26T18:14:27Z","raw_text":"Reset the outputIndex in case of failure and use it to check that we have a valid compilerOutput."},{"is_private":false,"attachment_id":null,"creator":"gary@rumblingedge.com","time":"2012-12-27T00:01:37Z","author":"gary@rumblingedge.com","bug_id":780549,"tags":[],"text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/4a66a93f8625","id":6945965,"creation_time":"2012-12-27T00:01:37Z","raw_text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/4a66a93f8625"},{"is_private":false,"attachment_id":null,"creator":"gary@rumblingedge.com","time":"2012-12-27T02:00:48Z","author":"gary@rumblingedge.com","bug_id":780549,"tags":[],"text":"Backed out in:\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/9afe21048168\n\nfor causing mochitest failures.\n\nSee https://tbpl.mozilla.org/?tree=Mozilla-Inbound&rev=4a66a93f8625","id":6946138,"creation_time":"2012-12-27T02:00:48Z","raw_text":"Backed out in:\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/9afe21048168\n\nfor causing mochitest failures.\n\nSee https://tbpl.mozilla.org/?tree=Mozilla-Inbound&rev=4a66a93f8625"},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-27T11:51:44Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"(In reply to Gary Kwong [:gkw] from comment #12)\n> Backed out in:\n> \n> https://hg.mozilla.org/integration/mozilla-inbound/rev/9afe21048168\n> \n> for causing mochitest failures.\n> \n> See https://tbpl.mozilla.org/?tree=Mozilla-Inbound&rev=4a66a93f8625\n\nThe assertion added in this code seems to fail because threaded compilation is starting 2 compilations and the destructor is seems to be called later on.  I will investigate if there is any consequence to the current code, but threaded compilation has been enabled recently and this should not affect 17 / 18.\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff367beb8 in js::types::AutoEnterCompilation::~AutoEnterCompilation (this=0x7fffffff4440, __in_chrg=<optimized out>)\n    at /home/nicolas/mozilla/ionmonkey/js/src/jsinferinlines.h:469\n469             JS_ASSERT(info.outputIndex + 1 == cx->compartment->types.constrainedOutputs->length());\n(gdb) p cx->compartment->types.constrainedOutputs->length()\n$1 = 14\n(gdb) p info.outputIndex\n$2 = 12\n(gdb) bt\n#0  0x00007ffff367beb8 in js::types::AutoEnterCompilation::~AutoEnterCompilation (this=0x7fffffff4440, __in_chrg=<optimized out>)\n    at /home/nicolas/mozilla/ionmonkey/js/src/jsinferinlines.h:469\n#1  0x00007ffff3742251 in js::ion::AttachFinishedCompilations (cx=0x7fffd67950c0)\n    at /home/nicolas/mozilla/ionmonkey/js/src/ion/Ion.cpp:1106\n#2  0x00007ffff3375868 in js_InvokeOperationCallback (cx=0x7fffd67950c0) at /home/nicolas/mozilla/ionmonkey/js/src/jscntxt.cpp:1066\n#3  0x00007ffff33758d1 in js_HandleExecutionInterrupt (cx=0x7fffd67950c0) at /home/nicolas/mozilla/ionmonkey/js/src/jscntxt.cpp:1083\n#4  0x00007ffff38b3a3f in js::mjit::stubs::Interrupt (f=..., pc=0x7fffd688d5ba \":\")\n    at /home/nicolas/mozilla/ionmonkey/js/src/methodjit/StubCalls.cpp:805\n#5  0x00007fffe414efe7 in ?? ()","id":6946768,"creation_time":"2012-12-27T11:51:44Z","raw_text":"(In reply to Gary Kwong [:gkw] from comment #12)\n> Backed out in:\n> \n> https://hg.mozilla.org/integration/mozilla-inbound/rev/9afe21048168\n> \n> for causing mochitest failures.\n> \n> See https://tbpl.mozilla.org/?tree=Mozilla-Inbound&rev=4a66a93f8625\n\nThe assertion added in this code seems to fail because threaded compilation is starting 2 compilations and the destructor is seems to be called later on.  I will investigate if there is any consequence to the current code, but threaded compilation has been enabled recently and this should not affect 17 / 18.\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff367beb8 in js::types::AutoEnterCompilation::~AutoEnterCompilation (this=0x7fffffff4440, __in_chrg=<optimized out>)\n    at /home/nicolas/mozilla/ionmonkey/js/src/jsinferinlines.h:469\n469             JS_ASSERT(info.outputIndex + 1 == cx->compartment->types.constrainedOutputs->length());\n(gdb) p cx->compartment->types.constrainedOutputs->length()\n$1 = 14\n(gdb) p info.outputIndex\n$2 = 12\n(gdb) bt\n#0  0x00007ffff367beb8 in js::types::AutoEnterCompilation::~AutoEnterCompilation (this=0x7fffffff4440, __in_chrg=<optimized out>)\n    at /home/nicolas/mozilla/ionmonkey/js/src/jsinferinlines.h:469\n#1  0x00007ffff3742251 in js::ion::AttachFinishedCompilations (cx=0x7fffd67950c0)\n    at /home/nicolas/mozilla/ionmonkey/js/src/ion/Ion.cpp:1106\n#2  0x00007ffff3375868 in js_InvokeOperationCallback (cx=0x7fffd67950c0) at /home/nicolas/mozilla/ionmonkey/js/src/jscntxt.cpp:1066\n#3  0x00007ffff33758d1 in js_HandleExecutionInterrupt (cx=0x7fffd67950c0) at /home/nicolas/mozilla/ionmonkey/js/src/jscntxt.cpp:1083\n#4  0x00007ffff38b3a3f in js::mjit::stubs::Interrupt (f=..., pc=0x7fffd688d5ba \":\")\n    at /home/nicolas/mozilla/ionmonkey/js/src/methodjit/StubCalls.cpp:805\n#5  0x00007fffe414efe7 in ?? ()"},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-27T15:22:48Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/58d263c1c3dc\n\nThe threaded compilation does an init for each compilation which is spawned, and a second AutoEnterCompilation when it links the generated code.  This means that we can have multiple compilation queued in the AutoEnterCompilation.  So I changed the assert to make sure the the outputIndex is belowed the contrainedOutputs length.","id":6947068,"creation_time":"2012-12-27T15:22:48Z","raw_text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/58d263c1c3dc\n\nThe threaded compilation does an init for each compilation which is spawned, and a second AutoEnterCompilation when it links the generated code.  This means that we can have multiple compilation queued in the AutoEnterCompilation.  So I changed the assert to make sure the the outputIndex is belowed the contrainedOutputs length."},{"is_private":false,"attachment_id":null,"creator":"abillings@mozilla.com","time":"2012-12-27T21:04:24Z","author":"abillings@mozilla.com","bug_id":780549,"tags":[],"text":"Why was this not nominated for sec-approval before being checked in, since it affects branches?","id":6947847,"creation_time":"2012-12-27T21:04:24Z","raw_text":"Why was this not nominated for sec-approval before being checked in, since it affects branches?"},{"is_private":false,"attachment_id":null,"creator":"ryanvm@gmail.com","time":"2012-12-27T22:12:20Z","author":"ryanvm@gmail.com","bug_id":780549,"tags":[],"text":"https://hg.mozilla.org/mozilla-central/rev/58d263c1c3dc\n\nThough I noticed, after merging to m-c of course (fail), that this may have caused fairly frequent OSX debug xpcshell crashes like the one in the log below. Retriggers are already pending. So there may be a backout coming.\nhttps://tbpl.mozilla.org/php/getParsedLog.php?id=18301491&tree=Mozilla-Inbound","id":6948044,"creation_time":"2012-12-27T22:12:20Z","raw_text":"https://hg.mozilla.org/mozilla-central/rev/58d263c1c3dc\n\nThough I noticed, after merging to m-c of course (fail), that this may have caused fairly frequent OSX debug xpcshell crashes like the one in the log below. Retriggers are already pending. So there may be a backout coming.\nhttps://tbpl.mozilla.org/php/getParsedLog.php?id=18301491&tree=Mozilla-Inbound"},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-28T09:15:23Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"(In reply to Ryan VanderMeulen [Intermittent Availability Until Jan. 2] from comment #16)\n> https://hg.mozilla.org/mozilla-central/rev/58d263c1c3dc\n> \n> Though I noticed, after merging to m-c of course (fail), that this may have\n> caused fairly frequent OSX debug xpcshell crashes like the one in the log\n> below. Retriggers are already pending. So there may be a backout coming.\n> https://tbpl.mozilla.org/php/getParsedLog.php?id=18301491&tree=Mozilla-\n> Inbound\n\nLooking at inbound history and annotation it seems that this was related to another changed backout at https://hg.mozilla.org/integration/mozilla-inbound/rev/f2a500997116 .\n\nI am re-opening this bug, because I noticed that the returned value of the init function was not checked during Ion compilation, which means that we will write the -1 offset of the same pointer if there is an OOM, and segv/leak while garbage collecting the next time.  I'll submit the follow-up patch in a few seconds.","id":6948962,"creation_time":"2012-12-28T09:15:23Z","raw_text":"(In reply to Ryan VanderMeulen [Intermittent Availability Until Jan. 2] from comment #16)\n> https://hg.mozilla.org/mozilla-central/rev/58d263c1c3dc\n> \n> Though I noticed, after merging to m-c of course (fail), that this may have\n> caused fairly frequent OSX debug xpcshell crashes like the one in the log\n> below. Retriggers are already pending. So there may be a backout coming.\n> https://tbpl.mozilla.org/php/getParsedLog.php?id=18301491&tree=Mozilla-\n> Inbound\n\nLooking at inbound history and annotation it seems that this was related to another changed backout at https://hg.mozilla.org/integration/mozilla-inbound/rev/f2a500997116 .\n\nI am re-opening this bug, because I noticed that the returned value of the init function was not checked during Ion compilation, which means that we will write the -1 offset of the same pointer if there is an OOM, and segv/leak while garbage collecting the next time.  I'll submit the follow-up patch in a few seconds."},{"is_private":false,"attachment_id":696252,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-28T09:23:46Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Created attachment 696252\nCheck returned value of AutoEnterCompilation::init in Ion compilation.\n\nI added checks to make sure that we don't ignore the return value of init in AutoEnterCompilation, but it seems that it was first ignored in Ion compilation.\n\nThis means, with the previous patch, that in case of OOM we would have corrupted some allocated memory.\n\nThis patch does not show as part of the original issue, but as the previous patch for this issue check that we consider the returned value of the init function, I think it is worth going with this issue as the init function has been modified to reset the outputIndex.","id":6948971,"creation_time":"2012-12-28T09:23:46Z","raw_text":"I added checks to make sure that we don't ignore the return value of init in AutoEnterCompilation, but it seems that it was first ignored in Ion compilation.\n\nThis means, with the previous patch, that in case of OOM we would have corrupted some allocated memory.\n\nThis patch does not show as part of the original issue, but as the previous patch for this issue check that we consider the returned value of the init function, I think it is worth going with this issue as the init function has been modified to reset the outputIndex."},{"is_private":false,"attachment_id":696252,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-28T22:50:58Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Comment on attachment 696252\nCheck returned value of AutoEnterCompilation::init in Ion compilation.\n\n[Security approval request comment]\nHow easily could an exploit be constructed based on the patch?\n\nNeed an OOM during the compilation. not trivial for me.\n\nDo comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?\n\nNo.\n\nWhich older supported branches are affected by this flaw?\n\nall since 17, but with the previous patch, this exchange on random write (with crash) by a silent one.\n\nIf not all supported branches, which bug introduced the flaw?\n\nThis one, this patch should be merged with the previous one before being back-ported to all branches.\n\nDo you have backports for the affected branches? If not, how different, hard to create, and risky will they be?\n\nNot yet.  Except a recent modification in Ion.cpp which is modified by this file, this should be easy to provide.\n\nHow likely is this patch to cause regressions; how much testing does it need?\n\nNo regression expected for this patch.","id":6950485,"creation_time":"2012-12-28T22:50:58Z","raw_text":"[Security approval request comment]\nHow easily could an exploit be constructed based on the patch?\n\nNeed an OOM during the compilation. not trivial for me.\n\nDo comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?\n\nNo.\n\nWhich older supported branches are affected by this flaw?\n\nall since 17, but with the previous patch, this exchange on random write (with crash) by a silent one.\n\nIf not all supported branches, which bug introduced the flaw?\n\nThis one, this patch should be merged with the previous one before being back-ported to all branches.\n\nDo you have backports for the affected branches? If not, how different, hard to create, and risky will they be?\n\nNot yet.  Except a recent modification in Ion.cpp which is modified by this file, this should be easy to provide.\n\nHow likely is this patch to cause regressions; how much testing does it need?\n\nNo regression expected for this patch."},{"is_private":false,"attachment_id":696422,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-28T23:12:40Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Created attachment 696422\ninbound patch [part 2, rebased]\n\nThis fix a compilation issue related to the change of the return value type made a few hours ago. (same logic as attachment 696252)","id":6950523,"creation_time":"2012-12-28T23:12:40Z","raw_text":"This fix a compilation issue related to the change of the return value type made a few hours ago. (same logic as attachment 696252)"},{"is_private":false,"attachment_id":696426,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-28T23:34:34Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Created attachment 696426\naurora patch\n\n[Approval Request Comment]\nBug caused by (feature/regressing bug #): Bug 772509\n\nUser impact if declined: crash, https://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29\n\nTesting completed (on m-c, etc.):\npart 1, yes\npart 2: to be landed after sec-approval.\n(This patch merge both into one)\n\nRisk to taking this patch (and alternatives if risky):\nseems low. (JS test suite ok)\n\nString or UUID changes made by this patch: N/A","id":6950564,"creation_time":"2012-12-28T23:34:34Z","raw_text":"[Approval Request Comment]\nBug caused by (feature/regressing bug #): Bug 772509\n\nUser impact if declined: crash, https://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29\n\nTesting completed (on m-c, etc.):\npart 1, yes\npart 2: to be landed after sec-approval.\n(This patch merge both into one)\n\nRisk to taking this patch (and alternatives if risky):\nseems low. (JS test suite ok)\n\nString or UUID changes made by this patch: N/A"},{"is_private":false,"attachment_id":696430,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-28T23:48:07Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Created attachment 696430\nbeta patch\n\n[Approval Request Comment]\nBug caused by (feature/regressing bug #): Bug 772509\n\nUser impact if declined: crash, https://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29\n\nTesting completed (on m-c, etc.):\npart 1, yes\npart 2: to be landed after sec-approval.\n(This patch merge both into one)\n\nRisk to taking this patch (and alternatives if risky):\nseems low.\n\nString or UUID changes made by this patch: N/A","id":6950610,"creation_time":"2012-12-28T23:48:07Z","raw_text":"[Approval Request Comment]\nBug caused by (feature/regressing bug #): Bug 772509\n\nUser impact if declined: crash, https://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29\n\nTesting completed (on m-c, etc.):\npart 1, yes\npart 2: to be landed after sec-approval.\n(This patch merge both into one)\n\nRisk to taking this patch (and alternatives if risky):\nseems low.\n\nString or UUID changes made by this patch: N/A"},{"is_private":false,"attachment_id":695782,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-29T00:02:04Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Comment on attachment 695782\nHandle init function failures in the destructor.\n\n[Approval Request Comment]\nBug caused by (feature/regressing bug #): Bug 772509\n\nUser impact if declined: crash, https://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29\n\nTesting completed (on m-c, etc.):\npart 1, yes\npart 2: to be landed after sec-approval.\n(This patch merge both into one)\n\nRisk to taking this patch (and alternatives if risky):\nseems low.\n\nString or UUID changes made by this patch: N/A\n\n\n\n[Approval Request Comment]\nIf this is not a sec:{high,crit} bug, please state case for ESR consideration:\nsec-critical, cause crashes by writing at random memory addresses. (#73)\n\nUser impact if declined: crash, https://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29\n\nFix Landed on Version: inbound & central, the part 2 is not needed as the second part of this bug deals with IonMonkey which landed in Fx 18 (beta).\n\nRisk to taking this patch (and alternatives if risky): \nseems low.\n\nString or UUID changes made by this patch: N/A\n\nSee https://wiki.mozilla.org/Release_Management/ESR_Landing_Process for more info.","id":6950626,"creation_time":"2012-12-29T00:02:04Z","raw_text":"[Approval Request Comment]\nBug caused by (feature/regressing bug #): Bug 772509\n\nUser impact if declined: crash, https://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29\n\nTesting completed (on m-c, etc.):\npart 1, yes\npart 2: to be landed after sec-approval.\n(This patch merge both into one)\n\nRisk to taking this patch (and alternatives if risky):\nseems low.\n\nString or UUID changes made by this patch: N/A\n\n\n\n[Approval Request Comment]\nIf this is not a sec:{high,crit} bug, please state case for ESR consideration:\nsec-critical, cause crashes by writing at random memory addresses. (#73)\n\nUser impact if declined: crash, https://crash-stats.mozilla.com/report/list?signature=js%3A%3Atypes%3A%3AAutoEnterCompilation%3A%3A~AutoEnterCompilation%28%29\n\nFix Landed on Version: inbound & central, the part 2 is not needed as the second part of this bug deals with IonMonkey which landed in Fx 18 (beta).\n\nRisk to taking this patch (and alternatives if risky): \nseems low.\n\nString or UUID changes made by this patch: N/A\n\nSee https://wiki.mozilla.org/Release_Management/ESR_Landing_Process for more info."},{"is_private":false,"attachment_id":696430,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-29T00:03:51Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Comment on attachment 696430\nbeta patch\n\n[Approval Request Comment]\nSee comment #22 (same patch)","id":6950631,"creation_time":"2012-12-29T00:03:51Z","raw_text":"[Approval Request Comment]\nSee comment #22 (same patch)"},{"is_private":false,"attachment_id":696422,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-29T00:28:29Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Comment on attachment 696422\ninbound patch [part 2, rebased]\n\nObsolete because bug 823884 as been backout at changeset e497c2e40dc6.\nUse attachment 696252 instead.","id":6950667,"creation_time":"2012-12-29T00:28:29Z","raw_text":"Obsolete because bug 823884 as been backout at changeset e497c2e40dc6.\nUse attachment 696252 instead."},{"is_private":false,"attachment_id":696252,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-29T00:35:22Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"Comment on attachment 696252\nCheck returned value of AutoEnterCompilation::init in Ion compilation.\n\nUse attachment 696422 if bug 823884 is re-landed before this patch.","id":6950680,"creation_time":"2012-12-29T00:35:22Z","raw_text":"Use attachment 696422 if bug 823884 is re-landed before this patch."},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-29T11:20:43Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/8468d858595c (part 2)\n\nThis part of the patch should go in all version after fx 18, including fx 18. as it deals with IonMonkey missing check.","id":6951135,"creation_time":"2012-12-29T11:20:43Z","raw_text":"https://hg.mozilla.org/integration/mozilla-inbound/rev/8468d858595c (part 2)\n\nThis part of the patch should go in all version after fx 18, including fx 18. as it deals with IonMonkey missing check."},{"is_private":false,"attachment_id":null,"creator":"kairo@kairo.at","time":"2012-12-29T14:54:23Z","author":"kairo@kairo.at","bug_id":780549,"tags":[],"text":"(In reply to Nicolas B. Pierron [:pierron] [:nbp] from comment #27)\n> This part of the patch should go in all version after fx 18, including fx\n> 18. as it deals with IonMonkey missing check.\n\nAs 18 is closed for anything other than the last two high-value fixes we are tracking, you should probably email release-mgmt in addition to those approval requests if this really should still land there.","id":6951282,"creation_time":"2012-12-29T14:54:23Z","raw_text":"(In reply to Nicolas B. Pierron [:pierron] [:nbp] from comment #27)\n> This part of the patch should go in all version after fx 18, including fx\n> 18. as it deals with IonMonkey missing check.\n\nAs 18 is closed for anything other than the last two high-value fixes we are tracking, you should probably email release-mgmt in addition to those approval requests if this really should still land there."},{"is_private":false,"attachment_id":null,"creator":"bbajaj@mozilla.com","time":"2012-12-30T00:28:59Z","author":"bbajaj@mozilla.com","bug_id":780549,"tags":[],"text":"This does not seem to be a top-crasher in FF18 and we already have our scheduled final beta 6 out . We are spinning an urgent beta 7 only for blocker issues at this time for Fx18.Hence approving the patch only for aurora/b2g18 .\n\nIn addition I am not approving the patch for release, as we would not be chemspilling for this issue.","id":6951730,"creation_time":"2012-12-30T00:28:59Z","raw_text":"This does not seem to be a top-crasher in FF18 and we already have our scheduled final beta 6 out . We are spinning an urgent beta 7 only for blocker issues at this time for Fx18.Hence approving the patch only for aurora/b2g18 .\n\nIn addition I am not approving the patch for release, as we would not be chemspilling for this issue."},{"is_private":false,"attachment_id":null,"creator":"ehsan@mozilla.com","time":"2012-12-30T01:29:43Z","author":"ehsan@mozilla.com","bug_id":780549,"tags":[],"text":"https://hg.mozilla.org/mozilla-central/rev/8468d858595c","id":6951769,"creation_time":"2012-12-30T01:29:43Z","raw_text":"https://hg.mozilla.org/mozilla-central/rev/8468d858595c"},{"is_private":false,"attachment_id":null,"creator":"kairo@kairo.at","time":"2012-12-30T12:56:18Z","author":"kairo@kairo.at","bug_id":780549,"tags":[],"text":"Oh, and we check in a sec-crit fix more than a week before releasing a vulnerable version? That doesn't sound good to me. :(","id":6952130,"creation_time":"2012-12-30T12:56:18Z","raw_text":"Oh, and we check in a sec-crit fix more than a week before releasing a vulnerable version? That doesn't sound good to me. :("},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2012-12-31T10:17:44Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"https://hg.mozilla.org/releases/mozilla-aurora/rev/ffa57091f9fa","id":6953046,"creation_time":"2012-12-31T10:17:44Z","raw_text":"https://hg.mozilla.org/releases/mozilla-aurora/rev/ffa57091f9fa"},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2013-01-04T23:32:17Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"What is the meaning of 19+ for tracking flags?","id":6965449,"creation_time":"2013-01-04T23:32:17Z","raw_text":"What is the meaning of 19+ for tracking flags?"},{"is_private":false,"attachment_id":null,"creator":"continuation@gmail.com","time":"2013-01-04T23:35:37Z","author":"continuation@gmail.com","bug_id":780549,"tags":[],"text":"I think it means the version of esr17 (or whatever) that will be released at the same time as Firefox 19.","id":6965458,"creation_time":"2013-01-04T23:35:37Z","raw_text":"I think it means the version of esr17 (or whatever) that will be released at the same time as Firefox 19."},{"is_private":false,"attachment_id":null,"creator":"akeybl@mozilla.com","time":"2013-01-07T23:37:34Z","author":"akeybl@mozilla.com","bug_id":780549,"tags":[],"text":"(In reply to Andrew McCreight [:mccr8] from comment #34)\n> I think it means the version of esr17 (or whatever) that will be released at\n> the same time as Firefox 19.\n\nCorrect.","id":6972204,"creation_time":"2013-01-07T23:37:34Z","raw_text":"(In reply to Andrew McCreight [:mccr8] from comment #34)\n> I think it means the version of esr17 (or whatever) that will be released at\n> the same time as Firefox 19.\n\nCorrect."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2013-01-09T21:43:24Z","author":"anthony.s.hughes@gmail.com","bug_id":780549,"tags":[],"text":"Do we have steps to reproduce this crash which QA can use for verification?","id":6981864,"creation_time":"2013-01-09T21:43:24Z","raw_text":"Do we have steps to reproduce this crash which QA can use for verification?"},{"is_private":false,"attachment_id":null,"creator":"nicolas.b.pierron@mozilla.com","time":"2013-01-09T22:02:22Z","author":"nicolas.b.pierron@mozilla.com","bug_id":780549,"tags":[],"text":"(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #36)\n> Do we have steps to reproduce this crash which QA can use for verification?\n\nYou need to be at the limit to the OOM, and have plenty of concurrent Ion compilations, then after this is a question of luck to hit this error.\n\nOne potential script which might trigger OOM in a similar area would be something like:\n\nvar nFun = 10000;\nvar triggerIon = 15000;\nvar funs = new Array(nFun);\n\nfor (var i = 0; i < nFun; i++)\n  funs[i] = new Function(\"\");\n\nfor (var j = 0; j < triggerIon; j++) {\n  // Will cause plenty of Ion compilation in parallel.\n  for (var f = 0; f < nFun; f++)\n     funs[f]();\n}\n\nSadly this would be hardly reproducible as you are more likely to have OOM for other reasons than in the AutoEnterCompilation.  If you want to attack such OOM cases, try to increase nFun to cause the grow (reallocation) of the compilerOutput vector during the append function contained in the init function.","id":6981975,"creation_time":"2013-01-09T22:02:22Z","raw_text":"(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #36)\n> Do we have steps to reproduce this crash which QA can use for verification?\n\nYou need to be at the limit to the OOM, and have plenty of concurrent Ion compilations, then after this is a question of luck to hit this error.\n\nOne potential script which might trigger OOM in a similar area would be something like:\n\nvar nFun = 10000;\nvar triggerIon = 15000;\nvar funs = new Array(nFun);\n\nfor (var i = 0; i < nFun; i++)\n  funs[i] = new Function(\"\");\n\nfor (var j = 0; j < triggerIon; j++) {\n  // Will cause plenty of Ion compilation in parallel.\n  for (var f = 0; f < nFun; f++)\n     funs[f]();\n}\n\nSadly this would be hardly reproducible as you are more likely to have OOM for other reasons than in the AutoEnterCompilation.  If you want to attack such OOM cases, try to increase nFun to cause the grow (reallocation) of the compilerOutput vector during the append function contained in the init function."},{"is_private":false,"attachment_id":null,"creator":"anthony.s.hughes@gmail.com","time":"2013-01-09T22:11:29Z","author":"anthony.s.hughes@gmail.com","bug_id":780549,"tags":[],"text":"Thanks Nicolas. Unfortunately, given the complexity to reproduce this crash, I don't think QA won't be able to reliably verify this is fixed in a timely manner. Marking this bug as [qa-].\n\nWould this be something we could explore covering with automation?","id":6982031,"creation_time":"2013-01-09T22:11:29Z","raw_text":"Thanks Nicolas. Unfortunately, given the complexity to reproduce this crash, I don't think QA won't be able to reliably verify this is fixed in a timely manner. Marking this bug as [qa-].\n\nWould this be something we could explore covering with automation?"},{"is_private":false,"attachment_id":null,"creator":"lukasblakk+bugs@gmail.com","time":"2013-01-22T20:10:01Z","author":"lukasblakk+bugs@gmail.com","bug_id":780549,"tags":[],"text":"Leaving the approval nom until we are ready to take landings for v1-train on b2g18 branch as per https://wiki.mozilla.org/Release_Management/B2G_Landing","id":7026977,"creation_time":"2013-01-22T20:10:01Z","raw_text":"Leaving the approval nom until we are ready to take landings for v1-train on b2g18 branch as per https://wiki.mozilla.org/Release_Management/B2G_Landing"},{"is_private":false,"attachment_id":null,"creator":"bbajaj@mozilla.com","time":"2013-01-23T21:46:29Z","author":"bbajaj@mozilla.com","bug_id":780549,"tags":[],"text":"Please go ahead and land this for esr17 at this time.","id":7031788,"creation_time":"2013-01-23T21:46:29Z","raw_text":"Please go ahead and land this for esr17 at this time."},{"is_private":false,"attachment_id":null,"creator":"ryanvm@gmail.com","time":"2013-01-24T18:43:40Z","author":"ryanvm@gmail.com","bug_id":780549,"tags":[],"text":"Landed on esr17 minus the Ion.cpp bits.\nhttps://hg.mozilla.org/releases/mozilla-esr17/rev/54f5dba3caf4","id":7035373,"creation_time":"2013-01-24T18:43:40Z","raw_text":"Landed on esr17 minus the Ion.cpp bits.\nhttps://hg.mozilla.org/releases/mozilla-esr17/rev/54f5dba3caf4"},{"is_private":false,"attachment_id":null,"creator":"ryanvm@gmail.com","time":"2013-01-29T17:05:53Z","author":"ryanvm@gmail.com","bug_id":780549,"tags":[],"text":"https://hg.mozilla.org/releases/mozilla-b2g18/rev/8cd47ef18c2f","id":7049426,"creation_time":"2013-01-29T17:05:53Z","raw_text":"https://hg.mozilla.org/releases/mozilla-b2g18/rev/8cd47ef18c2f"},{"is_private":false,"attachment_id":null,"creator":"akeybl@mozilla.com","time":"2013-04-02T22:01:03Z","author":"akeybl@mozilla.com","bug_id":780549,"tags":[],"text":"Since Firefox 20 is now released, v1.0.1 branches are still open, and this is considered low risk, we can uplift to v1.0.1. Marking as tef+ and flipping status-b2g18-v1.0.1 to affected.","id":7269094,"creation_time":"2013-04-02T22:01:03Z","raw_text":"Since Firefox 20 is now released, v1.0.1 branches are still open, and this is considered low risk, we can uplift to v1.0.1. Marking as tef+ and flipping status-b2g18-v1.0.1 to affected."},{"is_private":false,"attachment_id":null,"creator":"ryanvm@gmail.com","time":"2013-04-03T02:22:45Z","author":"ryanvm@gmail.com","bug_id":780549,"tags":[],"text":"In before the branch.","id":7269985,"creation_time":"2013-04-03T02:22:45Z","raw_text":"In before the branch."}]}},"comments":{}}