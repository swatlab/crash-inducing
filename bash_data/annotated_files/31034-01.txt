25959: diff --git a/media/libvorbis/include/vorbis/codec.h b/media/libvorbis/include/vorbis/codec.h
25959: index b23fe0a..c62b2d5 100644
25959: --- a/media/libvorbis/include/vorbis/codec.h
25959: +++ b/media/libvorbis/include/vorbis/codec.h
31034: @@ -170,18 +170,19 @@ extern void     vorbis_comment_add(vorbis_comment *vc, char *comment);
25959:  extern void     vorbis_comment_add_tag(vorbis_comment *vc,
31034:                                         const char *tag, const char *contents);
31034:  extern char    *vorbis_comment_query(vorbis_comment *vc, const char *tag, int count);
31034:  extern int      vorbis_comment_query_count(vorbis_comment *vc, const char *tag);
25959:  extern void     vorbis_comment_clear(vorbis_comment *vc);
25959:  
25959:  extern int      vorbis_block_init(vorbis_dsp_state *v, vorbis_block *vb);
25959:  extern int      vorbis_block_clear(vorbis_block *vb);
25959: +extern void     vorbis_dsp_init(vorbis_dsp_state *v);
25959:  extern void     vorbis_dsp_clear(vorbis_dsp_state *v);
25959:  extern double   vorbis_granule_time(vorbis_dsp_state *v,
25959:                                      ogg_int64_t granulepos);
25959:  
31034:  extern const char *vorbis_version_string(void);
31034:  
25959:  /* Vorbis PRIMITIVES: analysis/DSP layer ****************************/
25959:  
25959:  extern int      vorbis_analysis_init(vorbis_dsp_state *v,vorbis_info *vi);
25959:  extern int      vorbis_commentheader_out(vorbis_comment *vc, ogg_packet *op);
25959: diff --git a/media/libvorbis/lib/vorbis_block.c b/media/libvorbis/lib/vorbis_block.c
25959: index 3b6f456..d7f5974 100644
25959: --- a/media/libvorbis/lib/vorbis_block.c
25959: +++ b/media/libvorbis/lib/vorbis_block.c
25959: @@ -84,18 +84,16 @@ static int ilog2(unsigned int v){
25959:  #ifndef WORD_ALIGN
25959:  #define WORD_ALIGN 8
25959:  #endif
25959:  
25959:  int vorbis_block_init(vorbis_dsp_state *v, vorbis_block *vb){
25959:    int i;
25959:    memset(vb,0,sizeof(*vb));
25959:    vb->vd=v;
25959: -  vb->localalloc=0;
25959: -  vb->localstore=NULL;
25959:    if(v->analysisp){
25959:      vorbis_block_internal *vbi=
25959:        vb->internal=_ogg_calloc(1,sizeof(vorbis_block_internal));
25959:      vbi->ampmax=-9999;
25959:  
25959:      for(i=0;i<PACKETBLOBS;i++){
25959:        if(i==PACKETBLOBS/2){
25959:  	vbi->packetblob[i]=&vb->opb;
25959: @@ -295,16 +293,20 @@ int vorbis_analysis_init(vorbis_dsp_state *v,vorbis_info *vi){
25959:  
25959:    /* compressed audio packets start after the headers
25959:       with sequence number 3 */
25959:    v->sequence=3;
25959:  
25959:    return(0);
25959:  }
25959:  
25959: +void vorbis_dsp_init(vorbis_dsp_state *v){
25959: +  memset(v,0,sizeof(*v));
25959: +}
25959: +
25959:  void vorbis_dsp_clear(vorbis_dsp_state *v){
25959:    int i;
25959:    if(v){
25959:      vorbis_info *vi=v->vi;
25959:      codec_setup_info *ci=(vi?vi->codec_setup:NULL);
25959:      private_state *b=v->backend_state;
25959:  
25959:      if(b){
