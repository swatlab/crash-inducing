54887: /* vim: se cin sw=2 ts=2 et : */
54887: /* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-
54887:  *
54887:  * ***** BEGIN LICENSE BLOCK *****
54887:  * Version: MPL 1.1/GPL 2.0/LGPL 2.1
54887:  *
54887:  * The contents of this file are subject to the Mozilla Public License Version
54887:  * 1.1 (the "License"); you may not use this file except in compliance with
54887:  * the License. You may obtain a copy of the License at
54887:  * http://www.mozilla.org/MPL/
54887:  *
54887:  * Software distributed under the License is distributed on an "AS IS" basis,
54887:  * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
54887:  * for the specific language governing rights and limitations under the
54887:  * License.
54887:  *
54887:  * The Original Code is mozilla.org code.
54887:  *
54887:  * The Initial Developer of the Original Code is
54887:  * Mozilla Foundation.
54887:  * Portions created by the Initial Developer are Copyright (C) 2010
54887:  * the Initial Developer. All Rights Reserved.
54887:  *
54887:  * Contributor(s):
54887:  *
54887:  * Alternatively, the contents of this file may be used under the terms of
54887:  * either the GNU General Public License Version 2 or later (the "GPL"), or
54887:  * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
54887:  * in which case the provisions of the GPL or the LGPL are applicable instead
54887:  * of those above. If you wish to allow use of your version of this file only
54887:  * under the terms of either the GPL or the LGPL, and not to allow others to
54887:  * use your version of this file under the terms of the MPL, indicate your
54887:  * decision by deleting the provisions above and replace them with the notice
54887:  * and other provisions required by the GPL or the LGPL. If you do not delete
54887:  * the provisions above, a recipient may use your version of this file under
54887:  * the terms of any one of the MPL, the GPL or the LGPL.
54887:  *
54887:  * ***** END LICENSE BLOCK ***** */
54887: 
54887: #ifndef __mozilla_widget_GfxInfo_h__
54887: #define __mozilla_widget_GfxInfo_h__
54887: 
60891: #include "GfxInfoBase.h"
54887: 
54887: #include "nsString.h"
54887: 
54887: namespace mozilla {
54887: namespace widget {
54887: 
60891: class GfxInfo : public GfxInfoBase
54887: {
54887: public:
79359: 
79359:   GfxInfo();
60891:   // We only declare the subset of nsIGfxInfo that we actually implement. The
60891:   // rest is brought forward from GfxInfoBase.
79445:   NS_SCRIPTABLE NS_IMETHOD GetD2DEnabled(bool *aD2DEnabled);
79445:   NS_SCRIPTABLE NS_IMETHOD GetDWriteEnabled(bool *aDWriteEnabled);
79445:   NS_SCRIPTABLE NS_IMETHOD GetAzureEnabled(bool *aAzureEnabled);
60891:   NS_SCRIPTABLE NS_IMETHOD GetDWriteVersion(nsAString & aDwriteVersion);
69664:   NS_SCRIPTABLE NS_IMETHOD GetCleartypeParameters(nsAString & aCleartypeParams);
60891:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDescription(nsAString & aAdapterDescription);
60891:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDriver(nsAString & aAdapterDriver);
85902:   NS_SCRIPTABLE NS_IMETHOD GetAdapterVendorID(PRUint32 *aAdapterVendorID);
85902:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDeviceID(PRUint32 *aAdapterDeviceID);
60891:   NS_SCRIPTABLE NS_IMETHOD GetAdapterRAM(nsAString & aAdapterRAM);
60891:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDriverVersion(nsAString & aAdapterDriverVersion);
60891:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDriverDate(nsAString & aAdapterDriverDate);
76321:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDescription2(nsAString & aAdapterDescription);
76321:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDriver2(nsAString & aAdapterDriver);
85902:   NS_SCRIPTABLE NS_IMETHOD GetAdapterVendorID2(PRUint32 *aAdapterVendorID);
85902:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDeviceID2(PRUint32 *aAdapterDeviceID);
76321:   NS_SCRIPTABLE NS_IMETHOD GetAdapterRAM2(nsAString & aAdapterRAM);
76321:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDriverVersion2(nsAString & aAdapterDriverVersion);
76321:   NS_SCRIPTABLE NS_IMETHOD GetAdapterDriverDate2(nsAString & aAdapterDriverDate);
79445:   NS_SCRIPTABLE NS_IMETHOD GetIsGPU2Active(bool *aIsGPU2Active);
60891:   using GfxInfoBase::GetFeatureStatus;
60891:   using GfxInfoBase::GetFeatureSuggestedDriverVersion;
60891:   using GfxInfoBase::GetWebGLParameter;
60891: 
60893:   virtual nsresult Init();
60893: 
60891: protected:
60891: 
81328:   virtual nsresult GetFeatureStatusImpl(PRInt32 aFeature, 
81328:                                         PRInt32 *aStatus, 
81328:                                         nsAString & aSuggestedDriverVersion, 
84603:                                         const nsTArray<GfxDriverInfo>& aDriverInfo,
81328:                                         OperatingSystem* aOS = nsnull);
84603:   virtual const nsTArray<GfxDriverInfo>& GetGfxDriverInfo();
60891: 
54887: private:
54887: 
79359:   void GetDeviceInfo();
54887:   void AddCrashReportAnnotations();
54887:   nsString mRendererIDsString;
54887:   nsString mAdapterRAMString;
54887: 
54887:   nsString mDeviceID;
54887:   nsString mDriverVersion;
54887:   nsString mDriverDate;
54887:   nsString mDeviceKey;
54887: 
85902:   PRUint32 mAdapterVendorID;
85902:   PRUint32 mAdapterDeviceID;
79359: 
54887:   PRUint32 mRendererIDs[16];
81328: 
81328:   PRUint32 mOSXVersion;
54887: };
54887: 
54887: } // namespace widget
54887: } // namespace mozilla
54887: 
54887: #endif /* __mozilla_widget_GfxInfo_h__ */
