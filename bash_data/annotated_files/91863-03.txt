58639: <html xmlns="http://www.w3.org/1999/xhtml">
58639: <!--
58639: https://bugzilla.mozilla.org/show_bug.cgi?id=515116
58639: -->
58639: <head>
58639:   <title>Tests specific to SVGLengthList</title>
58639:   <script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
90212:   <script type="text/javascript" src="MutationEventChecker.js"></script>
58639:   <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css" />
58639: </head>
58639: <body>
58639: <a target="_blank" href="https://bugzilla.mozilla.org/show_bug.cgi?id=515116">Mozilla Bug 515116</a>
58639: <p id="display"></p>
58639: <div id="content" style="display:none;">
58639: <svg id="svg" xmlns="http://www.w3.org/2000/svg" width="100" height="100">
58639:   <text id="text" x="10cm 20cm 30mc"/>
58639: </svg>
58639: </div>
58639: <pre id="test">
58639: <script class="testbody" type="text/javascript">
58639: <![CDATA[
58639: 
58639: SimpleTest.waitForExplicitFinish();
58639: 
58639: /*
58639: This file runs a series of SVGLengthList specific tests. Generic SVGXxxList
58639: tests can be found in test_SVGxxxList.xhtml. Anything that can be generalized
58639: to other list types belongs there.
58639: */
58639: 
58639: function run_tests()
58639: {
58639:   document.getElementById('svg').pauseAnimations();
58639: 
58639:   var text = document.getElementById("text");
58639:   var lengths = text.x.baseVal;
58639: 
58639:   is(lengths.numberOfItems, 0, 'Checking numberOfItems');
58639: 
90212:   // Test mutation events
90212:   // --- Initialization
90212:   eventChecker = new MutationEventChecker;
90212:   eventChecker.watchAttr(text, "x");
90212:   eventChecker.expect("modify");
90212:   text.textContent = "abc";
90212:   text.setAttribute("x", "10 20 30");
90212:   is(lengths.numberOfItems, 3, 'Checking numberOfItems');
90212:   // -- Actual changes
90212:   eventChecker.expect("modify modify modify modify modify");
90212:   lengths[0].value = 8;
90212:   lengths[0].valueInSpecifiedUnits = 9;
90212:   lengths[0].valueAsString = "10";
90212:   lengths[0].convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_CM);
90212:   lengths[0].newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_MM, 11);
90212:   // -- Redundant changes
90212:   eventChecker.expect("modify");
90212:   lengths[0].valueAsString = "10";
90212:   eventChecker.expect("");
90212:   lengths[0].value = 10;
90212:   lengths[0].valueInSpecifiedUnits = 10;
90212:   lengths[0].valueAsString = "10";
90212:   lengths[0].convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER);
90212:   lengths[0].newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_NUMBER, 10);
91863:   // -- Attribute removal
91863:   eventChecker.expect("remove");
91863:   text.removeAttribute("x");
91863:   // -- Non-existent attribute removal
91863:   eventChecker.expect("");
91863:   text.removeAttribute("x");
91863:   text.removeAttributeNS(null, "x");
90212:   eventChecker.finish();
58639: 
58639:   SimpleTest.finish();
58639: }
58639: 
58639: window.addEventListener("load", run_tests, false);
58639: 
58639: ]]>
58639: </script>
58639: </pre>
58639: </body>
58639: </html>
