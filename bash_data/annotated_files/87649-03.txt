    1: # ***** BEGIN LICENSE BLOCK *****
    1: # Version: MPL 1.1/GPL 2.0/LGPL 2.1
    1: #
    1: # The contents of this file are subject to the Mozilla Public License Version
    1: # 1.1 (the "License"); you may not use this file except in compliance with
    1: # the License. You may obtain a copy of the License at
    1: # http://www.mozilla.org/MPL/
    1: #
    1: # Software distributed under the License is distributed on an "AS IS" basis,
    1: # WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
    1: # for the specific language governing rights and limitations under the
    1: # License.
    1: #
    1: # The Original Code is the Mozilla Mac OS X Universal Binary Packaging System
    1: #
    1: # The Initial Developer of the Original Code is Google Inc.
    1: # Portions created by the Initial Developer are Copyright (C) 2006
    1: # the Initial Developer. All Rights Reserved.
    1: #
    1: # Contributor(s):
    1: #  Mark Mentovai <mark@moxienet.com> (Original Author)
    1: #
    1: # Alternatively, the contents of this file may be used under the terms of
    1: # either the GNU General Public License Version 2 or later (the "GPL"), or
    1: # the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
    1: # in which case the provisions of the GPL or the LGPL are applicable instead
    1: # of those above. If you wish to allow use of your version of this file only
    1: # under the terms of either the GPL or the LGPL, and not to allow others to
    1: # use your version of this file under the terms of the MPL, indicate your
    1: # decision by deleting the provisions above and replace them with the notice
    1: # and other provisions required by the GPL or the LGPL. If you do not delete
    1: # the provisions above, a recipient may use your version of this file under
    1: # the terms of any one of the MPL, the GPL or the LGPL.
    1: #
    1: # ***** END LICENSE BLOCK *****
    1: 
    1: mk_add_options MOZ_UNIFY_BDATE=1
    1: 
    1: mk_add_options MOZ_POSTFLIGHT_ALL+=build/macosx/universal/flight.mk
    1: 
77079: # Note, the version (10) is used by libffi's configure.
77079: ac_add_app_options i386 --target=i386-apple-darwin10
77079: ac_add_app_options x86_64 --target=x86_64-apple-darwin10
    1: 
87635: ac_add_options --with-macos-sdk=/Developer/SDKs/MacOSX10.6.sdk
    1: 
84279: . $topsrcdir/build/macosx/common
84279: 
    1: # $MOZ_BUILD_APP is only defined when sourced by configure.  That's not a
    1: # problem, because the variables it affects only need to be set for
    1: # configure.
    1: if test -n "$MOZ_BUILD_APP" ; then
83070: if test "$MOZ_BUILD_APP" = "i386" -o "$MOZ_BUILD_APP" = "x86_64"; then
    1:   TARGET_CPU=$MOZ_BUILD_APP
63530: 
63530:   # $HOST_CXX is presently unused.  $HOST_CC will only be used during a cross
63530:   # compile.
63530:   HOST_CC=$CC
63530:   HOST_CXX=$CXX
63530: 
63530:   NATIVE_CPU=`$topsrcdir/build/autoconf/config.guess | cut -f1 -d-`
    1: 
    1:   # It's not strictly necessary to specify -arch during native builds, but it
    1:   # makes the merged about:buildconfig easier to follow, and it reduces
    1:   # conditionalized differences between builds.
63530:   CC="$CC -arch $TARGET_CPU"
63530:   CXX="$CXX -arch $TARGET_CPU"
    1: 
    1:   # These must be set for cross builds, and don't hurt straight builds.
    1:   RANLIB=ranlib
    1:   AR=ar
    1:   AS=$CC
    1:   LD=ld
    1:   STRIP="strip -x -S"
    1: 
    1:   # Let configure know that we mean business.
    1:   if test "$NATIVE_CPU" != "$TARGET_CPU" ; then
    1:     CROSS_COMPILE=1
    1:   fi
    1: 
    1:   # Each per-CPU build should be entirely oblivious to the fact that a
    1:   # universal binary will be produced.  The exception is packager.mk, which
    1:   # needs to know to look for universal bits when building the .dmg.
    1:   UNIVERSAL_BINARY=1
13895: 
13997:   export CC CXX HOST_CC HOST_CXX RANLIB AR AS LD STRIP
    1: fi
13232: fi
