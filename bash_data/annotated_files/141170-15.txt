 99778: /* This Source Code Form is subject to the terms of the Mozilla Public
 99778:  * License, v. 2.0. If a copy of the MPL was not distributed with this
 99778:  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
     1: 
     1: #ifndef _NSUSAGEARRAYHELPER_H_
     1: #define _NSUSAGEARRAYHELPER_H_
     1: 
140656: #include "certt.h"
140656: 
140638: #include "nsNSSComponent.h"
     1: 
     1: class nsUsageArrayHelper
     1: {
     1: public:
     1:   nsUsageArrayHelper(CERTCertificate *aCert);
     1: 
     1:   nsresult GetUsagesArray(const char *suffix,
 79445:                bool localOnly,
108991:                uint32_t outArraySize,
108991:                uint32_t *_verified,
108991:                uint32_t *_count,
     1:                PRUnichar **tmpUsages);
     1: 
     1:   enum { max_returned_out_array_size = 12 };
     1: 
     1: private:
     1:   CERTCertificate *mCert;
     1:   nsresult m_rv;
     1:   CERTCertDBHandle *defaultcertdb;
     1:   nsCOMPtr<nsINSSComponent> nssComponent;
     1: 
139851:   // XXX: old, non-libpkix version of check that will be removed after the
139851:   // switch to libpkix is final.
     1:   void check(const char *suffix,
     1:              SECCertificateUsage aCertUsage,
108991:              uint32_t &aCounter,
     1:              PRUnichar **outUsages);
     1: 
141170: #ifndef NSS_NO_LIBPKIX
139851:   uint32_t check(uint32_t previousCheckResult,
139851:                  const char *suffix,
139851:                  SECCertificateUsage aCertUsage,
140656:                  nsCERTValInParamWrapper * aValInParams,
139851:                  uint32_t &aCounter,
139851:                  PRUnichar **outUsages);
141170: #endif
139851: 
108991:   void verifyFailed(uint32_t *_verified, int err);
     1: };
     1: 
     1: #endif
