27794: <!DOCTYPE HTML>
27794: <html>
27794: <!--
27794: https://bugzilla.mozilla.org/show_bug.cgi?id=419132
27794: -->
27794: <head>
27794:   <title>Test for Bug 419132</title>
27794:   <script type="application/javascript" src="/MochiKit/MochiKit.js"></script>
27794:   <script type="application/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
27794:   <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"/>
27794: </head>
27794: <body>
27794: <a target="_blank" href="https://bugzilla.mozilla.org/show_bug.cgi?id=419132">Mozilla Bug 419132</a>
27794: <p id="display"></p>
27794: <div id="content" style="display: none">
27794:   
27794: </div>
68680: <iframe id="i"></iframe>
27794: <pre id="test">
27794: <script type="application/javascript">
27794: 
27794: /** Test for Bug 419132 **/
27794: 
27794: SimpleTest.waitForExplicitFinish();
68680: addLoadEvent(function() {
68680:   var iframe = document.getElementById("i");
68680:   var loadCounts = 4;
68680:   iframe.addEventListener("load", function() {
68680:     if (--loadCounts == 0) {
27794:       ok(true, "This is a mochikit version of a crash test. To complete is to pass.");
27794:       SimpleTest.finish();
68680:     } else {
68680:       // Garbage collect after every other load
68680:       if ((loadCounts % 2) == 1) {
68680:         SpecialPowers.gc();
27794:       }
68680:       setTimeout(function() {
68680:         iframe.contentWindow.location.reload();
68680:       }, 0);
68680:     }
68680:   }, false);
68680:   iframe.src = "bug419132.html";
68680: });
27794: 
27794: </script>
27794: </pre>
27794: </body>
27794: </html>
