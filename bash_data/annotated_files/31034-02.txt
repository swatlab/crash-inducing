28870: diff --git a/media/libvorbis/lib/vorbis_synthesis.c b/media/libvorbis/lib/vorbis_synthesis.c
28870: index 8872f57..b7b2399 100644
28870: --- a/media/libvorbis/lib/vorbis_synthesis.c
28870: +++ b/media/libvorbis/lib/vorbis_synthesis.c
28870: @@ -43,9 +43,14 @@ int vorbis_synthesis(vorbis_block *vb,ogg_packet *op){
28870:  
28870:    /* read our mode and pre/post windowsize */
28870:    mode=oggpack_read(opb,b->modebits);
28870: -  if(mode==-1)return(OV_EBADPACKET);
28870: +  if(mode==-1) {
28870: +    return(OV_EBADPACKET);
28870: +  }
28870:  
28870:    vb->mode=mode;
28870: +  if(!ci->mode_param[mode]) {
28870: +    return(OV_EBADPACKET); 
28870: +  }
28870:    vb->W=ci->mode_param[mode]->blockflag;
28870:    if(vb->W){
28870:  
