 9116: <!DOCTYPE html>
 9116: <html class="reftest-wait">
 9116: <head>
 9116: <script>
 9116: 
 9116: function init1()
 9116: {
 9116:   // Create an html:iframe in HTML mode (so designMode can be used 320092)
 9116:   targetIframe = document.createElementNS('http://www.w3.org/1999/xhtml', 'iframe');
 9116:   targetIframe.src = "data:text/html,";
 9116:   targetIframe.setAttribute("style", "width: 700px; height: 500px; border: 1px dotted green;");
42897:   targetIframe.addEventListener("load", init2, false);
 9116:   document.body.appendChild(targetIframe);
 9116: }
 9116: 
 9116: 
 9116: function init2()
 9116: {
 9116:   targetWindow = targetIframe.contentWindow;
 9116:   targetDocument = targetWindow.document;
 9116:   
 9116:   p = document.getElementById("p");
 9116:   pText = p.firstChild;
 9116: 
 9116:   targetDocument.body.appendChild(targetDocument.adoptNode(p, true));
 9116: 
 9116:   targetDocument.designMode = 'on';
 9116: 
42897:   setTimeout(boom, 0);
 9116: }
 9116: 
 9116: 
 9116: function boom()
 9116: {
 9116:   var rng = targetDocument.createRange(); 
 9116:   rng.setStart(pText, 3);
 9116:   rng.setEnd(pText, 3);
 9116:   
 9116:   targetWindow.getSelection().addRange(rng); 
 9116: 
 9116:   targetDocument.execCommand("insertorderedlist", false, null);
 9116:   
 9116:   document.documentElement.removeAttribute("class")
 9116: }
 9116: 
 9116: </script>
 9116: </head>
 9116: 
 9116: <body onload="init1();">
 9116: <p id="p">word word</p>
 9116: </body>
 9116: 
 9116: </html>
