 24997: <html>
 24997: <!--
 24997: https://bugzilla.mozilla.org/show_bug.cgi?id=475006
 29290: https://bugzilla.mozilla.org/show_bug.cgi?id=391829
 49043: https://bugzilla.mozilla.org/show_bug.cgi?id=581952
 54466: https://bugzilla.mozilla.org/show_bug.cgi?id=558036
 24997: -->
 24997: <head>
 24997:   <title>Group attributes tests</title>
 24997:   <link rel="stylesheet" type="text/css"
 24997:         href="chrome://mochikit/content/tests/SimpleTest/test.css" />
 24997: 
 24997:   <script type="application/javascript"
 24997:           src="chrome://mochikit/content/tests/SimpleTest/SimpleTest.js"></script>
 24997: 
 24997:   <script type="application/javascript"
 51856:           src="../common.js"></script>
 24997:   <script type="application/javascript"
 51856:           src="../attributes.js"></script>
 24997: 
 24997:   <script type="application/javascript">
 24997:     function doTest()
 24997:     {
 25348:       // aria
 24997:       testAttrs("atomic", {"atomic" : "true"}, true);
 24997:       testAttrs("autocomplete", {"autocomplete" : "true"}, true);
 25348:       testAttrs("checkbox", {"checkable" : "true"}, true); 
 25348:       testAttrs("checkedCheckbox", {"checkable" : "true"}, true); 
 25348:       testAttrs("checkedMenuitem", {"checkable" : "true"}, true); 
 25348:       testAttrs("checkedOption", {"checkable" : "true"}, true); 
 25348:       testAttrs("checkedRadio", {"checkable" : "true"}, true); 
 25348:       testAttrs("checkedTreeitem", {"checkable" : "true"}, true); 
 61469:       testAttrs("dropeffect", {"dropeffect" : "copy"}, true);
 29397:       testAttrs("grabbed", {"grabbed" : "true"}, true);
 61469:       testAttrs("hidden", {"hidden" : "true"}, true);
 25996:       testAttrs("sortAscending", {"sort" : "ascending"}, true);
 25996:       testAttrs("sortDescending", {"sort" : "descending"}, true);
 25996:       testAttrs("sortNone", {"sort" : "none"}, true);
 25996:       testAttrs("sortOther", {"sort" : "other"}, true);
 25174: 
119399:       // inherited attributes by subdocuments
119399:       var subdoc = getAccessible("iframe").firstChild;
119399:       testAttrs(subdoc, {"busy" : "true"}, true);
119399: 
 25174:       // live object attribute
 54466: 
 54466:       // HTML
 54466:       testAttrs("output", {"live" : "polite"}, true);
 54466: 
 54466:       // ARIA
 24997:       testAttrs("live", {"live" : "polite"}, true);
 25174:       testAttrs("live2", {"live" : "polite"}, true);
 32053:       testAbsentAttrs("live3", {"live" : ""});
 25174:       testAttrs("log", {"live" : "polite"}, true);
 29394:       testAttrs("logAssertive", {"live" : "assertive"}, true);
 25174:       testAttrs("marquee", {"live" : "off"}, true);
 25174:       testAttrs("status", {"live" : "polite"}, true);
 71664:       testAttrs("tablist", {"live" : "polite"}, true);
 25174:       testAttrs("timer", {"live" : "off"}, true);
 25174: 
 25174:       // container-live object attribute
 25174:       testAttrs("liveChild", {"container-live" : "polite"}, true);
 25174:       testAttrs("live2Child", {"container-live" : "polite"}, true);
 25174:       testAttrs("logChild", {"container-live" : "polite"}, true);
 29394:       testAttrs("logAssertiveChild", {"container-live" : "assertive"}, true);
 25174:       testAttrs("marqueeChild", {"container-live" : "off"}, true);
 25174:       testAttrs("statusChild", {"container-live" : "polite"}, true);
 71664:       testAttrs("tablistChild", {"container-live" : "polite"}, true);
 25174:       testAttrs("timerChild", {"container-live" : "off"}, true);
 24997: 
 29290:       // container-live-role object attribute
 29290:       testAttrs("log", {"container-live-role" : "log"}, true);
 29394:       testAttrs("logAssertive", {"container-live-role" : "log"}, true);
 29290:       testAttrs("marquee", {"container-live-role" : "marquee"}, true);
 29290:       testAttrs("status", {"container-live-role" : "status"}, true);
 29290:       testAttrs("timer", {"container-live-role" : "timer"}, true);
 29290:       testAttrs("logChild", {"container-live-role" : "log"}, true);
 29394:       testAttrs("logAssertive", {"container-live-role" : "log"}, true);
 29394:       testAttrs("logAssertiveChild", {"container-live-role" : "log"}, true);
 29290:       testAttrs("marqueeChild", {"container-live-role" : "marquee"}, true);
 29290:       testAttrs("statusChild", {"container-live-role" : "status"}, true);
 71664:       testAttrs("tablistChild", {"container-live-role" : "tablist"}, true);
 29290:       testAttrs("timerChild", {"container-live-role" : "timer"}, true);
 29290: 
 49043:       // absent aria-label and aria-labelledby object attribute
 49043:       testAbsentAttrs("label", {"label" : "foo"});
 49043:       testAbsentAttrs("labelledby", {"labelledby" : "label"});
 49043: 
 29394:       // container that has no default live attribute
 29394:       testAttrs("liveGroup", {"live" : "polite"}, true);
 29394:       testAttrs("liveGroupChild", {"container-live" : "polite"}, true);
 29394:       testAttrs("liveGroup", {"container-live-role" : "group"}, true);
 29394:       testAttrs("liveGroupChild", {"container-live-role" : "group"}, true);
 29394: 
 25348:       // html
 25348:       testAttrs("radio", {"checkable" : "true"}, true); 
 25348:       testAttrs("checkbox", {"checkable" : "true"}, true); 
 29397:       testAttrs("draggable", {"draggable" : "true"}, true);
 82721:       testAttrs("th1", { "abbr": "SS#" }, true);
 82721:       testAttrs("th2", { "abbr": "SS#" }, true);
 82722:       testAttrs("th2", { "axis": "social" }, true);
 25348: 
125386:       // don't barf on an empty abbr element.
125386:       testAbsentAttrs("th3", { "abbr": "" }, true);
125386: 
 91475:       // application accessible
 91475:       if (WIN) {
 91475:         var gfxInfo = Components.classes["@mozilla.org/gfx/info;1"].
 91475:           getService(Components.interfaces.nsIGfxInfo);
 91475:         var attrs = {
 91475:           "D2D": (gfxInfo.D2DEnabled ? "true" : "false")
 91475:         }
 91475:         testAttrs(getApplicationAccessible(), attrs, false);
 91475:       }
 94027: 
 94027:       // no object attributes
 94027:       testAbsentAttrs(getAccessible("listitem").firstChild, { "tag": "" });
 94027: 
 96799:       // experimental aria
 96799:       testAttrs("experimental", {"blah" : "true"}, true);
 96799: 
 24997:       SimpleTest.finish();
 24997:     }
 24997: 
 24997:     SimpleTest.waitForExplicitFinish();
 32990:     addA11yLoadEvent(doTest);
 24997:   </script>
 24997: </head>
 24997: <body>
 24997:   <a target="_blank"
 24997:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=475006"
 24997:      title="Extend nsARIAMap to capture ARIA attribute characteristics">
 24997:     Mozilla Bug 475006
 24997:   </a>
 29290:   <a target="_blank"
 29290:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=391829"
 29290:      title="Add support for container-live-role to object attributes">
 29290:     Mozilla Bug 391829
 29290:   </a>
 49043:   <a target="_blank"
 49043:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=581952"
 49043:      title="Make explicit that aria-label is not an object attribute">
 49043:     Mozilla Bug 475006
 49043:   </a>
 54466:   <a target="_blank"
 54466:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=558036"
 54466:      title="make HTML <output> accessible">
 54466:     Mozilla Bug 558036
 54466:   </a>
 71664:   <a target="_blank"
 71664:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=663136"
 71664:      title="Add test coverage for tablist as implicit live region">
 71664:     Mozilla Bug 663136
 71664:   </a>
 96799:   <a target="_blank"
 96799:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=563862"
 96799:      title="Expand support for nsIAccessibleEvent::OBJECT_ATTRIBUTE_CHANGE">
 96799:     Mozilla Bug 563862
 96799:   </a>
125386:   <a target="_blank"
125386:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=819303"
125386:      title="crash in nsTextEquivUtils::AppendTextEquivFromTextContent">
125386:     Mozilla Bug 819303
125386:   </a>
 24997:   <p id="display"></p>
 24997:   <div id="content" style="display: none"></div>
 24997:   <pre id="test">
 24997:   </pre>
 24997: 
 25348:   <!-- aria -->
 24997:   <div id="atomic" aria-atomic="true"></div>
 24997:   <div id="autocomplete" role="textbox" aria-autocomplete="true"></div>
 25348:   <div id="checkbox" role="checkbox"></div>
 25348:   <div id="checkedCheckbox" role="checkbox" aria-checked="true"></div>
 25348:   <div id="checkedMenuitem" role="menuitem" aria-checked="true"></div>
 25348:   <div id="checkedOption" role="option" aria-checked="true"></div>
 25348:   <div id="checkedRadio" role="radio" aria-checked="true"></div>
 25348:   <div id="checkedTreeitem" role="treeitem" aria-checked="true"></div>
 61469:   <div id="dropeffect" aria-dropeffect="copy"></div>
 29397:   <div id="grabbed" aria-grabbed="true"></div>
 61469:   <div id="hidden" aria-hidden="true"></div>
 25996:   <div id="sortAscending" role="columnheader" aria-sort="ascending"></div>
 25996:   <div id="sortDescending" role="columnheader" aria-sort="descending"></div>
 25996:   <div id="sortNone" role="columnheader" aria-sort="none"></div>
 25996:   <div id="sortOther" role="columnheader" aria-sort="other"></div>
 25174: 
119399:   <!-- inherited from iframe -->
119399:   <iframe id="iframe" src="data:text/html,<html><body></body></html>"
119399:           aria-busy="true"></iframe>
119399: 
 54466:   <!-- html -->
 54466:   <output id="output"></output>
 54466: 
 54466:   <!-- back to aria -->
 25174:   <div id="live" aria-live="polite">excuse <div id="liveChild">me</div></div>
 25174:   <div id="live2" role="marquee" aria-live="polite">excuse <div id="live2Child">me</div></div>
 33712:   <div id="live3" role="region">excuse</div>
 25174:   <div id="log" role="log">excuse <div id="logChild">me</div></div>
 29394:   <div id="logAssertive" role="log" aria-live="assertive">excuse <div id="logAssertiveChild">me</div></div>
 25174:   <div id="marquee" role="marquee">excuse <div id="marqueeChild">me</div></div>
 25174:   <div id="status" role="status">excuse <div id="statusChild">me</div></div>
 71664:   <div id="tablist" role="tablist">tablist <div id="tablistChild">tab</div></div>
 25174:   <div id="timer" role="timer">excuse <div id="timerChild">me</div></div>
 24997: 
 49043:   <!-- aria-label[ledby] should not be an object attribute -->
 49043:   <div id="label" role="checkbox" aria-label="foo"></div>
 49043:   <div id="labelledby" role="checkbox" aria-labelledby="label"></div>
 49043: 
 29394:   <!-- unusual live case -->
 29394:   <div id="liveGroup" role="group" aria-live="polite">
 29394:     excuse <div id="liveGroupChild">me</div>
 29394:   </div>
 29394: 
 25348:   <!-- html -->
 25348:   <input id="radio" type="radio"/>
 25348:   <input id="checkbox" type="checkbox"/>
 29397:   <div id="draggable" draggable="true">Draggable div</div>
 82721:   <table>
 82721:     <tr>
 82721:       <th id="th1"><abbr title="Social Security Number">SS#</abbr></th>
 82722:       <th id="th2" abbr="SS#" axis="social">Social Security Number</th>
125386:       <th id="th3"><abbr></abbr></th>
 82721:     </tr>
 82721:   </table>
 94027: 
 94027:   <ul>
 94027:     <li id="listitem">item
 94027:   </ul>
 96799: 
 96799:   <!-- experimental aria -->
 96799:   <div id="experimental" aria-blah="true">Fake beer</div>
 24997: </body>
 24997: </html>
