  6597: /* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-
  6597:  *
 99778:  * This Source Code Form is subject to the terms of the Mozilla Public
 99778:  * License, v. 2.0. If a copy of the MPL was not distributed with this
 99778:  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
  6597: 
  8463: #ifndef _NSSSLSTATUS_H
  8463: #define _NSSSLSTATUS_H
  8463: 
  6597: #include "nsISSLStatus.h"
119832: 
119832: #include "nsAutoPtr.h"
  6597: #include "nsXPIDLString.h"
  6597: #include "nsIX509Cert.h"
  8463: #include "nsISerializable.h"
  8463: #include "nsIClassInfo.h"
  6597: 
  6597: class nsSSLStatus
  6597:   : public nsISSLStatus
  8463:   , public nsISerializable
  8463:   , public nsIClassInfo
  6597: {
  6597: public:
  6597:   NS_DECL_ISUPPORTS
  6597:   NS_DECL_NSISSLSTATUS
  8463:   NS_DECL_NSISERIALIZABLE
  8463:   NS_DECL_NSICLASSINFO
  6597: 
  6597:   nsSSLStatus();
  6597:   virtual ~nsSSLStatus();
  6597: 
  6597:   /* public for initilization in this file */
  6597:   nsCOMPtr<nsIX509Cert> mServerCert;
  6597: 
108991:   uint32_t mKeyLength;
108991:   uint32_t mSecretKeyLength;
  6597:   nsXPIDLCString mCipherName;
  6597: 
 79445:   bool mIsDomainMismatch;
 79445:   bool mIsNotValidAtThisTime;
 79445:   bool mIsUntrusted;
  6597: 
 79445:   bool mHaveKeyLengthAndCipher;
 84549: 
 84549:   /* mHaveCertErrrorBits is relied on to determine whether or not a SPDY
 84549:      connection is eligible for joining in nsNSSSocketInfo::JoinConnection() */
 79445:   bool mHaveCertErrorBits;
  6597: };
  8463: 
  8463: // 2c3837af-8b85-4a68-b0d8-0aed88985b32
  8463: #define NS_SSLSTATUS_CID \
  8463: { 0x2c3837af, 0x8b85, 0x4a68, \
  8463:   { 0xb0, 0xd8, 0x0a, 0xed, 0x88, 0x98, 0x5b, 0x32 } }
  8463: 
  8463: #endif
