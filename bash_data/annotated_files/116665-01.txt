 38800: #
 98983: # This Source Code Form is subject to the terms of the Mozilla Public
 98983: # License, v. 2.0. If a copy of the MPL was not distributed with this
 98983: # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 38800: 
107436: DEPTH       = @DEPTH@
 38800: topsrcdir   = @top_srcdir@
 38800: srcdir      = @srcdir@
 39419: VPATH       = \
 39419:   $(srcdir) \
 39419:   $(srcdir)/basic \
 39997:   $(srcdir)/opengl \
 42611:   $(srcdir)/d3d9 \
 54815:   $(srcdir)/d3d10 \
 67579:   $(srcdir)/ipc \
 39419:   $(NULL)
 38800: 
 38800: include $(DEPTH)/config/autoconf.mk
 38800: 
 41484: MODULE         = thebes
 38800: LIBRARY_NAME   = layers
 38800: LIBXUL_LIBRARY = 1
 41484: FORCE_STATIC_LIB = 1
 38800: 
 38808: DEFINES += -DIMPL_THEBES
 42611: ifdef MOZ_DEBUG
 42611: DEFINES += -DD3D_DEBUG_INFO
 42611: endif
 38808: 
 38800: EXPORTS = \
 39498:         BasicLayers.h \
 95945:         BasicTiledThebesLayer.h \
 95945:         BasicImplData.h \
108637:         GonkIOSurfaceImage.h \
106914:         FrameMetrics.h \
109463:         CompositorChild.h \
107006:         CompositorParent.h \
108747:         ImageContainer.h \
 39498:         ImageLayers.h \
108747:         ImageTypes.h \
 38800:         Layers.h \
106914:         LayersTypes.h \
 97447:         LayerManagerOGLShaders.h \
 39997:         LayerManagerOGL.h \
 42791:         LayerManagerOGLProgram.h \
107006:         LayerSorter.h \
115308:         LayerTreeInvalidation.h \
106839:         ReadbackLayer.h \
107006:         ShadowLayersManager.h \
107006:         SharedTextureImage.h \
106839:         TexturePoolOGL.h \
 38800:         $(NULL)
 38800: 
 38800: CPPSRCS = \
 39498:         BasicImages.cpp \
103229:         BasicLayerManager.cpp \
103229:         BasicCanvasLayer.cpp \
103229:         BasicColorLayer.cpp \
103229:         BasicContainerLayer.cpp \
103229:         BasicImageLayer.cpp \
103229:         BasicLayersImpl.cpp \
103229:         BasicThebesLayer.cpp \
103229:         BasicBuffers.cpp \
 95944:         BasicTiledThebesLayer.cpp \
108747:         ImageContainer.cpp \
 62697:         Layers.cpp \
 91562:         RenderTrace.cpp \
 62697:         ReadbackProcessor.cpp \
 47108:         ThebesLayerBuffer.cpp \
 47108:         CanvasLayerOGL.cpp \
 42249:         ColorLayerOGL.cpp \
 39997:         ContainerLayerOGL.cpp \
 39997:         ImageLayerOGL.cpp \
 47108:         LayerManagerOGL.cpp \
 47108:         ThebesLayerOGL.cpp \
 95945:         TiledThebesLayerOGL.cpp \
 96930:         ReusableTileStoreOGL.cpp \
 97428:         LayerManagerOGLProgram.cpp \
 79925:         LayerSorter.cpp \
115308:         LayerTreeInvalidation.cpp \
 89204:         ImageLayers.cpp \
106178:         TexturePoolOGL.cpp \
 38800:         $(NULL)
 38800: 
 42611: ifeq ($(MOZ_WIDGET_TOOLKIT),windows)
 43174: ifdef MOZ_ENABLE_D3D9_LAYER
 49316: EXPORTS += \
 49316:         LayerManagerD3D9.h \
 49316:         DeviceManagerD3D9.h \
 49316:         $(NULL)
 42611: 
 42611: CPPSRCS += \
 42611:         LayerManagerD3D9.cpp \
 42611:         ThebesLayerD3D9.cpp \
 42611:         ContainerLayerD3D9.cpp \
 42611:         ImageLayerD3D9.cpp \
 42611:         ColorLayerD3D9.cpp \
 42611:         CanvasLayerD3D9.cpp \
 72995:         ShadowBufferD3D9.cpp \
 49316:         DeviceManagerD3D9.cpp \
 51527:         Nv3DVUtils.cpp \
 42611:         $(NULL)
 42611: endif
 54815: ifdef MOZ_ENABLE_D3D10_LAYER
 54815: EXPORTS += \
 54815:         LayerManagerD3D10.h \
 62702:         ReadbackManagerD3D10.h \
 54815:         $(NULL)
 54815: 
 54815: CPPSRCS += \
 75152:         CanvasLayerD3D10.cpp \
 75152:         ColorLayerD3D10.cpp \
 54815:         ContainerLayerD3D10.cpp \
 54815:         ImageLayerD3D10.cpp \
 75152:         LayerManagerD3D10.cpp \
 62702:         ReadbackManagerD3D10.cpp \
 75152: 	ShadowLayerUtilsD3D10.cpp \
 75152:         ThebesLayerD3D10.cpp \
 54815:         $(NULL)
 54815: endif
 42611: endif
 42611: 
 86520: EXPORTS_NAMESPACES = gfxipc mozilla/layers
 86520: EXPORTS_gfxipc = ShadowLayerUtils.h
 48140: EXPORTS_mozilla/layers =\
105885:         AsyncPanZoomController.h \
105885:         Axis.h \
 87729:         CompositorCocoaWidgetHelper.h \
 87729:         CompositorChild.h \
 87729:         CompositorParent.h \
105885:         GeckoContentController.h \
105885:         GestureEventListener.h \
104622:         ImageBridgeChild.h \
104622:         ImageBridgeParent.h \
104622:         ImageContainerChild.h \
104622:         ImageContainerParent.h \
 48140:         ShadowLayers.h \
 54013:         ShadowLayersChild.h \
 54013:         ShadowLayersParent.h \
 87729:         ShadowLayersManager.h \
 93005:         RenderTrace.h \
104622:         SharedImageUtils.h \
114150:         ShmemYCbCrImage.h \
 48140:         $(NULL)
 48140: 
 48138: CPPSRCS += \
105885:         AsyncPanZoomController.cpp \
105885:         Axis.cpp \
 87729:         CompositorCocoaWidgetHelper.cpp \
 87729:         CompositorChild.cpp \
 87729:         CompositorParent.cpp \
105885:         GestureEventListener.cpp \
104622:         ImageBridgeChild.cpp \
104622:         ImageBridgeParent.cpp \
104622:         ImageContainerChild.cpp \
104622:         ImageContainerParent.cpp \
 48138:         ShadowLayers.cpp \
 54013:         ShadowLayerChild.cpp \
 54013:         ShadowLayersChild.cpp \
 48139:         ShadowLayerParent.cpp \
 48139:         ShadowLayersParent.cpp \
114150:         ShmemYCbCrImage.cpp \
 48138:         $(NULL)
 54102: 
 54102: ifdef MOZ_X11 #{
 54102: EXPORTS_mozilla/layers += ShadowLayerUtilsX11.h
 54102: CPPSRCS += ShadowLayerUtilsX11.cpp
 54102: endif #}
 54102: 
 75152: ifdef MOZ_ENABLE_D3D10_LAYER
 75152: EXPORTS_mozilla/layers += ShadowLayerUtilsD3D10.h
 75152: DEFINES	+= -DMOZ_ENABLE_D3D10_LAYER
 75152: endif
 75152: 
104370: # NB: Gralloc is available on other platforms that use the android GL
104370: # libraries, but only Gonk is able to use it reliably because Gecko
104370: # has full system permissions there.
104370: ifeq ($(MOZ_WIDGET_TOOLKIT),gonk)
104370: EXPORTS_mozilla/layers += ShadowLayerUtilsGralloc.h
108920: CPPSRCS += \
108920:         ShadowLayerUtilsGralloc.cpp \
108920:         GrallocImages.cpp \
116608:         GonkIOSurfaceImage.cpp \
108920:         $(NULL)
104370: endif
104370: 
 38800: include $(topsrcdir)/config/rules.mk
 39498: 
 48136: include $(topsrcdir)/ipc/chromium/chromium-config.mk
 48136: 
105885: LOCAL_INCLUDES += \
105885:         -I$(topsrcdir)/content/events/src \
116608:         -I$(ANDROID_SOURCE)/frameworks/base/include/media/stagefright \
116608:         -I$(ANDROID_SOURCE)/frameworks/base/include/media/stagefright/openmax \
105885:         $(NULL)
105885: 
 99513: CXXFLAGS += $(MOZ_CAIRO_CFLAGS) $(MOZ_PIXMAN_CFLAGS) $(TK_CFLAGS)
116665: 
116665: ifdef _MSC_VER
116665: ifeq ($(CPU_ARCH),x86_64)
116665: # Workaround compiler bug (Bug 795594)
116665: LayerTreeInvalidation.$(OBJ_SUFFIX): CXXFLAGS += -GL-
116665: Layers.$(OBJ_SUFFIX): CXXFLAGS += -GL-
116665: endif
116665: endif
