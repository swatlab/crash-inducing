32381: <!DOCTYPE html>
32381: <html>
32381: 
32381: <head>
32381:   <title>Table accessible tree and table interface tests for ARIA grid</title>
32381:   <link rel="stylesheet" type="text/css"
32381:         href="chrome://mochikit/content/tests/SimpleTest/test.css" />
32381: 
32381:   <script type="application/javascript"
32381:           src="chrome://mochikit/content/MochiKit/packed.js"></script>
32381:   <script type="application/javascript"
32381:           src="chrome://mochikit/content/tests/SimpleTest/SimpleTest.js"></script>
32381: 
32381:   <script type="application/javascript"
51856:           src="../common.js"></script>
32381:   <script type="application/javascript"
51856:           src="../role.js"></script>
32381:   <script type="application/javascript"
51856:           src="../table.js"></script>
32381: 
32381:   <script type="application/javascript">
32381:     function doTest()
32381:     {
32381:       //////////////////////////////////////////////////////////////////////////
32381:       // Pure ARIA grid
32381:       var cellsArray = [
32381:         [kColHeaderCell, kColHeaderCell, kColHeaderCell],
32381:         [kRowHeaderCell, kDataCell,      kDataCell],
32381:         [kRowHeaderCell, kDataCell,      kDataCell]
32381:       ];
32381: 
32381:       testTableStruct("table", cellsArray);
32381: 
32381:       //////////////////////////////////////////////////////////////////////////
32381:       // HTML table based ARIA grid
32474:       cellsArray = [
32381:         [kColHeaderCell, kColHeaderCell, kColHeaderCell],
32381:         [kDataCell,      kDataCell,      kDataCell],
32381:         [kDataCell,      kDataCell,      kDataCell]
32381:       ];
32381: 
32381:       testTableStruct("grid", cellsArray);
32381: 
32474:       //////////////////////////////////////////////////////////////////////////
32474:       // ARIA grid with HTML table elements
32474:       cellsArray = [
32474:         [kColHeaderCell, kColHeaderCell],
32474:         [kDataCell,      kDataCell]
32474:       ];
32474: 
32474:       testTableStruct("grid2", cellsArray);
32474: 
74916:       //////////////////////////////////////////////////////////////////////////
74916:       // ARIA grid of wrong markup
74916:       cellsArray = [ ];
74916:       testTableStruct("grid3", cellsArray);
74916: 
74916:       cellsArray = [ [] ];
74916:       testTableStruct("grid4", cellsArray);
74916: 
32381:       SimpleTest.finish();
32381:     }
32381: 
32381:     SimpleTest.waitForExplicitFinish();
32990:     addA11yLoadEvent(doTest);
32381:   </script>
32381: </head>
32381: 
32381: <body>
32381:   <a target="_blank"
32381:      title="ARIA grid based on HTML table"
32381:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=491683">Mozilla Bug 491683</a>
32381:   <a target="_blank"
32381:      title="implement IAccessibleTable2"
32381:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=512424">Mozilla Bug 512424</a>
32474:   <a target="_blank"
32474:      title="nsHTMLTableCellAccessible is used in dojo's crazy ARIA grid"
32474:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=513848">Mozilla Bug 513848</a>
74916:   <a target="_blank"
74916:      title="Crash [@ AccIterator::GetNext()]"
74916:      href="https://bugzilla.mozilla.org/show_bug.cgi?id=675861">Mozilla Bug 675861</a>
32381: 
32381:   <p id="display"></p>
32381:   <div id="content" style="display: none"></div>
32381:   <pre id="test">
32381:   </pre>
32381: 
32381:   <!-- Not usual markup to avoid text accessible between cell accessibles -->
32381:   <div id="table" role="grid">
32381:     <div role="row"><span
32381:       id="table_ch_1" role="columnheader">col_1</span><span
32381:       id="table_ch_2" role="columnheader">col_2</span><span
32381:       id="table_ch_3" role="columnheader">col_3</span></div>
32381:     <div role="row"><span
32381:       id="table_rh_1" role="rowheader">row_1</span><span
32381:       id="table_dc_1" role="gridcell">cell1</span><span
32381:       id="table_dc_2" role="gridcell">cell2</span></div>
32381:     <div role="row"><span
32381:       id="table_rh_2" role="rowheader">row_2</span><span
32381:       id="table_dc_3" role="gridcell">cell3</span><span
32381:       id="table_dc_4" role="gridcell">cell4</span></div>
32381:   </div>
32381: 
32381:   <table role="grid" id="grid" border="1" cellpadding="10" cellspacing="0">
32381:     <thead>
32381:       <tr role="row">
32381:         <th role="columnheader">subject</td>
32381:         <th role="columnheader">sender</th>
32381:         <th role="columnheader">date</th>
32381:       </tr>
32381:     </thead>
32381:     <tbody>
32381:       <tr role="row">
32381:         <td role="gridcell" tabindex="0">about everything</td>
32381:         <td role="gridcell">president</td>
32381:         <td role="gridcell">today</td>
32381:       </tr>
32381:       <tr role="row">
32381:         <td role="gridcell">new bugs</td>
32381:         <td role="gridcell">mozilla team</td>
32381:         <td role="gridcell">today</td>
32381:       </tr>
32381:     </tbody>
32381:   </table>
32381: 
32474:   <!-- ARIA grid containing presentational HTML:table with HTML:td used as ARIA
32474:     grid cells (focusable and not focusable cells) -->
32474:   <div role="grid" id="grid2">
32474:     <div role="row">
32474:       <table role="presentation">
32474:         <tr>
32474:           <td role="columnheader">header1</td>
32474:           <td role="columnheader">header2</td>
32474:         </tr>
32474:       </table>
32474:     </div>
32474:     <div role="row">
32474:       <table role="presentation">
32474:         <tr>
32474:           <td role="gridcell">cell1</td>
32474:           <td role="gridcell" tabindex="-1">cell2</td>
32474:         </tr>
32474:       </table>
32474:     </div>
32474:   </div>
32474: 
74916:   <!-- Wrong markup ARIA grid -->
74916:   <div role="grid" id="grid3"></div>
74916:   <div role="grid" id="grid4"><div role="row"></div></div>
32381: </body>
32381: </html>
