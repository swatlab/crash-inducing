54346: /* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
54346: /* ***** BEGIN LICENSE BLOCK *****
54346:  * Version: MPL 1.1/GPL 2.0/LGPL 2.1
54346:  *
54346:  * The contents of this file are subject to the Mozilla Public License Version
54346:  * 1.1 (the "License"); you may not use this file except in compliance with
54346:  * the License. You may obtain a copy of the License at
54346:  * http://www.mozilla.org/MPL/
54346:  *
54346:  * Software distributed under the License is distributed on an "AS IS" basis,
54346:  * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
54346:  * for the specific language governing rights and limitations under the
54346:  * License.
54346:  *
54346:  * The Original Code is Mozilla Communicator client code.
54346:  *
54346:  * The Initial Developer of the Original Code is
54346:  * Netscape Communications Corporation.
54346:  * Portions created by the Initial Developer are Copyright (C) 1998
54346:  * the Initial Developer. All Rights Reserved.
54346:  *
54346:  * Contributor(s):
54346:  *
54346:  * Alternatively, the contents of this file may be used under the terms of
54346:  * either of the GNU General Public License Version 2 or later (the "GPL"),
54346:  * or the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
54346:  * in which case the provisions of the GPL or the LGPL are applicable instead
54346:  * of those above. If you wish to allow use of your version of this file only
54346:  * under the terms of either the GPL or the LGPL, and not to allow others to
54346:  * use your version of this file under the terms of the MPL, indicate your
54346:  * decision by deleting the provisions above and replace them with the notice
54346:  * and other provisions required by the GPL or the LGPL. If you do not delete
54346:  * the provisions above, a recipient may use your version of this file under
54346:  * the terms of any one of the MPL, the GPL or the LGPL.
54346:  *
54346:  * ***** END LICENSE BLOCK ***** */
54346: 
54346: #ifndef nsHTMLFieldSetElement_h___
54346: #define nsHTMLFieldSetElement_h___
54346: 
54346: #include "nsGenericHTMLElement.h"
54346: #include "nsIDOMHTMLFieldSetElement.h"
54346: #include "nsIConstraintValidation.h"
56935: #include "nsTPtrArray.h"
54346: 
54346: 
54346: class nsHTMLFieldSetElement : public nsGenericHTMLFormElement,
54346:                               public nsIDOMHTMLFieldSetElement,
54346:                               public nsIConstraintValidation
54346: {
54346: public:
54346:   using nsIConstraintValidation::GetValidationMessage;
54346: 
54346:   nsHTMLFieldSetElement(already_AddRefed<nsINodeInfo> aNodeInfo);
54346:   virtual ~nsHTMLFieldSetElement();
54346: 
54346:   // nsISupports
54346:   NS_DECL_CYCLE_COLLECTING_ISUPPORTS
54346: 
54346:   // nsIDOMNode
54346:   NS_FORWARD_NSIDOMNODE(nsGenericHTMLFormElement::)
54346: 
54346:   // nsIDOMElement
54346:   NS_FORWARD_NSIDOMELEMENT(nsGenericHTMLFormElement::)
54346: 
54346:   // nsIDOMHTMLElement
54346:   NS_FORWARD_NSIDOMHTMLELEMENT(nsGenericHTMLFormElement::)
54346: 
54346:   // nsIDOMHTMLFieldSetElement
54346:   NS_DECL_NSIDOMHTMLFIELDSETELEMENT
54346: 
54346:   // nsIContent
54346:   virtual nsresult PreHandleEvent(nsEventChainPreVisitor& aVisitor);
54346:   virtual nsresult AfterSetAttr(PRInt32 aNameSpaceID, nsIAtom* aName,
54346:                                 const nsAString* aValue, PRBool aNotify);
54346: 
54346:   virtual nsresult InsertChildAt(nsIContent* aChild, PRUint32 aIndex,
54346:                                      PRBool aNotify);
54346:   virtual nsresult RemoveChildAt(PRUint32 aIndex, PRBool aNotify,
54346:                                  PRBool aMutationEvent = PR_TRUE);
54346: 
54346:   // nsIFormControl
54346:   NS_IMETHOD_(PRUint32) GetType() const { return NS_FORM_FIELDSET; }
54346:   NS_IMETHOD Reset();
54346:   NS_IMETHOD SubmitNamesValues(nsFormSubmission* aFormSubmission);
54346:   virtual nsresult Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const;
54346:   virtual nsXPCClassInfo* GetClassInfo();
54346: 
54346:   const nsIContent* GetFirstLegend() const { return mFirstLegend; }
54346: 
56935:   void AddElement(nsGenericHTMLFormElement* aElement) {
56935:     mDependentElements.AppendElement(aElement);
56935:   }
56935: 
56935:   void RemoveElement(nsGenericHTMLFormElement* aElement) {
56935:     mDependentElements.RemoveElement(aElement);
56935:   }
56935: 
54346:   NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED(nsHTMLFieldSetElement,
54346:                                            nsGenericHTMLFormElement)
54346: private:
54346: 
54346:   /**
54346:    * Notify all elements (in mElements) that the first legend of the fieldset
54346:    * has now changed.
54346:    */
55188:   void NotifyElementsForFirstLegendChange(PRBool aNotify);
54346: 
54346:   // This function is used to generate the nsContentList (listed form elements).
54346:   static PRBool MatchListedElements(nsIContent* aContent, PRInt32 aNamespaceID,
54346:                                     nsIAtom* aAtom, void* aData);
54346: 
54346:   // listed form controls elements.
54346:   nsRefPtr<nsContentList> mElements;
54346: 
56935:   // List of elements which have this fieldset as first fieldset ancestor.
56935:   nsTPtrArray<nsGenericHTMLFormElement> mDependentElements;
56935: 
54346:   nsIContent* mFirstLegend;
54346: };
54346: 
54346: #endif /* nsHTMLFieldSetElement_h___ */
54346: 
