16295: /********************************************************************
16295:  *                                                                  *
16295:  * THIS FILE IS PART OF THE OggVorbis SOFTWARE CODEC SOURCE CODE.   *
16295:  * USE, DISTRIBUTION AND REPRODUCTION OF THIS LIBRARY SOURCE IS     *
16295:  * GOVERNED BY A BSD-STYLE SOURCE LICENSE INCLUDED WITH THIS SOURCE *
16295:  * IN 'COPYING'. PLEASE READ THESE TERMS BEFORE DISTRIBUTING.       *
16295:  *                                                                  *
16295:  * THE OggVorbis SOURCE CODE IS (C) COPYRIGHT 1994-2007             *
16295:  * by the Xiph.Org Foundation http://www.xiph.org/                  *
16295:  *                                                                  *
16295:  ********************************************************************
16295: 
16295:  function: bitrate tracking and management
31034:  last mod: $Id: bitrate.h 13293 2007-07-24 00:09:47Z xiphmont $
16295: 
16295:  ********************************************************************/
16295: 
16295: #ifndef _V_BITRATE_H_
16295: #define _V_BITRATE_H_
16295: 
16295: #include "vorbis/codec.h"
16295: #include "codec_internal.h"
16295: #include "os.h"
16295: 
16295: /* encode side bitrate tracking */
16295: typedef struct bitrate_manager_state {
16295:   int            managed;
16295: 
16295:   long           avg_reservoir;
16295:   long           minmax_reservoir;
16295:   long           avg_bitsper;
16295:   long           min_bitsper;
16295:   long           max_bitsper;
16295: 
16295:   long           short_per_long;
16295:   double         avgfloat;
16295: 
16295:   vorbis_block  *vb;
16295:   int            choice;
16295: } bitrate_manager_state;
16295: 
16295: typedef struct bitrate_manager_info{
16295:   long           avg_rate;
16295:   long           min_rate;
16295:   long           max_rate;
16295:   long           reservoir_bits;
16295:   double         reservoir_bias;
16295: 
16295:   double         slew_damp;
16295: 
16295: } bitrate_manager_info;
16295: 
16295: extern void vorbis_bitrate_init(vorbis_info *vi,bitrate_manager_state *bs);
16295: extern void vorbis_bitrate_clear(bitrate_manager_state *bs);
16295: extern int vorbis_bitrate_managed(vorbis_block *vb);
16295: extern int vorbis_bitrate_addblock(vorbis_block *vb);
16295: extern int vorbis_bitrate_flushpacket(vorbis_dsp_state *vd, ogg_packet *op);
16295: 
16295: #endif
